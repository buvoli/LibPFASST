<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>restrict_time_space_fas &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>restrict_time_space_fas
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">49 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_restrict.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_restrict.f90.html'>pf_restrict.f90</a></li>
    
     <li><a href='../module/pf_mod_restrict.html'>pf_mod_restrict</a></li>
    
  
     <li class="active">restrict_time_space_fas</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/restrict_time_space_fas.html#src">restrict_time_space_fas</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine restrict_time_space_fas(pf, t0, dt, level_index, flags, mystep)
    
    
   
</h2>
    
  


    
    <p>Restrict (in time and space) fine level to coarse and set coarse level FAS correction.</p>
<p>The coarse function values are re-evaluated after restriction.
 Note that even if the number of variables and nodes is the same,
 we should still compute the FAS correction since the function
 evaluations may be different.
 restrict q's and recompute f's
  Recompute the functions</p>
<p>Compute  FAS correction
$       if (pf%use_Sform) then
$          do m = c_lev%nnodes-1,2,-1
$!             call c_lev%tauQ(m)%axpy(-1.0_pfdp, c_lev%tauQ(m-1), flags)
$          end do
$       end if</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E25"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E10"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td><p>time at beginning of step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E19"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>time step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-level_index%7E31"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>level_index</strong></td><td><p>defines which level to restrict</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E30"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mystep"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>mystep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~restrict_time_space_fas~~CallsGraph Pages: 1 -->
<svg id="procrestrict_time_space_fasCallsGraph" width="483pt" height="171pt"
 viewBox="0.00 0.00 483.00 170.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~restrict_time_space_fas~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 166.8629)">
<title>proc~~restrict_time_space_fas~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-166.8629 479,-166.8629 479,4 -4,4"/>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node1" class="node">
<title>proc~restrict_time_space_fas</title>
<polygon fill="none" stroke="#000000" points="126,-106 0,-106 0,-82 126,-82 126,-106"/>
<text text-anchor="middle" x="63" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">restrict_time_space_fas</text>
</g>
<!-- proc~start_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node2" class="node">
<title>proc~start_timer</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node2"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="368.5,-159 304.5,-159 304.5,-135 368.5,-135 368.5,-159"/>
<text text-anchor="middle" x="336.5" y="-144.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge2" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M76.8752,-106.0761C94.9994,-120.9686 128.3972,-145.4788 162,-155 205.8187,-167.4159 258.2775,-162.5118 294.1602,-156.3358"/>
<polygon fill="#000000" stroke="#000000" points="295.0706,-159.7274 304.2776,-154.4851 293.811,-152.8416 295.0706,-159.7274"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node3" class="node">
<title>proc~end_timer</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node3"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="367,-117 306,-117 306,-93 367,-93 367,-117"/>
<text text-anchor="middle" x="336.5" y="-102.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge1" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M126.0898,-96.5374C178.2289,-98.6344 250.7307,-101.5504 295.5804,-103.3542"/>
<polygon fill="#000000" stroke="#000000" points="295.6766,-106.8608 305.8092,-103.7656 295.9579,-99.8665 295.6766,-106.8608"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node4" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node4"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="243.5,-146 180.5,-146 180.5,-122 243.5,-122 243.5,-146"/>
<text text-anchor="middle" x="212" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge3" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M107.7049,-106.0013C127.5599,-111.3315 150.7953,-117.5692 170.2891,-122.8024"/>
<polygon fill="#000000" stroke="#000000" points="169.5388,-126.2249 180.1043,-125.4374 171.3538,-119.4643 169.5388,-126.2249"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node5" class="node">
<title>proc~restrict_ts_integral</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node5"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="262,-66 162,-66 162,-42 262,-42 262,-66"/>
<text text-anchor="middle" x="212" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge4" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M107.7049,-81.9987C123.2511,-77.8252 140.8698,-73.0954 157.1421,-68.727"/>
<polygon fill="#000000" stroke="#000000" points="158.3188,-72.0351 167.0693,-66.0619 156.5038,-65.2744 158.3188,-72.0351"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node6" class="node">
<title>proc~restrict_ts</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node6"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="241.5,-24 182.5,-24 182.5,0 241.5,0 241.5,-24"/>
<text text-anchor="middle" x="212" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge5" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M80.7595,-81.8938C100.2071,-68.916 132.5555,-48.1396 162,-33 165.5259,-31.1871 169.2446,-29.4024 172.9975,-27.6857"/>
<polygon fill="#000000" stroke="#000000" points="174.5679,-30.8184 182.3056,-23.5811 171.7435,-24.4135 174.5679,-30.8184"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node7" class="node">
<title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="475,-138 411,-138 411,-114 475,-114 475,-138"/>
<text text-anchor="middle" x="443" y="-123.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_wtime</text>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge6" class="edge">
<title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M368.7425,-140.6423C378.8566,-138.648 390.1748,-136.4162 400.8672,-134.3079"/>
<polygon fill="#000000" stroke="#000000" points="401.7331,-137.7046 410.8671,-132.3361 400.3788,-130.8369 401.7331,-137.7046"/>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge7" class="edge">
<title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M367.0186,-111.0178C377.56,-113.0963 389.5645,-115.4634 400.8693,-117.6925"/>
<polygon fill="#000000" stroke="#000000" points="400.5041,-121.1879 410.9923,-119.6886 401.8584,-114.3201 400.5041,-121.1879"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge9" class="edge">
<title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M243.7387,-137.3141C259.1313,-138.9213 277.8305,-140.8739 294.3962,-142.6036"/>
<polygon fill="#000000" stroke="#000000" points="294.0769,-146.0892 304.3863,-143.6468 294.8039,-139.1271 294.0769,-146.0892"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge8" class="edge">
<title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M243.7387,-126.607C259.4892,-122.9382 278.702,-118.463 295.5484,-114.5389"/>
<polygon fill="#000000" stroke="#000000" points="296.7345,-117.8564 305.6797,-112.179 295.1464,-111.0389 296.7345,-117.8564"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node8" class="node">
<title>proc~pf_apply_mat</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node8"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-55 298,-55 298,-31 375,-31 375,-55"/>
<text text-anchor="middle" x="336.5" y="-40.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge10" class="edge">
<title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M262.28,-49.5576C270.7244,-48.8115 279.4741,-48.0384 287.8755,-47.2961"/>
<polygon fill="#000000" stroke="#000000" points="288.2538,-50.7764 297.9069,-46.4098 287.6376,-43.8036 288.2538,-50.7764"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge11" class="edge">
<title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M241.5048,-19.3466C255.3075,-22.7834 272.1129,-26.9679 287.7295,-30.8563"/>
<polygon fill="#000000" stroke="#000000" points="287.2272,-34.3381 297.7766,-33.358 288.9186,-27.5455 287.2272,-34.3381"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~restrict_time_space_fas~~CalledByGraph Pages: 1 -->
<svg id="procrestrict_time_space_fasCalledByGraph" width="511pt" height="158pt"
 viewBox="0.00 0.00 511.00 158.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~restrict_time_space_fas~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 154)">
<title>proc~~restrict_time_space_fas~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-154 507,-154 507,4 -4,4"/>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node1" class="node">
<title>proc~restrict_time_space_fas</title>
<polygon fill="none" stroke="#000000" points="503,-87 377,-87 377,-63 503,-63 503,-87"/>
<text text-anchor="middle" x="440" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">restrict_time_space_fas</text>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node2" class="node">
<title>proc~pf_predictor</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node2"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="332.5,-150 262.5,-150 262.5,-126 332.5,-126 332.5,-150"/>
<text text-anchor="middle" x="297.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge1" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M324.9754,-125.853C347.2519,-116.0044 378.8492,-102.0351 403.2919,-91.2289"/>
<polygon fill="#000000" stroke="#000000" points="404.8781,-94.3544 412.6089,-87.1097 402.0476,-87.9522 404.8781,-94.3544"/>
</g>
<!-- proc~pf_v_cycle -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node3" class="node">
<title>proc~pf_v_cycle</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node3"><a xlink:href=".././proc/pf_v_cycle.html" xlink:title="pf_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="329,-108 266,-108 266,-84 329,-84 329,-108"/>
<text text-anchor="middle" x="297.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge2" class="edge">
<title>proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M329.1254,-91.3394C340.3639,-89.6832 353.5309,-87.7428 366.7886,-85.789"/>
<polygon fill="#000000" stroke="#000000" points="367.5312,-89.2175 376.914,-84.2969 366.5106,-82.2923 367.5312,-89.2175"/>
</g>
<!-- proc~pf_v_cycle_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node4" class="node">
<title>proc~pf_v_cycle_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node4"><a xlink:href=".././proc/pf_v_cycle_oc.html" xlink:title="pf_v_cycle_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-66 257.5,-66 257.5,-42 337.5,-42 337.5,-66"/>
<text text-anchor="middle" x="297.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_v_cycle_oc</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle_oc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge3" class="edge">
<title>proc~pf_v_cycle_oc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M337.5734,-59.9056C346.711,-61.2521 356.7007,-62.7243 366.7436,-64.2043"/>
<polygon fill="#000000" stroke="#000000" points="366.3711,-67.6872 376.7746,-65.6826 367.3918,-60.7619 366.3711,-67.6872"/>
</g>
<!-- proc~pf_predictor_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node5" class="node">
<title>proc~pf_predictor_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node5"><a xlink:href=".././proc/pf_predictor_oc.html" xlink:title="pf_predictor_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="341,-24 254,-24 254,0 341,0 341,-24"/>
<text text-anchor="middle" x="297.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_predictor_oc</text>
</a>
</g>
</g>
<!-- proc~pf_predictor_oc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge4" class="edge">
<title>proc~pf_predictor_oc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M324.9754,-24.147C347.2519,-33.9956 378.8492,-47.9649 403.2919,-58.7711"/>
<polygon fill="#000000" stroke="#000000" points="402.0476,-62.0478 412.6089,-62.8903 404.8781,-55.6456 402.0476,-62.0478"/>
</g>
<!-- proc~pf_pfasst_block_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node6" class="node">
<title>proc~pf_pfasst_block_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node6"><a xlink:href=".././proc/pf_pfasst_block_oc.html" xlink:title="pf_pfasst_block_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="218,-55 114,-55 114,-31 218,-31 218,-55"/>
<text text-anchor="middle" x="166" y="-40.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_block_oc</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_block_oc&#45;&gt;proc~pf_v_cycle_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge7" class="edge">
<title>proc~pf_pfasst_block_oc&#45;&gt;proc~pf_v_cycle_oc</title>
<path fill="none" stroke="#000000" d="M218.3501,-47.3791C227.923,-48.1799 237.8917,-49.0138 247.3971,-49.8089"/>
<polygon fill="#000000" stroke="#000000" points="247.2321,-53.3072 257.4891,-50.6531 247.8157,-46.3316 247.2321,-53.3072"/>
</g>
<!-- proc~pf_pfasst_block_oc&#45;&gt;proc~pf_predictor_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge8" class="edge">
<title>proc~pf_pfasst_block_oc&#45;&gt;proc~pf_predictor_oc</title>
<path fill="none" stroke="#000000" d="M217.2179,-30.9258C226.0204,-28.8507 235.1888,-26.6893 244.0483,-24.6008"/>
<polygon fill="#000000" stroke="#000000" points="244.9536,-27.9834 253.8836,-22.2822 243.3473,-21.1702 244.9536,-27.9834"/>
</g>
<!-- proc~pf_block_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node7" class="node">
<title>proc~pf_block_run</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node7"><a xlink:href=".././proc/pf_block_run.html" xlink:title="pf_block_run">
<polygon fill="#d9534f" stroke="#d9534f" points="203,-118 129,-118 129,-94 203,-94 203,-118"/>
<text text-anchor="middle" x="166" y="-103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_block_run</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge5" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M203.3309,-115.0843C218.5291,-118.7828 236.236,-123.0917 252.1674,-126.9685"/>
<polygon fill="#000000" stroke="#000000" points="251.792,-130.4792 262.336,-129.443 253.4472,-123.6777 251.792,-130.4792"/>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_v_cycle -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge6" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_v_cycle</title>
<path fill="none" stroke="#000000" d="M203.3309,-103.1611C219.68,-101.9179 238.932,-100.4538 255.7541,-99.1746"/>
<polygon fill="#000000" stroke="#000000" points="256.1607,-102.6539 265.8665,-98.4056 255.6299,-95.674 256.1607,-102.6539"/>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node8" class="node">
<title>proc~pf_pfasst_run</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node8"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-118 0,-118 0,-94 78,-94 78,-118"/>
<text text-anchor="middle" x="39" y="-103.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge9" class="edge">
<title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.1405,-106C91.0338,-106 105.5063,-106 118.9275,-106"/>
<polygon fill="#000000" stroke="#000000" points="118.9423,-109.5001 128.9423,-106 118.9423,-102.5001 118.9423,-109.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/restrict_time_space_fas.html#src">restrict_time_space_fas</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">restrict_time_space_fas</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">mystep</span><span class="p">)</span>
    <span class="c">!! Restrict (in time and space) fine level to coarse and set coarse level FAS correction.</span>
    <span class="c">!!</span>
    <span class="c">!! The coarse function values are re-evaluated after restriction.</span>
    <span class="c">!! Note that even if the number of variables and nodes is the same,</span>
    <span class="c">!! we should still compute the FAS correction since the function</span>
    <span class="c">!! evaluations may be different.</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">target</span> <span class="kd">::</span> <span class="n">pf</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">t0</span>            <span class="c">!!  time at beginning of step</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dt</span>            <span class="c">!!  time step</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">level_index</span>   <span class="c">!! defines which level to restrict</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">flags</span><span class="p">,</span> <span class="n">mystep</span>    

    <span class="c">!&gt;  Local variables</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c_lev</span>    
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">f_lev</span>

    <span class="kt">integer</span>    <span class="kd">::</span> <span class="n">m</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span><span class="n">ierr</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">c_times</span><span class="p">(:)</span>  <span class="c">!!  Simulation time at coarse nodes  </span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">f_times</span><span class="p">(:)</span>  <span class="c">!!  Simulation time at fine nodes</span>
    
    
    <span class="n">f_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
    <span class="n">c_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">mystep</span><span class="p">))</span> <span class="n">step</span> <span class="o">=</span> <span class="n">mystep</span>
    
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">PF_PRE_RESTRICT_ALL</span><span class="p">)</span>
    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TRESTRICT</span> <span class="o">+</span> <span class="n">level_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    

    <span class="k">allocate</span><span class="p">(</span><span class="n">c_times</span><span class="p">(</span><span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail, error=&#39;</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>    
    <span class="k">allocate</span><span class="p">(</span><span class="n">f_times</span><span class="p">(</span><span class="n">f_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail, error=&#39;</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>    

    <span class="c">!&gt; restrict q&#39;s and recompute f&#39;s</span>
    <span class="n">c_times</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">c_lev</span><span class="p">%</span><span class="n">nodes</span>
    <span class="n">f_times</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f_lev</span><span class="p">%</span><span class="n">nodes</span>

    <span class="k">call </span><span class="n">restrict_ts</span><span class="p">(</span><span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="n">f_times</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

    <span class="c">!&gt;  Recompute the functions</span>
    <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">evaluate_all</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_times</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>

    <span class="c">!&gt;  Compute  FAS correction</span>
    <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
       <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">setval</span><span class="p">(</span><span class="mf">0.0_pfdp</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">&gt;=</span> <span class="n">pf</span><span class="p">%</span><span class="n">taui0</span><span class="p">)</span>  <span class="k">then</span>
       <span class="c">! compute &#39;0 to node&#39; integral on the coarse level</span>
      <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">c_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="p">&amp;</span>
           <span class="n">c_lev</span><span class="p">%</span><span class="n">F</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
       <span class="c">! compute &#39;0 to node&#39; integral on the fine level</span>
      <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">f_lev</span><span class="p">%</span><span class="n">F</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
       <span class="c">!  put tau in on fine level</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">level_index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
             <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">       end if</span>
       <span class="c">!  Subtract coarse integral</span>
       <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
       <span class="k">end do</span>

       <span class="c">! restrict &#39;0 to node&#39; integral on the fine level  in time and space</span>
       <span class="k">call </span><span class="n">restrict_ts_integral</span><span class="p">(</span><span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">f_times</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">! Add fine restriction of fine integral (stored on coarse)</span>
       <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
       <span class="k">end do</span>

<span class="c">!!$       if (pf%use_Sform) then</span>
<span class="c">!!$          do m = c_lev%nnodes-1,2,-1</span>
<span class="c">!!$!             call c_lev%tauQ(m)%axpy(-1.0_pfdp, c_lev%tauQ(m-1), flags)</span>
<span class="c">!!$          end do</span>
<span class="c">!!$       end if</span>
       
    <span class="k">end if</span>

<span class="k">    call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TRESTRICT</span> <span class="o">+</span> <span class="n">level_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">PF_POST_RESTRICT_ALL</span><span class="p">)</span>

    <span class="k">deallocate</span><span class="p">(</span><span class="n">c_times</span><span class="p">)</span>
    <span class="k">deallocate</span><span class="p">(</span><span class="n">f_times</span><span class="p">)</span>

  <span class="k">end subroutine </span><span class="n">restrict_time_space_fas</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>