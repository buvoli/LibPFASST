<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>restrict_time_space_fas &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>restrict_time_space_fas
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">49 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_restrict.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_restrict.f90.html'>pf_restrict.f90</a></li>
    
     <li><a href='../module/pf_mod_restrict.html'>pf_mod_restrict</a></li>
    
  
     <li class="active">restrict_time_space_fas</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/restrict_time_space_fas.html#src">restrict_time_space_fas</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine restrict_time_space_fas(pf, t0, dt, level_index, flags, mystep)
    
    
   
</h2>
    
  


    
    <p>Restrict (in time and space) fine level to coarse and set coarse level FAS correction.</p>
<p>The coarse function values are re-evaluated after restriction.
 Note that even if the number of variables and nodes is the same,
 we should still compute the FAS correction since the function
 evaluations may be different.
 restrict q's and recompute f's
  Recompute the functions</p>
<p>Compute  FAS correction
$       if (pf%use_Sform) then
$          do m = c_lev%nnodes-1,2,-1
$!             call c_lev%tauQ(m)%axpy(-1.0_pfdp, c_lev%tauQ(m-1), flags)
$          end do
$       end if</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E27"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E12"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td><p>time at beginning of step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E21"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>time step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-level_index%7E35"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>level_index</strong></td><td><p>defines which level to restrict</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E47"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mystep"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>mystep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~restrict_time_space_fas~~CallsGraph Pages: 1 -->
<svg id="procrestrict_time_space_fasCallsGraph" width="383pt" height="116pt"
 viewBox="0.00 0.00 383.00 116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~restrict_time_space_fas~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>proc~~restrict_time_space_fas~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-112 379,-112 379,4 -4,4"/>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node1" class="node">
<title>proc~restrict_time_space_fas</title>
<polygon fill="none" stroke="#000000" points="126,-66 0,-66 0,-42 126,-42 126,-66"/>
<text text-anchor="middle" x="63" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">restrict_time_space_fas</text>
</g>
<!-- proc~call_hooks -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node2" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node2"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="243.5,-108 180.5,-108 180.5,-84 243.5,-84 243.5,-108"/>
<text text-anchor="middle" x="212" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge1" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M105.6974,-66.0355C126.0015,-71.7588 150.1855,-78.5758 170.353,-84.2606"/>
<polygon fill="#000000" stroke="#000000" points="169.6183,-87.6898 180.1928,-87.0342 171.5175,-80.9524 169.6183,-87.6898"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node3" class="node">
<title>proc~restrict_ts</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node3"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="241.5,-66 182.5,-66 182.5,-42 241.5,-42 241.5,-66"/>
<text text-anchor="middle" x="212" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge2" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M126.1894,-54C141.7379,-54 157.9593,-54 172.0591,-54"/>
<polygon fill="#000000" stroke="#000000" points="172.3815,-57.5001 182.3815,-54 172.3814,-50.5001 172.3815,-57.5001"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node4" class="node">
<title>proc~restrict_ts_integral</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node4"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="262,-24 162,-24 162,0 262,0 262,-24"/>
<text text-anchor="middle" x="212" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge3" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M105.6974,-41.9645C122.375,-37.2634 141.6702,-31.8245 159.2071,-26.8812"/>
<polygon fill="#000000" stroke="#000000" points="160.621,-30.1191 169.2963,-24.0373 158.7218,-23.3817 160.621,-30.1191"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node5" class="node">
<title>proc~pf_apply_mat</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node5"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-45 298,-45 298,-21 375,-21 375,-45"/>
<text text-anchor="middle" x="336.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge4" class="edge">
<title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M241.5048,-49.0233C255.3075,-46.6951 272.1129,-43.8605 287.7295,-41.2264"/>
<polygon fill="#000000" stroke="#000000" points="288.498,-44.6462 297.7766,-39.5317 287.3337,-37.7437 288.498,-44.6462"/>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge5" class="edge">
<title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M262.28,-20.481C270.7244,-21.9053 279.4741,-23.3812 287.8755,-24.7983"/>
<polygon fill="#000000" stroke="#000000" points="287.464,-28.2782 297.9069,-26.4903 288.6283,-21.3757 287.464,-28.2782"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~restrict_time_space_fas~~CalledByGraph Pages: 1 -->
<svg id="procrestrict_time_space_fasCalledByGraph" width="521pt" height="200pt"
 viewBox="0.00 0.00 521.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~restrict_time_space_fas~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 196)">
<title>proc~~restrict_time_space_fas~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-196 517,-196 517,4 -4,4"/>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node1" class="node">
<title>proc~restrict_time_space_fas</title>
<polygon fill="none" stroke="#000000" points="513,-108 387,-108 387,-84 513,-84 513,-108"/>
<text text-anchor="middle" x="450" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">restrict_time_space_fas</text>
</g>
<!-- proc~pf_v_cycle_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node2" class="node">
<title>proc~pf_v_cycle_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node2"><a xlink:href=".././proc/pf_v_cycle_oc.html" xlink:title="pf_v_cycle_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="342.5,-192 262.5,-192 262.5,-168 342.5,-168 342.5,-192"/>
<text text-anchor="middle" x="302.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_v_cycle_oc</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle_oc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge1" class="edge">
<title>proc~pf_v_cycle_oc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M332.3467,-167.9604C338.5963,-165.1948 345.0827,-162.1386 351,-159 376.9081,-145.2582 404.9829,-127.0503 424.5955,-113.7442"/>
<polygon fill="#000000" stroke="#000000" points="426.6985,-116.5461 432.9731,-108.0091 422.7442,-110.7699 426.6985,-116.5461"/>
</g>
<!-- proc~pf_vcycle_pysdc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node3" class="node">
<title>proc~pf_vcycle_pysdc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node3"><a xlink:href=".././proc/pf_vcycle_pysdc.html" xlink:title="pf_Vcycle_pySDC">
<polygon fill="#d9534f" stroke="#d9534f" points="351,-108 254,-108 254,-84 351,-84 351,-108"/>
<text text-anchor="middle" x="302.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_Vcycle_pySDC</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge2" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M351.2058,-96C359.4083,-96 368.0798,-96 376.7423,-96"/>
<polygon fill="#000000" stroke="#000000" points="376.8785,-99.5001 386.8784,-96 376.8784,-92.5001 376.8785,-99.5001"/>
</g>
<!-- proc~pf_predictor_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node4" class="node">
<title>proc~pf_predictor_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node4"><a xlink:href=".././proc/pf_predictor_oc.html" xlink:title="pf_predictor_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="346,-150 259,-150 259,-126 346,-126 346,-150"/>
<text text-anchor="middle" x="302.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_predictor_oc</text>
</a>
</g>
</g>
<!-- proc~pf_predictor_oc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge3" class="edge">
<title>proc~pf_predictor_oc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M344.7676,-125.9645C361.2773,-121.2634 380.3782,-115.8245 397.7386,-110.8812"/>
<polygon fill="#000000" stroke="#000000" points="399.0671,-114.1421 407.7262,-108.0373 397.15,-107.4097 399.0671,-114.1421"/>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node5" class="node">
<title>proc~pf_predictor</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node5"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-66 267.5,-66 267.5,-42 337.5,-42 337.5,-66"/>
<text text-anchor="middle" x="302.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge4" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M337.8299,-64.06C355.7657,-69.1672 377.9076,-75.472 397.7679,-81.1271"/>
<polygon fill="#000000" stroke="#000000" points="397.0311,-84.5564 407.6074,-83.9289 398.9482,-77.824 397.0311,-84.5564"/>
</g>
<!-- proc~pf_vcycle -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node6" class="node">
<title>proc~pf_vcycle</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node6"><a xlink:href=".././proc/pf_vcycle.html" xlink:title="pf_Vcycle">
<polygon fill="#d9534f" stroke="#d9534f" points="331.5,-24 273.5,-24 273.5,0 331.5,0 331.5,-24"/>
<text text-anchor="middle" x="302.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_Vcycle</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge5" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M331.5774,-23.7002C338.0623,-26.5542 344.8395,-29.7324 351,-33 376.9081,-46.7418 404.9829,-64.9497 424.5955,-78.2558"/>
<polygon fill="#000000" stroke="#000000" points="422.7442,-81.2301 432.9731,-83.9909 426.6985,-75.4539 422.7442,-81.2301"/>
</g>
<!-- proc~pf_block_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node7" class="node">
<title>proc~pf_block_run</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node7"><a xlink:href=".././proc/pf_block_run.html" xlink:title="pf_block_run">
<polygon fill="#d9534f" stroke="#d9534f" points="203,-66 129,-66 129,-42 203,-42 203,-66"/>
<text text-anchor="middle" x="166" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_block_run</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_vcycle_pysdc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge7" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_vcycle_pysdc</title>
<path fill="none" stroke="#000000" d="M203.2992,-65.4767C218.7262,-70.2235 236.8299,-75.7938 253.3191,-80.8674"/>
<polygon fill="#000000" stroke="#000000" points="252.7518,-84.3547 263.3389,-83.9504 254.8104,-77.6643 252.7518,-84.3547"/>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge9" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M203.2992,-54C219.7721,-54 239.297,-54 256.6492,-54"/>
<polygon fill="#000000" stroke="#000000" points="257.126,-57.5001 267.1259,-54 257.1259,-50.5001 257.126,-57.5001"/>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_vcycle -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge10" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_vcycle</title>
<path fill="none" stroke="#000000" d="M203.2992,-42.5233C222.0341,-36.7587 244.7167,-29.7795 263.661,-23.9505"/>
<polygon fill="#000000" stroke="#000000" points="264.9399,-27.219 273.4683,-20.9328 262.8812,-20.5285 264.9399,-27.219"/>
</g>
<!-- proc~pf_pfasst_block_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node8" class="node">
<title>proc~pf_pfasst_block_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node8"><a xlink:href=".././proc/pf_pfasst_block_oc.html" xlink:title="pf_pfasst_block_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="218,-171 114,-171 114,-147 218,-147 218,-171"/>
<text text-anchor="middle" x="166" y="-156.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_block_oc</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_block_oc&#45;&gt;proc~pf_v_cycle_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge6" class="edge">
<title>proc~pf_pfasst_block_oc&#45;&gt;proc~pf_v_cycle_oc</title>
<path fill="none" stroke="#000000" d="M218.3841,-167.0591C229.5511,-168.7771 241.3181,-170.5874 252.3971,-172.2919"/>
<polygon fill="#000000" stroke="#000000" points="251.9254,-175.7604 262.3413,-173.8217 252.9898,-168.8418 251.9254,-175.7604"/>
</g>
<!-- proc~pf_pfasst_block_oc&#45;&gt;proc~pf_predictor_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge8" class="edge">
<title>proc~pf_pfasst_block_oc&#45;&gt;proc~pf_predictor_oc</title>
<path fill="none" stroke="#000000" d="M218.3841,-150.9409C228.421,-149.3968 238.9426,-147.7781 249.0137,-146.2287"/>
<polygon fill="#000000" stroke="#000000" points="249.5485,-149.6876 258.9,-144.7077 248.4841,-142.769 249.5485,-149.6876"/>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node9" class="node">
<title>proc~pf_pfasst_run</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node9"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-66 0,-66 0,-42 78,-42 78,-66"/>
<text text-anchor="middle" x="39" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge11" class="edge">
<title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.1405,-54C91.0338,-54 105.5063,-54 118.9275,-54"/>
<polygon fill="#000000" stroke="#000000" points="118.9423,-57.5001 128.9423,-54 118.9423,-50.5001 118.9423,-57.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/restrict_time_space_fas.html#src">restrict_time_space_fas</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">restrict_time_space_fas</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">mystep</span><span class="p">)</span>
    <span class="c">!! Restrict (in time and space) fine level to coarse and set coarse level FAS correction.</span>
    <span class="c">!!</span>
    <span class="c">!! The coarse function values are re-evaluated after restriction.</span>
    <span class="c">!! Note that even if the number of variables and nodes is the same,</span>
    <span class="c">!! we should still compute the FAS correction since the function</span>
    <span class="c">!! evaluations may be different.</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">target</span> <span class="kd">::</span> <span class="n">pf</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">t0</span>            <span class="c">!!  time at beginning of step</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dt</span>            <span class="c">!!  time step</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">level_index</span>   <span class="c">!! defines which level to restrict</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">flags</span><span class="p">,</span> <span class="n">mystep</span>    

    <span class="c">!&gt;  Local variables</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c_lev</span>    
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">f_lev</span>

    <span class="kt">integer</span>    <span class="kd">::</span> <span class="n">m</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span><span class="n">ierr</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">c_times</span><span class="p">(:)</span>  <span class="c">!!  Simulation time at coarse nodes  </span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">f_times</span><span class="p">(:)</span>  <span class="c">!!  Simulation time at fine nodes</span>
    
    
    <span class="n">f_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
    <span class="n">c_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">mystep</span><span class="p">))</span> <span class="n">step</span> <span class="o">=</span> <span class="n">mystep</span>
    
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">PF_PRE_RESTRICT_ALL</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_RESTRICT</span><span class="p">,</span> <span class="n">level_index</span><span class="p">)</span>
    

    <span class="k">allocate</span><span class="p">(</span><span class="n">c_times</span><span class="p">(</span><span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail, error=&#39;</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>    
    <span class="k">allocate</span><span class="p">(</span><span class="n">f_times</span><span class="p">(</span><span class="n">f_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail, error=&#39;</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>    

    <span class="c">!&gt; restrict q&#39;s and recompute f&#39;s</span>
    <span class="n">c_times</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">c_lev</span><span class="p">%</span><span class="n">nodes</span>
    <span class="n">f_times</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f_lev</span><span class="p">%</span><span class="n">nodes</span>

    <span class="k">call </span><span class="n">restrict_ts</span><span class="p">(</span><span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="n">f_times</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

    <span class="c">!&gt;  Recompute the functions</span>
    <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">evaluate_all</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_times</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>

    <span class="c">!&gt;  Compute  FAS correction</span>
    <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
       <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">setval</span><span class="p">(</span><span class="mf">0.0_pfdp</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">&gt;=</span> <span class="n">pf</span><span class="p">%</span><span class="n">taui0</span><span class="p">)</span>  <span class="k">then</span>

       <span class="c">! compute &#39;0 to node&#39; integral on the coarse level</span>
      <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">c_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="p">&amp;</span>
           <span class="n">c_lev</span><span class="p">%</span><span class="n">F</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
       <span class="c">! compute &#39;0 to node&#39; integral on the fine level</span>
      <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">f_lev</span><span class="p">%</span><span class="n">F</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
       <span class="c">!  put tau in on fine level</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">level_index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
             <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">       end if</span>
       <span class="c">!  Subtract coarse integral</span>
       <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
       <span class="k">end do</span>

       <span class="c">! restrict &#39;0 to node&#39; integral on the fine level  in time and space</span>
       <span class="k">call </span><span class="n">restrict_ts_integral</span><span class="p">(</span><span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">f_times</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">! Add fine restriction of fine integral (stored on coarse)</span>
       <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
       <span class="k">end do</span>

<span class="c">!!$       if (pf%use_Sform) then</span>
<span class="c">!!$          do m = c_lev%nnodes-1,2,-1</span>
<span class="c">!!$!             call c_lev%tauQ(m)%axpy(-1.0_pfdp, c_lev%tauQ(m-1), flags)</span>
<span class="c">!!$          end do</span>
<span class="c">!!$       end if</span>
       
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_RESTRICT</span><span class="p">,</span><span class="n">level_index</span><span class="p">)</span>
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">PF_POST_RESTRICT_ALL</span><span class="p">)</span>

    <span class="k">deallocate</span><span class="p">(</span><span class="n">c_times</span><span class="p">)</span>
    <span class="k">deallocate</span><span class="p">(</span><span class="n">f_times</span><span class="p">)</span>

  <span class="k">end subroutine </span><span class="n">restrict_time_space_fas</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>