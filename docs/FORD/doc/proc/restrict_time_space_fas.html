<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>restrict_time_space_fas &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>restrict_time_space_fas
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">49 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_restrict.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_restrict.f90.html'>pf_restrict.f90</a></li>
    
     <li><a href='../module/pf_mod_restrict.html'>pf_mod_restrict</a></li>
    
  
     <li class="active">restrict_time_space_fas</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/restrict_time_space_fas.html#src">restrict_time_space_fas</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine restrict_time_space_fas(pf, t0, dt, level_index, flags, mystep)
    
    
   
</h2>
    
  


    
    <p>Restrict (in time and space) fine level to coarse and set coarse level FAS correction.</p>
<p>The coarse function values are re-evaluated after restriction.
 Note that even if the number of variables and nodes is the same,
 we should still compute the FAS correction since the function
 evaluations may be different.
 restrict q's and recompute f's
  Recompute the functions</p>
<p>Compute  FAS correction
$       if (pf%use_Sform) then
$          do m = c_lev%nnodes-1,2,-1
$!             call c_lev%tauQ(m)%axpy(-1.0_pfdp, c_lev%tauQ(m-1), flags)
$          end do
$       end if</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E25"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E10"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td><p>time at beginning of step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E19"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>time step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-level_index%7E31"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>level_index</strong></td><td><p>defines which level to restrict</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E30"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mystep"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>mystep</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~restrict_time_space_fas~~CallsGraph Pages: 1 -->
<svg id="procrestrict_time_space_fasCallsGraph" width="483pt" height="171pt"
 viewBox="0.00 0.00 483.00 170.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~restrict_time_space_fas~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 166.7186)">
<title>proc~~restrict_time_space_fas~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-166.7186 479,-166.7186 479,4 -4,4"/>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node1" class="node">
<title>proc~restrict_time_space_fas</title>
<polygon fill="none" stroke="#000000" points="126,-80.7186 0,-80.7186 0,-56.7186 126,-56.7186 126,-80.7186"/>
<text text-anchor="middle" x="63" y="-66.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">restrict_time_space_fas</text>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node2" class="node">
<title>proc~restrict_ts_integral</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node2"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="262,-162.7186 162,-162.7186 162,-138.7186 262,-138.7186 262,-162.7186"/>
<text text-anchor="middle" x="212" y="-148.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge1" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M80.7595,-80.8248C100.2071,-93.8025 132.5555,-114.579 162,-129.7186 165.2472,-131.3882 168.658,-133.0339 172.1084,-134.6246"/>
<polygon fill="#000000" stroke="#000000" points="170.6889,-137.8238 181.2487,-138.6855 173.5311,-131.4267 170.6889,-137.8238"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node3" class="node">
<title>proc~end_timer</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node3"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="367,-70.7186 306,-70.7186 306,-46.7186 367,-46.7186 367,-70.7186"/>
<text text-anchor="middle" x="336.5" y="-56.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge2" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M126.0898,-66.4118C178.2289,-64.5054 250.7307,-61.8546 295.5804,-60.2147"/>
<polygon fill="#000000" stroke="#000000" points="295.9438,-63.7039 305.8092,-59.8407 295.6879,-56.7085 295.9438,-63.7039"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node4" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node4"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="243.5,-40.7186 180.5,-40.7186 180.5,-16.7186 243.5,-16.7186 243.5,-40.7186"/>
<text text-anchor="middle" x="212" y="-26.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge3" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M107.7049,-56.7172C127.5599,-51.387 150.7953,-45.1493 170.2891,-39.9161"/>
<polygon fill="#000000" stroke="#000000" points="171.3538,-43.2543 180.1043,-37.2812 169.5388,-36.4937 171.3538,-43.2543"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node5" class="node">
<title>proc~start_timer</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node5"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="368.5,-28.7186 304.5,-28.7186 304.5,-4.7186 368.5,-4.7186 368.5,-28.7186"/>
<text text-anchor="middle" x="336.5" y="-14.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge4" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M76.8752,-56.6425C94.9994,-41.75 128.3972,-17.2398 162,-7.7186 205.8309,4.7008 258.2876,-.548 294.1664,-7.0097"/>
<polygon fill="#000000" stroke="#000000" points="293.8034,-10.5035 304.2827,-8.9428 295.1174,-3.628 293.8034,-10.5035"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node6" class="node">
<title>proc~restrict_ts</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node6"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="241.5,-120.7186 182.5,-120.7186 182.5,-96.7186 241.5,-96.7186 241.5,-120.7186"/>
<text text-anchor="middle" x="212" y="-106.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge5" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M107.7049,-80.7199C128.3843,-86.2714 152.7307,-92.8073 172.6974,-98.1675"/>
<polygon fill="#000000" stroke="#000000" points="171.8382,-101.5607 182.4038,-100.7733 173.6532,-94.8001 171.8382,-101.5607"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node8" class="node">
<title>proc~pf_apply_mat</title>
<g id="a_proc~~restrict_time_space_fas~~CallsGraph_node8"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="375,-130.7186 298,-130.7186 298,-106.7186 375,-106.7186 375,-130.7186"/>
<text text-anchor="middle" x="336.5" y="-116.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge6" class="edge">
<title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M258.7134,-138.7119C268.2385,-136.2637 278.282,-133.6822 287.872,-131.2173"/>
<polygon fill="#000000" stroke="#000000" points="288.8469,-134.5806 297.6608,-128.7013 287.1043,-127.8009 288.8469,-134.5806"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_node7" class="node">
<title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="475,-49.7186 411,-49.7186 411,-25.7186 475,-25.7186 475,-49.7186"/>
<text text-anchor="middle" x="443" y="-35.3186" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge7" class="edge">
<title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M367.0186,-52.7008C377.56,-50.6222 389.5645,-48.2551 400.8693,-46.026"/>
<polygon fill="#000000" stroke="#000000" points="401.8584,-49.3985 410.9923,-44.0299 400.5041,-42.5307 401.8584,-49.3985"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge8" class="edge">
<title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M243.7387,-36.3665C259.4892,-40.1618 278.702,-44.7913 295.5484,-48.8507"/>
<polygon fill="#000000" stroke="#000000" points="295.1381,-52.3519 305.6797,-51.292 296.7779,-45.5467 295.1381,-52.3519"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge9" class="edge">
<title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M243.7387,-25.6594C259.1313,-24.1758 277.8305,-22.3735 294.3962,-20.7768"/>
<polygon fill="#000000" stroke="#000000" points="294.7683,-24.2572 304.3863,-19.8139 294.0966,-17.2895 294.7683,-24.2572"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge10" class="edge">
<title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M368.7425,-23.0762C378.8566,-25.0706 390.1748,-27.3023 400.8672,-29.4107"/>
<polygon fill="#000000" stroke="#000000" points="400.3788,-32.8817 410.8671,-31.3825 401.7331,-26.014 400.3788,-32.8817"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~restrict_time_space_fas~~CallsGraph_edge11" class="edge">
<title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M241.5048,-111.0884C255.3075,-112.1971 272.1129,-113.5469 287.7295,-114.8013"/>
<polygon fill="#000000" stroke="#000000" points="287.5284,-118.2963 297.7766,-115.6082 288.0889,-111.3188 287.5284,-118.2963"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~restrict_time_space_fas~~CalledByGraph Pages: 1 -->
<svg id="procrestrict_time_space_fasCalledByGraph" width="511pt" height="158pt"
 viewBox="0.00 0.00 511.00 158.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~restrict_time_space_fas~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 154)">
<title>proc~~restrict_time_space_fas~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-154 507,-154 507,4 -4,4"/>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node1" class="node">
<title>proc~restrict_time_space_fas</title>
<polygon fill="none" stroke="#000000" points="503,-87 377,-87 377,-63 503,-63 503,-87"/>
<text text-anchor="middle" x="440" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">restrict_time_space_fas</text>
</g>
<!-- proc~pf_predictor_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node2" class="node">
<title>proc~pf_predictor_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node2"><a xlink:href=".././proc/pf_predictor_oc.html" xlink:title="pf_predictor_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="341,-150 254,-150 254,-126 341,-126 341,-150"/>
<text text-anchor="middle" x="297.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_predictor_oc</text>
</a>
</g>
</g>
<!-- proc~pf_predictor_oc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge1" class="edge">
<title>proc~pf_predictor_oc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M324.9754,-125.853C347.2519,-116.0044 378.8492,-102.0351 403.2919,-91.2289"/>
<polygon fill="#000000" stroke="#000000" points="404.8781,-94.3544 412.6089,-87.1097 402.0476,-87.9522 404.8781,-94.3544"/>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node3" class="node">
<title>proc~pf_predictor</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node3"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="332.5,-66 262.5,-66 262.5,-42 332.5,-42 332.5,-66"/>
<text text-anchor="middle" x="297.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge2" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M332.7247,-59.191C343.1558,-60.7282 354.9849,-62.4715 366.8835,-64.2249"/>
<polygon fill="#000000" stroke="#000000" points="366.4619,-67.7005 376.8654,-65.696 367.4826,-60.7753 366.4619,-67.7005"/>
</g>
<!-- proc~pf_v_cycle -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node4" class="node">
<title>proc~pf_v_cycle</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node4"><a xlink:href=".././proc/pf_v_cycle.html" xlink:title="pf_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="329,-24 266,-24 266,0 329,0 329,-24"/>
<text text-anchor="middle" x="297.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge3" class="edge">
<title>proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M324.9754,-24.147C347.2519,-33.9956 378.8492,-47.9649 403.2919,-58.7711"/>
<polygon fill="#000000" stroke="#000000" points="402.0476,-62.0478 412.6089,-62.8903 404.8781,-55.6456 402.0476,-62.0478"/>
</g>
<!-- proc~pf_v_cycle_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node5" class="node">
<title>proc~pf_v_cycle_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node5"><a xlink:href=".././proc/pf_v_cycle_oc.html" xlink:title="pf_v_cycle_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="337.5,-108 257.5,-108 257.5,-84 337.5,-84 337.5,-108"/>
<text text-anchor="middle" x="297.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_v_cycle_oc</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle_oc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge4" class="edge">
<title>proc~pf_v_cycle_oc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M337.5734,-90.0944C346.711,-88.7479 356.7007,-87.2757 366.7436,-85.7957"/>
<polygon fill="#000000" stroke="#000000" points="367.3918,-89.2381 376.7746,-84.3174 366.3711,-82.3128 367.3918,-89.2381"/>
</g>
<!-- proc~pf_block_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node6" class="node">
<title>proc~pf_block_run</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node6"><a xlink:href=".././proc/pf_block_run.html" xlink:title="pf_block_run">
<polygon fill="#d9534f" stroke="#d9534f" points="203,-45 129,-45 129,-21 203,-21 203,-45"/>
<text text-anchor="middle" x="166" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_block_run</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge6" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M203.3309,-38.9616C218.5291,-41.3887 236.236,-44.2164 252.1674,-46.7606"/>
<polygon fill="#000000" stroke="#000000" points="251.9092,-50.2636 262.336,-48.3845 253.0131,-43.3512 251.9092,-50.2636"/>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_v_cycle -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge7" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_v_cycle</title>
<path fill="none" stroke="#000000" d="M203.3309,-27.0384C219.68,-24.4275 238.932,-21.3531 255.7541,-18.6666"/>
<polygon fill="#000000" stroke="#000000" points="256.5436,-22.085 265.8665,-17.0517 255.4397,-15.1726 256.5436,-22.085"/>
</g>
<!-- proc~pf_pfasst_block_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node7" class="node">
<title>proc~pf_pfasst_block_oc</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node7"><a xlink:href=".././proc/pf_pfasst_block_oc.html" xlink:title="pf_pfasst_block_oc">
<polygon fill="#d9534f" stroke="#d9534f" points="218,-129 114,-129 114,-105 218,-105 218,-129"/>
<text text-anchor="middle" x="166" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_block_oc</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_block_oc&#45;&gt;proc~pf_predictor_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge5" class="edge">
<title>proc~pf_pfasst_block_oc&#45;&gt;proc~pf_predictor_oc</title>
<path fill="none" stroke="#000000" d="M218.3501,-125.3601C226.701,-126.6937 235.3529,-128.0754 243.7359,-129.4141"/>
<polygon fill="#000000" stroke="#000000" points="243.3626,-132.8988 253.7895,-131.0196 244.4666,-125.9863 243.3626,-132.8988"/>
</g>
<!-- proc~pf_pfasst_block_oc&#45;&gt;proc~pf_v_cycle_oc -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge8" class="edge">
<title>proc~pf_pfasst_block_oc&#45;&gt;proc~pf_v_cycle_oc</title>
<path fill="none" stroke="#000000" d="M218.3501,-108.6399C227.923,-107.1112 237.8917,-105.5192 247.3971,-104.0012"/>
<polygon fill="#000000" stroke="#000000" points="248.1662,-107.4228 257.4891,-102.3896 247.0623,-100.5104 248.1662,-107.4228"/>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_node8" class="node">
<title>proc~pf_pfasst_run</title>
<g id="a_proc~~restrict_time_space_fas~~CalledByGraph_node8"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-45 0,-45 0,-21 78,-21 78,-45"/>
<text text-anchor="middle" x="39" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~restrict_time_space_fas~~CalledByGraph_edge9" class="edge">
<title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.1405,-33C91.0338,-33 105.5063,-33 118.9275,-33"/>
<polygon fill="#000000" stroke="#000000" points="118.9423,-36.5001 128.9423,-33 118.9423,-29.5001 118.9423,-36.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/restrict_time_space_fas.html#src">restrict_time_space_fas</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">restrict_time_space_fas</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">mystep</span><span class="p">)</span>
    <span class="c">!! Restrict (in time and space) fine level to coarse and set coarse level FAS correction.</span>
    <span class="c">!!</span>
    <span class="c">!! The coarse function values are re-evaluated after restriction.</span>
    <span class="c">!! Note that even if the number of variables and nodes is the same,</span>
    <span class="c">!! we should still compute the FAS correction since the function</span>
    <span class="c">!! evaluations may be different.</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">target</span> <span class="kd">::</span> <span class="n">pf</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">t0</span>            <span class="c">!!  time at beginning of step</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dt</span>            <span class="c">!!  time step</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">level_index</span>   <span class="c">!! defines which level to restrict</span>
    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">flags</span><span class="p">,</span> <span class="n">mystep</span>    

    <span class="c">!&gt;  Local variables</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c_lev</span>    
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">f_lev</span>

    <span class="kt">integer</span>    <span class="kd">::</span> <span class="n">m</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span><span class="n">ierr</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">c_times</span><span class="p">(:)</span>  <span class="c">!!  Simulation time at coarse nodes  </span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">f_times</span><span class="p">(:)</span>  <span class="c">!!  Simulation time at fine nodes</span>
    
    
    <span class="n">f_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
    <span class="n">c_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">mystep</span><span class="p">))</span> <span class="n">step</span> <span class="o">=</span> <span class="n">mystep</span>
    
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">PF_PRE_RESTRICT_ALL</span><span class="p">)</span>
    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TRESTRICT</span> <span class="o">+</span> <span class="n">level_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    

    <span class="k">allocate</span><span class="p">(</span><span class="n">c_times</span><span class="p">(</span><span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail, error=&#39;</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>    
    <span class="k">allocate</span><span class="p">(</span><span class="n">f_times</span><span class="p">(</span><span class="n">f_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail, error=&#39;</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>    

    <span class="c">!&gt; restrict q&#39;s and recompute f&#39;s</span>
    <span class="n">c_times</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">c_lev</span><span class="p">%</span><span class="n">nodes</span>
    <span class="n">f_times</span> <span class="o">=</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f_lev</span><span class="p">%</span><span class="n">nodes</span>

    <span class="k">call </span><span class="n">restrict_ts</span><span class="p">(</span><span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="n">f_times</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

    <span class="c">!&gt;  Recompute the functions</span>
    <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">evaluate_all</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_times</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>

    <span class="c">!&gt;  Compute  FAS correction</span>
    <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
       <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">setval</span><span class="p">(</span><span class="mf">0.0_pfdp</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">&gt;=</span> <span class="n">pf</span><span class="p">%</span><span class="n">taui0</span><span class="p">)</span>  <span class="k">then</span>
       <span class="c">! compute &#39;0 to node&#39; integral on the coarse level</span>
      <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="n">c_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="p">&amp;</span>
           <span class="n">c_lev</span><span class="p">%</span><span class="n">F</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
       <span class="c">! compute &#39;0 to node&#39; integral on the fine level</span>
      <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="p">&amp;</span>
        <span class="n">f_lev</span><span class="p">%</span><span class="n">F</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
       <span class="c">!  put tau in on fine level</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">level_index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
             <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">       end if</span>
       <span class="c">!  Subtract coarse integral</span>
       <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
       <span class="k">end do</span>

       <span class="c">! restrict &#39;0 to node&#39; integral on the fine level  in time and space</span>
       <span class="k">call </span><span class="n">restrict_ts_integral</span><span class="p">(</span><span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">f_times</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">! Add fine restriction of fine integral (stored on coarse)</span>
       <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">axpy</span><span class="p">(</span><span class="mf">1.0_pfdp</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">I</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">flags</span><span class="p">)</span>
       <span class="k">end do</span>

<span class="c">!!$       if (pf%use_Sform) then</span>
<span class="c">!!$          do m = c_lev%nnodes-1,2,-1</span>
<span class="c">!!$!             call c_lev%tauQ(m)%axpy(-1.0_pfdp, c_lev%tauQ(m-1), flags)</span>
<span class="c">!!$          end do</span>
<span class="c">!!$       end if</span>
       
    <span class="k">end if</span>

<span class="k">    call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TRESTRICT</span> <span class="o">+</span> <span class="n">level_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">PF_POST_RESTRICT_ALL</span><span class="p">)</span>

    <span class="k">deallocate</span><span class="p">(</span><span class="n">c_times</span><span class="p">)</span>
    <span class="k">deallocate</span><span class="p">(</span><span class="n">f_times</span><span class="p">)</span>

  <span class="k">end subroutine </span><span class="n">restrict_time_space_fas</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>