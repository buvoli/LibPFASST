<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tommaso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_level_setup &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_level_setup
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">51 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_pfasst.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_pfasst.f90.html'>pf_pfasst.f90</a></li>
    
     <li><a href='../module/pf_mod_pfasst.html'>pf_mod_pfasst</a></li>
    
  
     <li class="active">pf_level_setup</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_level_setup.html#src">pf_level_setup</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_level_setup(pf, level_index)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/pf_mod_quadrature.html'>pf_mod_quadrature</a></li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_level_setup~~UsesGraph Pages: 1 -->
<svg id="procpf_level_setupUsesGraph" width="641pt" height="69pt"
 viewBox="0.00 0.00 641.00 68.94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_level_setup~~UsesGraph" class="graph" transform="scale(0.931686 0.931686) rotate(0) translate(4 70)">
<title>proc~~pf_level_setup~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-70 684,-70 684,4 -4,4"/>
<!-- proc~pf_level_setup -->
<g id="proc~~pf_level_setup~~UsesGraph_node1" class="node"><title>proc~pf_level_setup</title>
<polygon fill="none" stroke="black" points="680,-44 598,-44 598,-20 680,-20 680,-44"/>
<text text-anchor="middle" x="639" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_level_setup</text>
</g>
<!-- module~pf_mod_quadrature -->
<g id="proc~~pf_level_setup~~UsesGraph_node2" class="node"><title>module~pf_mod_quadrature</title>
<g id="a_proc~~pf_level_setup~~UsesGraph_node2"><a xlink:href=".././module/pf_mod_quadrature.html" xlink:title="pf_mod_quadrature">
<polygon fill="#337ab7" stroke="#337ab7" points="562,-44 455,-44 455,-20 562,-20 562,-44"/>
<text text-anchor="middle" x="508.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_mod_quadrature</text>
</a>
</g>
</g>
<!-- proc~pf_level_setup&#45;&gt;module~pf_mod_quadrature -->
<g id="proc~~pf_level_setup~~UsesGraph_edge1" class="edge"><title>proc~pf_level_setup&#45;&gt;module~pf_mod_quadrature</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M597.694,-32C589.653,-32 581.028,-32 572.434,-32"/>
<polygon fill="#000000" stroke="#000000" points="572.398,-28.5001 562.398,-32 572.398,-35.5001 572.398,-28.5001"/>
</g>
<!-- module~pf_mod_utils -->
<g id="proc~~pf_level_setup~~UsesGraph_node3" class="node"><title>module~pf_mod_utils</title>
<g id="a_proc~~pf_level_setup~~UsesGraph_node3"><a xlink:href=".././module/pf_mod_utils.html" xlink:title="pf_mod_utils">
<polygon fill="#337ab7" stroke="#337ab7" points="419,-64 346,-64 346,-40 419,-40 419,-64"/>
<text text-anchor="middle" x="382.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_mod_utils</text>
</a>
</g>
</g>
<!-- module~pf_mod_quadrature&#45;&gt;module~pf_mod_utils -->
<g id="proc~~pf_level_setup~~UsesGraph_edge2" class="edge"><title>module~pf_mod_quadrature&#45;&gt;module~pf_mod_utils</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M454.913,-40.4818C446.372,-41.8594 437.587,-43.2763 429.227,-44.6247"/>
<polygon fill="#000000" stroke="#000000" points="428.6,-41.1804 419.285,-46.2282 429.715,-48.0911 428.6,-41.1804"/>
</g>
<!-- module~pf_mod_dtype -->
<g id="proc~~pf_level_setup~~UsesGraph_node4" class="node"><title>module~pf_mod_dtype</title>
<g id="a_proc~~pf_level_setup~~UsesGraph_node4"><a xlink:href=".././module/pf_mod_dtype.html" xlink:title="pf_mod_dtype">
<polygon fill="#337ab7" stroke="#337ab7" points="195,-24 114,-24 114,-0 195,-0 195,-24"/>
<text text-anchor="middle" x="154.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_mod_dtype</text>
</a>
</g>
</g>
<!-- module~pf_mod_quadrature&#45;&gt;module~pf_mod_dtype -->
<g id="proc~~pf_level_setup~~UsesGraph_edge3" class="edge"><title>module~pf_mod_quadrature&#45;&gt;module~pf_mod_dtype</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M454.999,-27.6661C407.167,-23.6902 334.576,-17.5876 271.5,-12"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M269.5,-12C248.555,-9.73588 225.318,-9.35461 205.317,-9.68185"/>
<polygon fill="#000000" stroke="#000000" points="205.1,-6.18577 195.181,-9.91134 205.258,-13.184 205.1,-6.18577"/>
</g>
<!-- module~pf_mod_utils&#45;&gt;module~pf_mod_dtype -->
<g id="proc~~pf_level_setup~~UsesGraph_edge4" class="edge"><title>module~pf_mod_utils&#45;&gt;module~pf_mod_dtype</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M359.129,-39.9436C337.452,-29.2219 303.279,-14.8151 271.5,-12"/>
</g>
<!-- module~pf_mod_timer -->
<g id="proc~~pf_level_setup~~UsesGraph_node5" class="node"><title>module~pf_mod_timer</title>
<g id="a_proc~~pf_level_setup~~UsesGraph_node5"><a xlink:href=".././module/pf_mod_timer.html" xlink:title="pf_mod_timer">
<polygon fill="#337ab7" stroke="#337ab7" points="310,-64 231,-64 231,-40 310,-40 310,-64"/>
<text text-anchor="middle" x="270.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_mod_timer</text>
</a>
</g>
</g>
<!-- module~pf_mod_utils&#45;&gt;module~pf_mod_timer -->
<g id="proc~~pf_level_setup~~UsesGraph_edge5" class="edge"><title>module~pf_mod_utils&#45;&gt;module~pf_mod_timer</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M345.786,-52C337.58,-52 328.718,-52 320.071,-52"/>
<polygon fill="#000000" stroke="#000000" points="320.07,-48.5001 310.07,-52 320.07,-55.5001 320.07,-48.5001"/>
</g>
<!-- iso_c_binding -->
<g id="proc~~pf_level_setup~~UsesGraph_node6" class="node"><title>iso_c_binding</title>
<g id="a_proc~~pf_level_setup~~UsesGraph_node6"><a xlink:href="http://fortranwiki.org/fortran/show/ISO_C_BINDING" xlink:title="iso_c_binding">
<polygon fill="#337ab7" stroke="#337ab7" points="78,-24 0,-24 0,-0 78,-0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_c_binding</text>
</a>
</g>
</g>
<!-- module~pf_mod_dtype&#45;&gt;iso_c_binding -->
<g id="proc~~pf_level_setup~~UsesGraph_edge6" class="edge"><title>module~pf_mod_dtype&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M113.803,-12C105.623,-12 96.921,-12 88.4696,-12"/>
<polygon fill="#000000" stroke="#000000" points="88.3369,-8.5001 78.3369,-12 88.3369,-15.5001 88.3369,-8.5001"/>
</g>
<!-- module~pf_mod_timer&#45;&gt;module~pf_mod_dtype -->
<g id="proc~~pf_level_setup~~UsesGraph_edge8" class="edge"><title>module~pf_mod_timer&#45;&gt;module~pf_mod_dtype</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M235.296,-39.9987C224.126,-36.0794 211.558,-31.6695 199.758,-27.529"/>
<polygon fill="#000000" stroke="#000000" points="200.668,-24.1394 190.074,-24.1311 198.351,-30.7446 200.668,-24.1394"/>
</g>
<!-- module~pf_mod_mpi -->
<g id="proc~~pf_level_setup~~UsesGraph_node7" class="node"><title>module~pf_mod_mpi</title>
<g id="a_proc~~pf_level_setup~~UsesGraph_node7"><a xlink:href=".././module/pf_mod_mpi.html" xlink:title="pf_mod_mpi">
<polygon fill="#337ab7" stroke="#337ab7" points="190.5,-66 118.5,-66 118.5,-42 190.5,-42 190.5,-66"/>
<text text-anchor="middle" x="154.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_mod_mpi</text>
</a>
</g>
</g>
<!-- module~pf_mod_timer&#45;&gt;module~pf_mod_mpi -->
<g id="proc~~pf_level_setup~~UsesGraph_edge7" class="edge"><title>module~pf_mod_timer&#45;&gt;module~pf_mod_mpi</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M230.905,-52.6771C221.221,-52.847 210.743,-53.0308 200.766,-53.2059"/>
<polygon fill="#000000" stroke="#000000" points="200.542,-49.7092 190.605,-53.3841 200.665,-56.7081 200.542,-49.7092"/>
</g>
</g>
</svg>
</div><script>var panprocpf_level_setupUsesGraph = svgPanZoom('#procpf_level_setupUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,-0 139.5,-0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,-0 222,-0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,-0 366,-0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="481.5,-24 384.5,-24 384.5,-0 481.5,-0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    
    <p>Setup (allocate) PFASST level
 If the level is already setup, calling this again will allocate
 (or deallocate) tauQ appropriately.
  Assign level pointer</p>
<p>do some sanity checks
 (re)allocate tauQ 
 skip the rest if we're already allocated
 allocate flat buffers for send, and recv
 allocate nodes, flags, and integration matrices
  Allocate and compute all the matrices
  initialize sweeper
 allocate solution and function arrays</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E41"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td><p>Main pfasst structure</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-level_index%7E32"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>level_index</strong></td><td><p>level to set up</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_level_setup~~CallsGraph Pages: 1 -->
<svg id="procpf_level_setupCallsGraph" width="641pt" height="273pt"
 viewBox="0.00 0.00 641.00 272.65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_level_setup~~CallsGraph" class="graph" transform="scale(0.902817 0.902817) rotate(0) translate(4 298)">
<title>proc~~pf_level_setup~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-298 706,-298 706,4 -4,4"/>
<!-- proc~pf_level_setup -->
<g id="proc~~pf_level_setup~~CallsGraph_node1" class="node"><title>proc~pf_level_setup</title>
<polygon fill="none" stroke="black" points="82,-253 0,-253 0,-229 82,-229 82,-253"/>
<text text-anchor="middle" x="41" y="-238.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_level_setup</text>
</g>
<!-- proc~pf_init_sdcmats -->
<g id="proc~~pf_level_setup~~CallsGraph_node2" class="node"><title>proc~pf_init_sdcmats</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node2"><a xlink:href=".././proc/pf_init_sdcmats.html" xlink:title="pf_init_sdcmats">
<polygon fill="#d9534f" stroke="#d9534f" points="205,-253 118,-253 118,-229 205,-229 205,-253"/>
<text text-anchor="middle" x="161.5" y="-238.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_init_sdcmats</text>
</a>
</g>
</g>
<!-- proc~pf_level_setup&#45;&gt;proc~pf_init_sdcmats -->
<g id="proc~~pf_level_setup~~CallsGraph_edge1" class="edge"><title>proc~pf_level_setup&#45;&gt;proc~pf_init_sdcmats</title>
<path fill="none" stroke="#000000" d="M82.1187,-241C90.4194,-241 99.2813,-241 107.949,-241"/>
<polygon fill="#000000" stroke="#000000" points="107.991,-244.5 117.991,-241 107.991,-237.5 107.991,-244.5"/>
</g>
<!-- proc~pf_make_matrices -->
<g id="proc~~pf_level_setup~~CallsGraph_node3" class="node"><title>proc~pf_make_matrices</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node3"><a xlink:href=".././proc/pf_make_matrices.html" xlink:title="pf_make_matrices">
<polygon fill="#d9534f" stroke="#d9534f" points="341,-284 241,-284 241,-260 341,-260 341,-284"/>
<text text-anchor="middle" x="291" y="-269.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_make_matrices</text>
</a>
</g>
</g>
<!-- proc~pf_init_sdcmats&#45;&gt;proc~pf_make_matrices -->
<g id="proc~~pf_level_setup~~CallsGraph_edge2" class="edge"><title>proc~pf_init_sdcmats&#45;&gt;proc~pf_make_matrices</title>
<path fill="none" stroke="#000000" d="M205.31,-251.409C213.615,-253.428 222.453,-255.577 231.168,-257.696"/>
<polygon fill="#000000" stroke="#000000" points="230.376,-261.105 240.92,-260.067 232.03,-254.303 230.376,-261.105"/>
</g>
<!-- proc~pf_quadrature -->
<g id="proc~~pf_level_setup~~CallsGraph_node4" class="node"><title>proc~pf_quadrature</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node4"><a xlink:href=".././proc/pf_quadrature.html" xlink:title="pf_quadrature">
<polygon fill="#d9534f" stroke="#d9534f" points="331,-223 251,-223 251,-199 331,-199 331,-223"/>
<text text-anchor="middle" x="291" y="-208.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_quadrature</text>
</a>
</g>
</g>
<!-- proc~pf_init_sdcmats&#45;&gt;proc~pf_quadrature -->
<g id="proc~~pf_level_setup~~CallsGraph_edge3" class="edge"><title>proc~pf_init_sdcmats&#45;&gt;proc~pf_quadrature</title>
<path fill="none" stroke="#000000" d="M205.31,-230.927C216.725,-228.241 229.147,-225.318 240.872,-222.56"/>
<polygon fill="#000000" stroke="#000000" points="242.02,-225.885 250.953,-220.188 240.417,-219.071 242.02,-225.885"/>
</g>
<!-- proc~myluq -->
<g id="proc~~pf_level_setup~~CallsGraph_node7" class="node"><title>proc~myluq</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node7"><a xlink:href=".././proc/myluq.html" xlink:title="myLUq">
<polygon fill="#d9534f" stroke="#d9534f" points="439,-294 385,-294 385,-270 439,-270 439,-294"/>
<text text-anchor="middle" x="412" y="-279.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">myLUq</text>
</a>
</g>
</g>
<!-- proc~pf_make_matrices&#45;&gt;proc~myluq -->
<g id="proc~~pf_level_setup~~CallsGraph_edge4" class="edge"><title>proc~pf_make_matrices&#45;&gt;proc~myluq</title>
<path fill="none" stroke="#000000" d="M341.089,-276.125C352.325,-277.069 364.072,-278.056 374.66,-278.946"/>
<polygon fill="#000000" stroke="#000000" points="374.542,-282.449 384.8,-279.798 375.128,-275.473 374.542,-282.449"/>
</g>
<!-- proc~sdc_qnodes -->
<g id="proc~~pf_level_setup~~CallsGraph_node5" class="node"><title>proc~sdc_qnodes</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node5"><a xlink:href=".././proc/sdc_qnodes.html" xlink:title="sdc_qnodes">
<polygon fill="#d9534f" stroke="#d9534f" points="447,-214 377,-214 377,-190 447,-190 447,-214"/>
<text text-anchor="middle" x="412" y="-199.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sdc_qnodes</text>
</a>
</g>
</g>
<!-- proc~pf_quadrature&#45;&gt;proc~sdc_qnodes -->
<g id="proc~~pf_level_setup~~CallsGraph_edge5" class="edge"><title>proc~pf_quadrature&#45;&gt;proc~sdc_qnodes</title>
<path fill="none" stroke="#000000" d="M331.295,-208.028C342.71,-207.165 355.25,-206.216 366.937,-205.332"/>
<polygon fill="#000000" stroke="#000000" points="367.23,-208.82 376.938,-204.576 366.702,-201.84 367.23,-208.82"/>
</g>
<!-- proc~pf_stop -->
<g id="proc~~pf_level_setup~~CallsGraph_node6" class="node"><title>proc~pf_stop</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node6"><a xlink:href=".././proc/pf_stop.html" xlink:title="pf_stop">
<polygon fill="#d9534f" stroke="#d9534f" points="550,-294 496,-294 496,-270 550,-270 550,-294"/>
<text text-anchor="middle" x="523" y="-279.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_stop</text>
</a>
</g>
</g>
<!-- proc~pf_quadrature&#45;&gt;proc~pf_stop -->
<g id="proc~~pf_level_setup~~CallsGraph_edge6" class="edge"><title>proc~pf_quadrature&#45;&gt;proc~pf_stop</title>
<path fill="none" stroke="#000000" d="M331.016,-223.044C374.443,-236.45 444.035,-257.933 486.141,-270.931"/>
<polygon fill="#000000" stroke="#000000" points="485.123,-274.279 495.711,-273.885 487.188,-267.591 485.123,-274.279"/>
</g>
<!-- proc~sdc_qmats -->
<g id="proc~~pf_level_setup~~CallsGraph_node8" class="node"><title>proc~sdc_qmats</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node8"><a xlink:href=".././proc/sdc_qmats.html" xlink:title="sdc_qmats">
<polygon fill="#d9534f" stroke="#d9534f" points="444,-105 380,-105 380,-81 444,-81 444,-105"/>
<text text-anchor="middle" x="412" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sdc_qmats</text>
</a>
</g>
</g>
<!-- proc~pf_quadrature&#45;&gt;proc~sdc_qmats -->
<g id="proc~~pf_level_setup~~CallsGraph_edge7" class="edge"><title>proc~pf_quadrature&#45;&gt;proc~sdc_qmats</title>
<path fill="none" stroke="#000000" d="M304.287,-198.816C324.863,-178.413 366.464,-137.162 391.208,-112.626"/>
<polygon fill="#000000" stroke="#000000" points="393.965,-114.821 398.602,-105.294 389.036,-109.85 393.965,-114.821"/>
</g>
<!-- proc~sdc_qnodes&#45;&gt;proc~pf_stop -->
<g id="proc~~pf_level_setup~~CallsGraph_edge9" class="edge"><title>proc~sdc_qnodes&#45;&gt;proc~pf_stop</title>
<path fill="none" stroke="#000000" d="M429.488,-214.142C435.127,-218.417 441.418,-223.323 447,-228 463.637,-241.94 465.309,-248.425 483,-261 484.645,-262.17 486.363,-263.32 488.122,-264.443"/>
<polygon fill="#000000" stroke="#000000" points="486.719,-267.681 497.102,-269.791 490.301,-261.667 486.719,-267.681"/>
</g>
<!-- proc~poly_legendre -->
<g id="proc~~pf_level_setup~~CallsGraph_node9" class="node"><title>proc~poly_legendre</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node9"><a xlink:href=".././proc/poly_legendre.html" xlink:title="poly_legendre">
<polygon fill="#d9534f" stroke="#d9534f" points="563,-252 483,-252 483,-228 563,-228 563,-252"/>
<text text-anchor="middle" x="523" y="-237.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">poly_legendre</text>
</a>
</g>
</g>
<!-- proc~sdc_qnodes&#45;&gt;proc~poly_legendre -->
<g id="proc~~pf_level_setup~~CallsGraph_edge8" class="edge"><title>proc~sdc_qnodes&#45;&gt;proc~poly_legendre</title>
<path fill="none" stroke="#000000" d="M447.189,-213.919C456.936,-217.317 467.694,-221.067 477.94,-224.64"/>
<polygon fill="#000000" stroke="#000000" points="476.962,-228.005 487.557,-227.992 479.267,-221.396 476.962,-228.005"/>
</g>
<!-- proc~poly_diff -->
<g id="proc~~pf_level_setup~~CallsGraph_node10" class="node"><title>proc~poly_diff</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node10"><a xlink:href=".././proc/poly_diff.html" xlink:title="poly_diff">
<polygon fill="#d9534f" stroke="#d9534f" points="550,-210 496,-210 496,-186 550,-186 550,-210"/>
<text text-anchor="middle" x="523" y="-195.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">poly_diff</text>
</a>
</g>
</g>
<!-- proc~sdc_qnodes&#45;&gt;proc~poly_diff -->
<g id="proc~~pf_level_setup~~CallsGraph_edge10" class="edge"><title>proc~sdc_qnodes&#45;&gt;proc~poly_diff</title>
<path fill="none" stroke="#000000" d="M447.189,-200.745C459.481,-200.294 473.381,-199.784 485.835,-199.327"/>
<polygon fill="#000000" stroke="#000000" points="486.025,-202.823 495.89,-198.958 485.768,-195.827 486.025,-202.823"/>
</g>
<!-- proc~poly_roots -->
<g id="proc~~pf_level_setup~~CallsGraph_node13" class="node"><title>proc~poly_roots</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node13"><a xlink:href=".././proc/poly_roots.html" xlink:title="poly_roots">
<polygon fill="#d9534f" stroke="#d9534f" points="554,-168 492,-168 492,-144 554,-144 554,-168"/>
<text text-anchor="middle" x="523" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">poly_roots</text>
</a>
</g>
</g>
<!-- proc~sdc_qnodes&#45;&gt;proc~poly_roots -->
<g id="proc~~pf_level_setup~~CallsGraph_edge11" class="edge"><title>proc~sdc_qnodes&#45;&gt;proc~poly_roots</title>
<path fill="none" stroke="#000000" d="M441.638,-189.914C454.656,-184.421 470.235,-177.846 484.197,-171.954"/>
<polygon fill="#000000" stroke="#000000" points="485.7,-175.118 493.553,-168.005 482.979,-168.669 485.7,-175.118"/>
</g>
<!-- proc~myluq&#45;&gt;proc~pf_stop -->
<g id="proc~~pf_level_setup~~CallsGraph_edge12" class="edge"><title>proc~myluq&#45;&gt;proc~pf_stop</title>
<path fill="none" stroke="#000000" d="M439.108,-282C453.027,-282 470.374,-282 485.596,-282"/>
<polygon fill="#000000" stroke="#000000" points="485.727,-285.5 495.727,-282 485.727,-278.5 485.727,-285.5"/>
</g>
<!-- proc~poly_int -->
<g id="proc~~pf_level_setup~~CallsGraph_node11" class="node"><title>proc~poly_int</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node11"><a xlink:href=".././proc/poly_int.html" xlink:title="poly_int">
<polygon fill="#d9534f" stroke="#d9534f" points="550,-126 496,-126 496,-102 550,-102 550,-126"/>
<text text-anchor="middle" x="523" y="-111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">poly_int</text>
</a>
</g>
</g>
<!-- proc~sdc_qmats&#45;&gt;proc~poly_int -->
<g id="proc~~pf_level_setup~~CallsGraph_edge15" class="edge"><title>proc~sdc_qmats&#45;&gt;proc~poly_int</title>
<path fill="none" stroke="#000000" d="M444.235,-99.0178C457.269,-101.529 472.488,-104.461 485.99,-107.062"/>
<polygon fill="#000000" stroke="#000000" points="485.434,-110.519 495.916,-108.975 486.758,-103.646 485.434,-110.519"/>
</g>
<!-- proc~not_proper -->
<g id="proc~~pf_level_setup~~CallsGraph_node12" class="node"><title>proc~not_proper</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node12"><a xlink:href=".././proc/not_proper.html" xlink:title="not_proper">
<polygon fill="#d94e8f" stroke="#d94e8f" points="555.5,-84 490.5,-84 490.5,-60 555.5,-60 555.5,-84"/>
<text text-anchor="middle" x="523" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">not_proper</text>
</a>
</g>
</g>
<!-- proc~sdc_qmats&#45;&gt;proc~not_proper -->
<g id="proc~~pf_level_setup~~CallsGraph_edge13" class="edge"><title>proc~sdc_qmats&#45;&gt;proc~not_proper</title>
<path fill="none" stroke="#000000" d="M444.235,-86.9822C455.539,-84.8044 468.487,-82.3099 480.532,-79.9892"/>
<polygon fill="#000000" stroke="#000000" points="481.225,-83.4202 490.382,-78.0915 479.901,-76.5466 481.225,-83.4202"/>
</g>
<!-- interface~poly_eval -->
<g id="proc~~pf_level_setup~~CallsGraph_node14" class="node"><title>interface~poly_eval</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node14"><a xlink:href=".././interface/poly_eval.html" xlink:title="poly_eval">
<polygon fill="#a7506f" stroke="#a7506f" points="552,-24 494,-24 494,-0 552,-0 552,-24"/>
<text text-anchor="middle" x="523" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">poly_eval</text>
</a>
</g>
</g>
<!-- proc~sdc_qmats&#45;&gt;interface~poly_eval -->
<g id="proc~~pf_level_setup~~CallsGraph_edge14" class="edge"><title>proc~sdc_qmats&#45;&gt;interface~poly_eval</title>
<path fill="none" stroke="#000000" d="M429.555,-80.6978C447.666,-67.2393 476.875,-45.5332 497.61,-30.1247"/>
<polygon fill="#000000" stroke="#000000" points="499.708,-32.9264 505.647,-24.1525 495.533,-27.3079 499.708,-32.9264"/>
</g>
<!-- proc~qsort -->
<g id="proc~~pf_level_setup~~CallsGraph_node15" class="node"><title>proc~qsort</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node15"><a xlink:href=".././proc/qsort.html" xlink:title="qsort">
<polygon fill="#d9534f" stroke="#d9534f" points="677.5,-168 623.5,-168 623.5,-144 677.5,-144 677.5,-168"/>
<text text-anchor="middle" x="650.5" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qsort</text>
</a>
</g>
</g>
<!-- proc~poly_roots&#45;&gt;proc~qsort -->
<g id="proc~~pf_level_setup~~CallsGraph_edge16" class="edge"><title>proc~poly_roots&#45;&gt;proc~qsort</title>
<path fill="none" stroke="#000000" d="M554.06,-156C571.722,-156 594.177,-156 612.868,-156"/>
<polygon fill="#000000" stroke="#000000" points="613.092,-159.5 623.092,-156 613.092,-152.5 613.092,-159.5"/>
</g>
<!-- proc~poly_eval_complex -->
<g id="proc~~pf_level_setup~~CallsGraph_node16" class="node"><title>proc~poly_eval_complex</title>
<g id="a_proc~~pf_level_setup~~CallsGraph_node16"><a xlink:href=".././proc/poly_eval_complex.html" xlink:title="poly_eval_complex">
<polygon fill="#d94e8f" stroke="#d94e8f" points="702,-75 599,-75 599,-51 702,-51 702,-75"/>
<text text-anchor="middle" x="650.5" y="-60.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">poly_eval_complex</text>
</a>
</g>
</g>
<!-- proc~poly_roots&#45;&gt;proc~poly_eval_complex -->
<g id="proc~~pf_level_setup~~CallsGraph_edge17" class="edge"><title>proc~poly_roots&#45;&gt;proc~poly_eval_complex</title>
<path fill="none" stroke="#000000" d="M548.37,-143.852C553.319,-141.116 558.412,-138.099 563,-135 586.933,-118.835 612.066,-97.3332 629.035,-82.047"/>
<polygon fill="#000000" stroke="#000000" points="631.633,-84.4148 636.668,-75.0928 626.918,-79.2403 631.633,-84.4148"/>
</g>
<!-- interface~poly_eval&#45;&gt;interface~poly_eval -->
<g id="proc~~pf_level_setup~~CallsGraph_edge18" class="edge"><title>interface~poly_eval&#45;&gt;interface~poly_eval</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M504.812,-24.0139C498.461,-32.9717 504.523,-42 523,-42 534.259,-42 540.909,-38.6474 542.948,-34.0013"/>
<polygon fill="#000000" stroke="#000000" points="546.371,-33.2545 541.188,-24.0139 539.477,-34.4696 546.371,-33.2545"/>
</g>
<!-- interface~poly_eval&#45;&gt;proc~poly_eval_complex -->
<g id="proc~~pf_level_setup~~CallsGraph_edge19" class="edge"><title>interface~poly_eval&#45;&gt;proc~poly_eval_complex</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M552.165,-23.4454C569.273,-30.3978 591.37,-39.3774 610.184,-47.0231"/>
<polygon fill="#000000" stroke="#000000" points="609.098,-50.3596 619.68,-50.8819 611.733,-43.8746 609.098,-50.3596"/>
</g>
</g>
</svg>
</div><script>var panprocpf_level_setupCallsGraph = svgPanZoom('#procpf_level_setupCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_level_setup~~CalledByGraph Pages: 1 -->
<svg id="procpf_level_setupCalledByGraph" width="214pt" height="32pt"
 viewBox="0.00 0.00 214.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_level_setup~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_level_setup~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 210,-28 210,4 -4,4"/>
<!-- proc~pf_level_setup -->
<g id="proc~~pf_level_setup~~CalledByGraph_node1" class="node"><title>proc~pf_level_setup</title>
<polygon fill="none" stroke="black" points="206,-24 124,-24 124,-0 206,-0 206,-24"/>
<text text-anchor="middle" x="165" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_level_setup</text>
</g>
<!-- proc~pf_pfasst_setup -->
<g id="proc~~pf_level_setup~~CalledByGraph_node2" class="node"><title>proc~pf_pfasst_setup</title>
<g id="a_proc~~pf_level_setup~~CalledByGraph_node2"><a xlink:href=".././proc/pf_pfasst_setup.html" xlink:title="pf_pfasst_setup">
<polygon fill="#d9534f" stroke="#d9534f" points="88,-24 7.10543e-15,-24 7.10543e-15,-0 88,-0 88,-24"/>
<text text-anchor="middle" x="44" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_pfasst_setup</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_setup&#45;&gt;proc~pf_level_setup -->
<g id="proc~~pf_level_setup~~CalledByGraph_edge1" class="edge"><title>proc~pf_pfasst_setup&#45;&gt;proc~pf_level_setup</title>
<path fill="none" stroke="#000000" d="M88.2984,-12C96.5191,-12 105.186,-12 113.605,-12"/>
<polygon fill="#000000" stroke="#000000" points="113.703,-15.5001 123.703,-12 113.703,-8.5001 113.703,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_level_setup.html#src">pf_level_setup</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_level_setup</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">)</span>
    <span class="k">use </span><span class="n">pf_mod_quadrature</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">target</span> <span class="kd">::</span> <span class="n">pf</span>   <span class="c">!!  Main pfasst structure</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">level_index</span>  <span class="c">!!  level to set up</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span>  <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev</span>  <span class="c">!!  Level to set up</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">mpibuflen</span><span class="p">,</span> <span class="n">nnodes</span><span class="p">,</span> <span class="n">npieces</span><span class="p">,</span> <span class="n">nnodes0</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">ierr</span>

    <span class="n">lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">)</span>   <span class="c">!!  Assign level pointer</span>
    
    <span class="c">!&gt; do some sanity checks</span>
    <span class="n">mpibuflen</span>  <span class="o">=</span> <span class="n">lev</span><span class="p">%</span><span class="n">mpibuflen</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">mpibuflen</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail&#39;</span><span class="p">,</span><span class="n">mpibuflen</span><span class="p">)</span>

    <span class="n">nnodes</span> <span class="o">=</span> <span class="n">lev</span><span class="p">%</span><span class="n">nnodes</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nnodes</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;allocate fail&#39;</span><span class="p">,</span><span class="n">nnodes</span><span class="p">)</span>    

    <span class="n">lev</span><span class="p">%</span><span class="n">residual</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0_pfdp</span>


    <span class="c">!&gt; (re)allocate tauQ </span>
    <span class="k">if</span> <span class="p">((</span><span class="n">lev</span><span class="p">%</span><span class="nb">index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">)))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_array</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">tauQ</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>  <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">!&gt; skip the rest if we&#39;re already allocated</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="nb">allocated</span><span class="p">)</span> <span class="k">return</span>
<span class="k">    </span><span class="n">lev</span><span class="p">%</span><span class="nb">allocated</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>

    <span class="c">!&gt; allocate flat buffers for send, and recv</span>
    <span class="k">allocate</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">(</span><span class="n">mpibuflen</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s2">&quot;allocate fail&quot;</span><span class="p">)</span>
    <span class="k">allocate</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">recv</span><span class="p">(</span><span class="n">mpibuflen</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s2">&quot;allocate fail&quot;</span><span class="p">)</span>

    <span class="c">!&gt; allocate nodes, flags, and integration matrices</span>
    <span class="k">allocate</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">nodes</span><span class="p">(</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s2">&quot;allocate fail&quot;</span><span class="p">)</span>
    <span class="k">allocate</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">nflags</span><span class="p">(</span><span class="n">nnodes</span><span class="p">),</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s2">&quot;allocate fail&quot;</span><span class="p">)</span>
    <span class="n">lev</span><span class="p">%</span><span class="n">nflags</span><span class="o">=</span><span class="mi">0</span>

    <span class="c">!&gt;  Allocate and compute all the matrices</span>
    <span class="k">allocate</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">sdcmats</span><span class="p">,</span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s2">&quot;allocate error sdcmats&quot;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">pf_init_sdcmats</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">lev</span><span class="p">%</span><span class="n">sdcmats</span><span class="p">,</span> <span class="n">nnodes</span><span class="p">,</span><span class="n">lev</span><span class="p">%</span><span class="n">nflags</span><span class="p">)</span>

    <span class="n">lev</span><span class="p">%</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">lev</span><span class="p">%</span><span class="n">sdcmats</span><span class="p">%</span><span class="n">qnodes</span>

    <span class="c">!&gt;  initialize sweeper</span>
    <span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">use_LUq</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">use_LUq</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="p">)</span>

    
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">use_rk_stepper</span><span class="p">)</span>  <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">stepper</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">lev</span><span class="p">)</span>

    <span class="c">!&gt; allocate solution and function arrays</span>
    <span class="n">npieces</span> <span class="o">=</span> <span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">npieces</span>

    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_array</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">Q</span><span class="p">,</span> <span class="n">nnodes</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>  <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_array</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">Fflt</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">*</span><span class="n">npieces</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>  <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">*</span><span class="n">npieces</span>
       <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">Fflt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">setval</span><span class="p">(</span><span class="mf">0.0_pfdp</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    </span><span class="n">lev</span><span class="p">%</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nnodes</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">npieces</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">lev</span><span class="p">%</span><span class="n">Fflt</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_array</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">I</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>  <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_array</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">R</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>  <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>

    <span class="c">!  Need space for old function values in imexR sweepers</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_array</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">pFflt</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">*</span><span class="n">npieces</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    <span class="n">lev</span><span class="p">%</span><span class="n">pF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nnodes</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">npieces</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">lev</span><span class="p">%</span><span class="n">pFflt</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="nb">index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_array</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">pQ</span><span class="p">,</span> <span class="n">nnodes</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>  <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_single</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>   <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">factory</span><span class="p">%</span><span class="n">create_single</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span>   <span class="n">lev</span><span class="p">%</span><span class="nb">shape</span><span class="p">)</span>
    
  <span class="k">end subroutine </span><span class="n">pf_level_setup</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tommaso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>