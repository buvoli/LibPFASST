<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_predictor &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_predictor
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">89 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_predictor</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_predictor.html#src">pf_predictor</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_predictor(pf, t0, dt, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST Predictor.
  Subroutine  to initialize the solution on each processor
  The goal is to have a solution at each level and each node set to a consistent value
  When this is called, the value of q0 at the fine level on each processor has been set somehow (see q0_style below)</p>
<p>This can be broken down into four substeps
 1. Get the  initial condition on the finest level at each node
 2. Coarsen the initial condition to each coarser level with tau corrections
 3. Do the "Burn in" step on the coarse level to make the coarse values consistent
    (this is skipped if the fine initial conditions are already consistent)
 4. Do some coarse grid sweeps to improve initial solutions on coarsest nodes
 5. Interpolating coarse correction back to finer levels sweeping along the way.</p>
<p>There are several parameters or flags that determine how things are done:
  integer  q0_style:    can take 3 values
           0:  Only the q0 at t=0 is valid  (default)
           1:  The q0 at each processor is valid
           2:  q0 and all nodes at each processor is valid
 logical  PFASST_pred:  If true, the burn-in step uses the "PFASST predictor" trick
 integer  nsweeps_burn: Determines how many sweeps are done on the coarse level during burn in
 integer  nsweeps_pred: Determines how many sweeps are done at the coarse level after burn in
 logical Pipeline_burn: True if coarse sweeps during burn in are pipelined  (meaningless if nsweeps_burn&gt;1 on coarse level)
 logical Pipeline_pred: True if coarse sweeps after burn in are pipelined  (meaningless if nsweeps_pred&gt;1 on coarse level)
    Pipeline variables do nothing if there is only one processor
 logical  RK_pred:      If true, the coarse level is initialized with Runge-Kutta instead of the  PFASST burn in.
                        We  will still do coarse sweeps after and correct finer levels</p>
<p>The user defined flags(:) parameter is used to determine whether we are in a (standard) forward-in-time run (flags(1) == 1)
 or backward-in-time (for the adjoint) with a given terminal condition qend instead of initial condition q0  (flags(1) == 2).
 In the latter case, e.g., sweeper%spreadq0 has to do the correct thing (i.e., spread qend instead of q0).</p>
<p>No time communication is performed during the predictor since all
 procesors can do the work themselves</p>
<p>The iteration count is reset to 0, and the status is reset to
  ITERATING.</p>
<p>Step 1. Getting the  initial condition on the finest level at each processor
         If we are doing multiple levels, then we need to coarsen to fine level</p>
<p>Step 2:   Proceed fine to coarse levels coarsening the fine solution and computing tau correction</p>
<p>Step 3. Do the "Burn in" step on the coarse level to make the coarse values consistent
         (this is skipped if the fine initial conditions are already consistent)
 The first processor does nothing, the second does one set of sweeps, the third two, etc
 Hence, this is skipped completely if nprocs=1
 If RK_pred is true, just do some RK_steps</p>
<p>Step 4: Now we have everyone burned in, so do some coarse sweeps</p>
<p>Step 5:  Return to fine level sweeping on any level in between coarsest and finest</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E138"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td><p>PFASST main data structure</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E36"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td><p>Initial time of this processor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E57"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>time step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E135"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td><p>User defined flags</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_predictor~~CallsGraph Pages: 1 -->
<svg id="procpf_predictorCallsGraph" width="589pt" height="567pt"
 viewBox="0.00 0.00 589.00 566.67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_predictor~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 562.671)">
<title>proc~~pf_predictor~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-562.671 585,-562.671 585,4 -4,4"/>
<!-- proc~pf_predictor -->
<g id="proc~~pf_predictor~~CallsGraph_node1" class="node"><title>proc~pf_predictor</title>
<polygon fill="none" stroke="black" points="70,-347 0,-347 0,-323 70,-323 70,-347"/>
<text text-anchor="middle" x="35" y="-332.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_predictor</text>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node2" class="node"><title>proc~end_timer</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node2"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="473,-441 412,-441 412,-417 473,-417 473,-441"/>
<text text-anchor="middle" x="442.5" y="-426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge1" class="edge"><title>proc~pf_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M37.9635,-347.245C43.323,-376.687 60.9318,-452.034 106,-493 162.161,-544.049 193.085,-534.843 268,-547 311.871,-554.119 329.143,-568.575 368,-547 387.135,-536.375 416.05,-481.576 431.282,-450.529"/>
<polygon fill="#000000" stroke="#000000" points="434.509,-451.895 435.716,-441.369 428.208,-448.844 434.509,-451.895"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_predictor~~CallsGraph_node3" class="node"><title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node3"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-208 106,-208 106,-184 232,-184 232,-208"/>
<text text-anchor="middle" x="169" y="-193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_predictor~~CallsGraph_edge2" class="edge"><title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M43.1152,-322.952C54.7114,-303.936 79.1084,-266.416 106,-240 115.956,-230.22 128.264,-221.013 139.284,-213.574"/>
<polygon fill="#000000" stroke="#000000" points="141.329,-216.418 147.775,-208.01 137.492,-210.563 141.329,-216.418"/>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_predictor~~CallsGraph_node4" class="node"><title>proc~pf_residual</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node4"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="350.5,-538 285.5,-538 285.5,-514 350.5,-514 350.5,-538"/>
<text text-anchor="middle" x="318" y="-523.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_predictor~~CallsGraph_edge3" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M40.2837,-347.282C49.0177,-370.592 71.062,-421.465 106,-450 156.043,-490.873 229.872,-510.691 275.62,-519.576"/>
<polygon fill="#000000" stroke="#000000" points="275.024,-523.025 285.495,-521.409 276.302,-516.143 275.024,-523.025"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_predictor~~CallsGraph_node5" class="node"><title>proc~pf_send</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node5"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-87 142,-87 142,-63 196,-63 196,-87"/>
<text text-anchor="middle" x="169" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_predictor~~CallsGraph_edge4" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M40.6922,-322.68C51.206,-295.468 77.9398,-228.415 106,-175 120.844,-146.743 140.665,-115.726 153.858,-95.8446"/>
<polygon fill="#000000" stroke="#000000" points="156.929,-97.5494 159.581,-87.2919 151.111,-93.6564 156.929,-97.5494"/>
</g>
<!-- proc~interpolate_q0 -->
<g id="proc~~pf_predictor~~CallsGraph_node6" class="node"><title>proc~interpolate_q0</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node6"><a xlink:href=".././proc/interpolate_q0.html" xlink:title="interpolate_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="209.5,-441 128.5,-441 128.5,-417 209.5,-417 209.5,-441"/>
<text text-anchor="middle" x="169" y="-426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_q0</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_predictor~~CallsGraph_edge5" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M48.8293,-347.081C62.439,-359.586 84.8535,-379.311 106,-394 115.155,-400.359 125.553,-406.581 135.183,-411.974"/>
<polygon fill="#000000" stroke="#000000" points="133.663,-415.132 144.115,-416.867 137.027,-408.993 133.663,-415.132"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_node7" class="node"><title>proc~call_hooks</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node7"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="349.5,-420 286.5,-420 286.5,-396 349.5,-396 349.5,-420"/>
<text text-anchor="middle" x="318" y="-405.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge6" class="edge"><title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M70.0818,-345.596C81.4685,-349.037 94.2498,-352.792 106,-356 165.009,-372.112 233.907,-388.673 276.499,-398.652"/>
<polygon fill="#000000" stroke="#000000" points="275.944,-402.116 286.478,-400.982 277.536,-395.3 275.944,-402.116"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_predictor~~CallsGraph_node8" class="node"><title>proc~pf_recv</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node8"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-45 142,-45 142,-21 196,-21 196,-45"/>
<text text-anchor="middle" x="169" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_predictor~~CallsGraph_edge7" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M37.4574,-322.971C43.5425,-274.591 68.3691,-94.8684 106,-54 112.856,-46.5541 122.446,-41.7474 132.037,-38.6446"/>
<polygon fill="#000000" stroke="#000000" points="133.17,-41.9645 141.919,-35.9889 131.353,-35.2044 133.17,-41.9645"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node9" class="node"><title>proc~start_timer</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node9"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="474.5,-399 410.5,-399 410.5,-375 474.5,-375 474.5,-399"/>
<text text-anchor="middle" x="442.5" y="-384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge8" class="edge"><title>proc~pf_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M69.0208,-322.94C80.5561,-319.306 93.6977,-315.806 106,-314 221.545,-297.042 259.782,-290.1 368,-334 387.678,-341.983 407.039,-356.282 420.947,-368.018"/>
<polygon fill="#000000" stroke="#000000" points="419.018,-370.98 428.856,-374.915 423.619,-365.704 419.018,-370.98"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_predictor~~CallsGraph_node10" class="node"><title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node10"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="231,-347 107,-347 107,-323 231,-323 231,-347"/>
<text text-anchor="middle" x="169" y="-332.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_predictor~~CallsGraph_edge9" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M70.3369,-335C78.5833,-335 87.6939,-335 96.9378,-335"/>
<polygon fill="#000000" stroke="#000000" points="96.9861,-338.5 106.986,-335 96.9861,-331.5 96.9861,-338.5"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_node14" class="node"><title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="581,-420 517,-420 517,-396 581,-396 581,-420"/>
<text text-anchor="middle" x="549" y="-405.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_edge10" class="edge"><title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M473.166,-423.038C483.607,-420.94 495.538,-418.543 506.759,-416.288"/>
<polygon fill="#000000" stroke="#000000" points="507.687,-419.671 516.801,-414.27 506.308,-412.808 507.687,-419.671"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge15" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M189.461,-208.147C227.077,-232.268 311.063,-289.319 368,-352 387.894,-373.901 382.451,-387.724 404,-408 405.087,-409.023 406.233,-410.014 407.422,-410.972"/>
<polygon fill="#000000" stroke="#000000" points="405.533,-413.922 415.728,-416.804 409.555,-408.193 405.533,-413.922"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge11" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M178.325,-208.005C202.423,-242.76 272.454,-343.756 302.753,-387.453"/>
<polygon fill="#000000" stroke="#000000" points="300.01,-389.64 308.585,-395.863 305.763,-385.651 300.01,-389.64"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge14" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M216.925,-183.933C260.156,-175.711 324.071,-171.202 368,-202 422.061,-239.901 436.367,-324.259 440.147,-364.63"/>
<polygon fill="#000000" stroke="#000000" points="436.672,-365.086 440.958,-374.775 443.65,-364.528 436.672,-365.086"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~pf_predictor~~CallsGraph_node11" class="node"><title>proc~restrict_ts_integral</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node11"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-108 268,-108 268,-84 368,-84 368,-108"/>
<text text-anchor="middle" x="318" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~pf_predictor~~CallsGraph_edge12" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M182.769,-183.771C200.696,-167.074 234.856,-136.943 268,-117 270.612,-115.428 273.363,-113.913 276.174,-112.467"/>
<polygon fill="#000000" stroke="#000000" points="277.768,-115.584 285.26,-108.092 274.732,-109.277 277.768,-115.584"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~pf_predictor~~CallsGraph_node13" class="node"><title>proc~restrict_ts</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node13"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="347.5,-150 288.5,-150 288.5,-126 347.5,-126 347.5,-150"/>
<text text-anchor="middle" x="318" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~pf_predictor~~CallsGraph_edge13" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M200.458,-183.982C223.176,-175.019 254.364,-162.713 278.76,-153.088"/>
<polygon fill="#000000" stroke="#000000" points="280.063,-156.336 288.081,-149.41 277.494,-149.825 280.063,-156.336"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge18" class="edge"><title>proc~pf_residual&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M344.989,-513.937C352.667,-509.922 360.908,-505.149 368,-500 388.836,-484.873 409.669,-464.08 423.806,-448.906"/>
<polygon fill="#000000" stroke="#000000" points="426.758,-450.865 430.929,-441.126 421.595,-446.138 426.758,-450.865"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge17" class="edge"><title>proc~pf_residual&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M328.635,-513.909C338.695,-501.172 354.815,-480.441 368,-462 384.776,-438.536 382.829,-427.59 404,-408 405.13,-406.955 406.321,-405.942 407.556,-404.962"/>
<polygon fill="#000000" stroke="#000000" points="409.934,-407.573 416.166,-399.005 405.951,-401.817 409.934,-407.573"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_predictor~~CallsGraph_node17" class="node"><title>proc~pf_set_resid</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node17"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-538 407,-538 407,-514 478,-514 478,-538"/>
<text text-anchor="middle" x="442.5" y="-523.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_residual&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_predictor~~CallsGraph_edge16" class="edge"><title>proc~pf_residual&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M350.547,-526C364.486,-526 381.132,-526 396.352,-526"/>
<polygon fill="#000000" stroke="#000000" points="396.609,-529.5 406.609,-526 396.609,-522.5 396.609,-529.5"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node12" class="node"><title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="348.5,-66 287.5,-66 287.5,-42 348.5,-42 348.5,-66"/>
<text text-anchor="middle" x="318" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge20" class="edge"><title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M196.281,-71.2456C218.781,-68.0312 251.52,-63.3543 277.229,-59.6816"/>
<polygon fill="#000000" stroke="#000000" points="278.005,-63.1063 287.41,-58.2272 277.015,-56.1766 278.005,-63.1063"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node15" class="node"><title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="350,-24 286,-24 286,-0 350,-0 350,-24"/>
<text text-anchor="middle" x="318" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge19" class="edge"><title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M196.09,-67.4522C207.339,-63.8705 220.52,-59.228 232,-54 248.858,-46.3232 251.456,-41.3308 268,-33 271.154,-31.4117 274.457,-29.8304 277.793,-28.2892"/>
<polygon fill="#000000" stroke="#000000" points="279.496,-31.3617 287.191,-24.0797 276.634,-24.9733 279.496,-31.3617"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge23" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M197.686,-441.017C216.984,-448.718 243.551,-457.994 268,-462 311.86,-469.186 324.541,-471.308 368,-462 383.078,-458.77 398.8,-452.203 411.815,-445.771"/>
<polygon fill="#000000" stroke="#000000" points="413.479,-448.851 420.766,-441.161 410.273,-442.628 413.479,-448.851"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge21" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M209.78,-423.317C230.293,-420.387 255.279,-416.817 275.969,-413.862"/>
<polygon fill="#000000" stroke="#000000" points="276.641,-417.301 286.045,-412.422 275.651,-410.372 276.641,-417.301"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge22" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M209.87,-435.011C250.435,-439.743 314.74,-443.399 368,-429 385.881,-424.166 387.919,-417.192 404,-408 406.211,-406.736 408.498,-405.436 410.803,-404.132"/>
<polygon fill="#000000" stroke="#000000" points="412.655,-407.107 419.651,-399.15 409.22,-401.007 412.655,-407.107"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge25" class="edge"><title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M349.596,-413.245C365.324,-415.941 384.685,-419.26 401.575,-422.156"/>
<polygon fill="#000000" stroke="#000000" points="401.269,-425.654 411.717,-423.894 402.452,-418.755 401.269,-425.654"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge24" class="edge"><title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M349.596,-402.755C364.972,-400.119 383.82,-396.888 400.437,-394.039"/>
<polygon fill="#000000" stroke="#000000" points="401.179,-397.463 410.443,-392.324 399.996,-390.564 401.179,-397.463"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge27" class="edge"><title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M196.281,-36.7544C218.781,-39.9688 251.52,-44.6457 277.229,-48.3184"/>
<polygon fill="#000000" stroke="#000000" points="277.015,-51.8234 287.41,-49.7728 278.005,-44.8937 277.015,-51.8234"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge26" class="edge"><title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M196.281,-29.2456C218.346,-26.0935 250.257,-21.5348 275.729,-17.8959"/>
<polygon fill="#000000" stroke="#000000" points="276.443,-21.3295 285.848,-16.4503 275.453,-14.3998 276.443,-21.3295"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_edge28" class="edge"><title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M474.571,-393.244C484.692,-395.278 496.09,-397.568 506.833,-399.727"/>
<polygon fill="#000000" stroke="#000000" points="506.375,-403.205 516.869,-401.744 507.754,-396.342 506.375,-403.205"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge32" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M231.175,-346.571C271.03,-355.193 323.668,-368.65 368,-387 385.115,-394.084 387.919,-398.808 404,-408 406.211,-409.264 408.498,-410.564 410.803,-411.868"/>
<polygon fill="#000000" stroke="#000000" points="409.22,-414.993 419.651,-416.85 412.655,-408.893 409.22,-414.993"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge29" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M194.274,-347.054C218.638,-359.154 256.358,-377.885 283.55,-391.389"/>
<polygon fill="#000000" stroke="#000000" points="282.177,-394.615 292.69,-395.928 285.29,-388.345 282.177,-394.615"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge31" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M231.124,-335.743C270.726,-337.471 323.1,-342.112 368,-354 382.439,-357.823 397.62,-364.198 410.412,-370.331"/>
<polygon fill="#000000" stroke="#000000" points="409.164,-373.619 419.677,-374.928 412.275,-367.348 409.164,-373.619"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_node16" class="node"><title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node16"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="481,-150 404,-150 404,-126 481,-126 481,-150"/>
<text text-anchor="middle" x="442.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge30" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M186.575,-322.973C232.583,-289.59 362.071,-195.634 416.697,-155.997"/>
<polygon fill="#000000" stroke="#000000" points="418.759,-158.825 424.797,-150.12 414.648,-153.16 418.759,-158.825"/>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge33" class="edge"><title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M354.104,-108.036C367.431,-112.605 382.791,-117.871 396.88,-122.702"/>
<polygon fill="#000000" stroke="#000000" points="395.797,-126.03 406.391,-125.963 398.067,-119.409 395.797,-126.03"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge34" class="edge"><title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M347.721,-138C361.281,-138 377.838,-138 393.244,-138"/>
<polygon fill="#000000" stroke="#000000" points="393.676,-141.5 403.676,-138 393.676,-134.5 393.676,-141.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_predictor~~CalledByGraph Pages: 1 -->
<svg id="procpf_predictorCalledByGraph" width="302pt" height="32pt"
 viewBox="0.00 0.00 302.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_predictor~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_predictor~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 298,-28 298,4 -4,4"/>
<!-- proc~pf_predictor -->
<g id="proc~~pf_predictor~~CalledByGraph_node1" class="node"><title>proc~pf_predictor</title>
<polygon fill="none" stroke="black" points="294,-24 224,-24 224,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="259" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_predictor</text>
</g>
<!-- proc~pf_block_run -->
<g id="proc~~pf_predictor~~CalledByGraph_node2" class="node"><title>proc~pf_block_run</title>
<g id="a_proc~~pf_predictor~~CalledByGraph_node2"><a xlink:href=".././proc/pf_block_run.html" xlink:title="pf_block_run">
<polygon fill="#d9534f" stroke="#d9534f" points="188,-24 114,-24 114,-0 188,-0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_block_run</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_predictor~~CalledByGraph_edge1" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M188.183,-12C196.369,-12 205.153,-12 213.634,-12"/>
<polygon fill="#000000" stroke="#000000" points="213.768,-15.5001 223.768,-12 213.768,-8.5001 213.768,-15.5001"/>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_predictor~~CalledByGraph_node3" class="node"><title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_predictor~~CalledByGraph_node3"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,-0 78,-0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_predictor~~CalledByGraph_edge2" class="edge"><title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.164,-12C86.3694,-12 95.1281,-12 103.607,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.755,-15.5001 113.754,-12 103.754,-8.5001 103.755,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_predictor.html#src">pf_predictor</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">pf</span>     <span class="c">!! PFASST main data structure</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>         <span class="kd">::</span> <span class="n">t0</span>     <span class="c">!! Initial time of this processor</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>         <span class="kd">::</span> <span class="n">dt</span>     <span class="c">!! time step</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>  <span class="c">!!  User defined flags</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c_lev_p</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">f_lev_p</span>     <span class="c">!!</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">k</span>               <span class="c">!!  Loop indices</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index</span>     <span class="c">!!  Local variable for looping over levels</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">t0k</span>             <span class="c">!!  Initial time at time step k</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>          

    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_PREDICTOR</span><span class="p">)</span>
    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TPREDICTOR</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;beginning predictor&#39;</span>
    <span class="c">!!</span>
    <span class="c">!! Step 1. Getting the  initial condition on the finest level at each processor</span>
    <span class="c">!!         If we are doing multiple levels, then we need to coarsen to fine level</span>
    <span class="n">f_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">q0_style</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  Spread q0 to all the nodes</span>
       <span class="k">call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">spreadq0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="c">!!</span>
    <span class="c">!!  Step 2:   Proceed fine to coarse levels coarsening the fine solution and computing tau correction</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do coarsen  in predictor&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       do </span><span class="n">level_index</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
          <span class="n">f_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
          <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
          <span class="k">call </span><span class="n">pf_residual</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
          <span class="k">call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">restrict</span><span class="p">(</span><span class="n">f_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
          <span class="k">call </span><span class="n">restrict_time_space_fas</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">)</span>  <span class="c">!  Restrict</span>
          <span class="k">call save</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">c_lev_p</span><span class="p">)</span>
       <span class="k">end do</span>  <span class="c">!  level_index = pf%state%finest_level, 2, -1</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">level_index</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">!!</span>
    <span class="c">!! Step 3. Do the &quot;Burn in&quot; step on the coarse level to make the coarse values consistent</span>
    <span class="c">!!         (this is skipped if the fine initial conditions are already consistent)</span>
    <span class="c">!! The first processor does nothing, the second does one set of sweeps, the third two, etc</span>
    <span class="c">!! Hence, this is skipped completely if nprocs=1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do burnin  in predictor&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">q0_style</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  The coarse level needs burn in</span>
       <span class="c">!! If RK_pred is true, just do some RK_steps</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">RK_pred</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  Use Runge-Kutta to get the coarse initial data</span>
          <span class="c">!  Get new initial conditions</span>
          <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="mi">100000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

          <span class="c">!  Do a RK_step</span>
          <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
          <span class="c">!  Send forward</span>
          <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span>  <span class="mi">100000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       <span class="k">else</span>  <span class="c">!  Normal PFASST burn in</span>
          <span class="n">level_index</span><span class="o">=</span><span class="mi">1</span>
          <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">)</span>
          <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>
             <span class="n">t0k</span> <span class="o">=</span> <span class="n">t0</span><span class="o">-</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>   <span class="c">! Remember t0=pf%rank*dt is the beginning of this time slice so t0-(pf%rank)*dt is 0</span>
                                                <span class="c">! and we iterate up to the correct time step.</span>
                                                <span class="c">! for optimal control problem t, t0k has no influence on f_eval, so there this does something else</span>

             <span class="c">! Get new initial value (skip on first iteration)</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="c">! If we are doing PFASST_pred, we use the old values at nodes, otherwise spread q0</span>
                <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">PFASST_pred</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">spreadq0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="p">,</span> <span class="n">t0k</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>
             <span class="c">!  Do some sweeps</span>
             <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0k</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">nsweeps_burn</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">       </span><span class="n">endif</span>  <span class="c">!  RK_pred</span>
    <span class="k">end if</span>  <span class="c">! (q0_style .eq. 0)</span>

    <span class="c">!!</span>
    <span class="c">!! Step 4: Now we have everyone burned in, so do some coarse sweeps</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do sweeps  in predictor&#39;</span><span class="p">,</span> <span class="s1">&#39;Pipeline_pred&#39;</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">Pipeline_pred</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">Pipeline_pred</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">nsweeps_pred</span>
             <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=-</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span><span class="n">k</span>

             <span class="c">!  Get new initial conditions</span>
             <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

             <span class="c">!  Do a sweep</span>
             <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
             <span class="c">!  Send forward</span>
             <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span>  <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
          <span class="k">end do</span> <span class="c">! k = 1, c_lev_p%nsweeps_pred-1</span>
       <span class="k">else</span>  <span class="c">!  Don&#39;t pipeline</span>
          <span class="c">!  Get new initial conditions</span>
          <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

          <span class="c">!  Do a sweeps</span>
          <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">nsweeps_pred</span><span class="p">)</span>
          <span class="c">!  Send forward</span>
          <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span>  <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       <span class="n">endif</span>  <span class="c">! (Pipeline_pred .eq. .true) then</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;returning to fine level in predictor&#39;</span>
    <span class="c">!!</span>
    <span class="c">!!  Step 5:  Return to fine level sweeping on any level in between coarsest and finest</span>
    <span class="k">do </span><span class="n">level_index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>  <span class="c">!  Will do nothing with one level</span>
       <span class="n">f_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
       <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">call </span><span class="n">interpolate_time_space</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">Finterp</span><span class="p">)</span>
       <span class="k">call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">Q</span><span class="p">(</span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="k">call </span><span class="n">interpolate_q0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

       <span class="c">!  Do a sweep on level unless we are at the finest level</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">level_index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">%</span><span class="n">nsweeps_pred</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end do</span>

<span class="k">    call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TPREDICTOR</span><span class="p">)</span>
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_PREDICTOR</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;ending predictor&#39;</span>
  <span class="k">end subroutine </span><span class="n">pf_predictor</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>