<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_predictor &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_predictor
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for procedures.">89 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_predictor</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_predictor.html#src">pf_predictor</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_predictor(pf, t0, dt, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST Predictor.
  Subroutine  to initialize the solution on each processor
  The goal is to have a solution at each level and each node set to a consistent value
  When this is called, the value of q0 at the fine level on each processor has been set somehow (see q0_style below)</p>
<p>This can be broken down into four substeps
 1. Get the  initial condition on the finest level at each node
 2. Coarsen the initial condition to each coarser level with tau corrections
 3. Do the "Burn in" step on the coarse level to make the coarse values consistent
    (this is skipped if the fine initial conditions are already consistent)
 4. Do some coarse grid sweeps to improve initial solutions on coarsest nodes
 5. Interpolating coarse correction back to finer levels sweeping along the way.</p>
<p>There are several parameters or flags that determine how things are done:
  integer  q0_style:    can take 3 values
           0:  Only the q0 at t=0 is valid  (default)
           1:  The q0 at each processor is valid
           2:  q0 and all nodes at each processor is valid
 logical  PFASST_pred:  If true, the burn-in step uses the "PFASST predictor" trick
 integer  nsweeps_burn: Determines how many sweeps are done on the coarse level during burn in
 integer  nsweeps_pred: Determines how many sweeps are done at the coarse level after burn in
 logical Pipeline_burn: True if coarse sweeps during burn in are pipelined  (meaningless if nsweeps_burn&gt;1 on coarse level)
 logical Pipeline_pred: True if coarse sweeps after burn in are pipelined  (meaningless if nsweeps_pred&gt;1 on coarse level)
    Pipeline variables do nothing if there is only one processor
 logical  RK_pred:      If true, the coarse level is initialized with Runge-Kutta instead of the  PFASST burn in.
                        We  will still do coarse sweeps after and correct finer levels</p>
<p>The user defined flags(:) parameter is used to determine whether we are in a (standard) forward-in-time run (flags(1) == 1)
 or backward-in-time (for the adjoint) with a given terminal condition qend instead of initial condition q0  (flags(1) == 2).
 In the latter case, e.g., sweeper%spreadq0 has to do the correct thing (i.e., spread qend instead of q0).</p>
<p>No time communication is performed during the predictor since all
 procesors can do the work themselves</p>
<p>The iteration count is reset to 0, and the status is reset to
  ITERATING.</p>
<p>Step 1. Getting the  initial condition on the finest level at each processor
         If we are doing multiple levels, then we need to coarsen to fine level</p>
<p>Step 2:   Proceed fine to coarse levels coarsening the fine solution and computing tau correction</p>
<p>Step 3. Do the "Burn in" step on the coarse level to make the coarse values consistent
         (this is skipped if the fine initial conditions are already consistent)
 The first processor does nothing, the second does one set of sweeps, the third two, etc
 Hence, this is skipped completely if nprocs=1
 If RK_pred is true, just do some RK_steps</p>
<p>Step 4: Now we have everyone burned in, so do some coarse sweeps</p>
<p>Step 5:  Return to fine level sweeping on any level in between coarsest and finest</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E20"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td><p>PFASST main data structure</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E8"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td><p>Initial time of this processor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E16"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>time step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E27"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td><p>User defined flags</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_predictor~~CallsGraph Pages: 1 -->
<svg id="procpf_predictorCallsGraph" width="589pt" height="531pt"
 viewBox="0.00 0.00 589.00 531.46" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_predictor~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 527.4633)">
<title>proc~~pf_predictor~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-527.4633 585,-527.4633 585,4 -4,4"/>
<!-- proc~pf_predictor -->
<g id="proc~~pf_predictor~~CallsGraph_node1" class="node">
<title>proc~pf_predictor</title>
<polygon fill="none" stroke="#000000" points="70,-363 0,-363 0,-339 70,-339 70,-363"/>
<text text-anchor="middle" x="35" y="-348.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_predictor</text>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_predictor~~CallsGraph_node2" class="node">
<title>proc~pf_residual</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node2"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="350.5,-504 285.5,-504 285.5,-480 350.5,-480 350.5,-504"/>
<text text-anchor="middle" x="318" y="-489.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_predictor~~CallsGraph_edge1" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M45.4182,-363.1099C58.3457,-377.4773 81.6729,-401.3261 106,-416 160.3559,-448.7871 231.0342,-470.5548 275.4697,-482.0929"/>
<polygon fill="#000000" stroke="#000000" points="274.8019,-485.5343 285.3558,-484.6033 276.5249,-478.7497 274.8019,-485.5343"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_predictor~~CallsGraph_node3" class="node">
<title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node3"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-325 106,-325 106,-301 232,-301 232,-325"/>
<text text-anchor="middle" x="169" y="-310.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_predictor~~CallsGraph_edge2" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M70.2069,-341.0159C84.3282,-337.0114 100.9024,-332.3113 116.3981,-327.917"/>
<polygon fill="#000000" stroke="#000000" points="117.7229,-331.1793 126.3887,-325.0838 115.8131,-324.4449 117.7229,-331.1793"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node4" class="node">
<title>proc~end_timer</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node4"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="473,-453 412,-453 412,-429 473,-429 473,-453"/>
<text text-anchor="middle" x="442.5" y="-438.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge3" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M40.1241,-363.245C49.8232,-384.9901 72.9004,-430.4554 106,-456 166.4248,-502.6328 192.7627,-500.1499 268,-513 311.8101,-520.4825 327.6216,-531.5714 368,-513 390.3362,-502.7268 386.2144,-487.974 404,-471 408.1378,-467.051 412.7701,-463.0989 417.3486,-459.4197"/>
<polygon fill="#000000" stroke="#000000" points="419.6654,-462.0519 425.4132,-453.1517 415.3697,-456.5249 419.6654,-462.0519"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_predictor~~CallsGraph_node5" class="node">
<title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node5"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="231,-384 107,-384 107,-360 231,-360 231,-384"/>
<text text-anchor="middle" x="169" y="-369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_predictor~~CallsGraph_edge4" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M70.2069,-356.5175C78.464,-357.8115 87.5598,-359.237 96.7882,-360.6832"/>
<polygon fill="#000000" stroke="#000000" points="96.3994,-364.1649 106.8207,-362.2555 97.4832,-357.2493 96.3994,-364.1649"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_node6" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node6"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="349.5,-424 286.5,-424 286.5,-400 349.5,-400 349.5,-424"/>
<text text-anchor="middle" x="318" y="-409.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge5" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M50.6467,-363.0528C64.4135,-372.9458 85.417,-386.3662 106,-393 162.8617,-411.3262 232.4546,-414.0832 276.0209,-413.6267"/>
<polygon fill="#000000" stroke="#000000" points="276.305,-417.1225 286.2448,-413.4552 276.1875,-410.1235 276.305,-417.1225"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node7" class="node">
<title>proc~start_timer</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node7"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="474.5,-402 410.5,-402 410.5,-378 474.5,-378 474.5,-402"/>
<text text-anchor="middle" x="442.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge6" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M45.4618,-338.6865C88.0885,-289.9973 251.9159,-117.3772 368,-197 397.34,-217.1245 425.8869,-321.6909 437.2961,-367.9479"/>
<polygon fill="#000000" stroke="#000000" points="433.945,-368.9805 439.7013,-377.8752 440.7482,-367.3323 433.945,-368.9805"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_predictor~~CallsGraph_node8" class="node">
<title>proc~pf_send</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node8"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-66 142,-66 142,-42 196,-42 196,-66"/>
<text text-anchor="middle" x="169" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_predictor~~CallsGraph_edge7" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M36.5713,-338.8513C43.0093,-290.8257 68.8013,-114.8967 106,-75 112.8856,-67.615 122.4332,-62.8251 132.0155,-59.7191"/>
<polygon fill="#000000" stroke="#000000" points="133.1594,-63.0358 141.9038,-57.0536 131.3375,-56.277 133.1594,-63.0358"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_predictor~~CallsGraph_node9" class="node">
<title>proc~pf_recv</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node9"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-108 142,-108 142,-84 196,-84 196,-108"/>
<text text-anchor="middle" x="169" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_predictor~~CallsGraph_edge8" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M37.864,-338.8956C45.5233,-308.02 68.4837,-224.5018 106,-164 117.4144,-145.5922 134.2396,-127.7449 147.6315,-114.9565"/>
<polygon fill="#000000" stroke="#000000" points="150.1199,-117.4219 155.0529,-108.0455 145.3494,-112.2991 150.1199,-117.4219"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge9" class="edge">
<title>proc~pf_residual&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M347.5048,-479.9137C364.1287,-473.1039 385.1083,-464.5099 403.1205,-457.1313"/>
<polygon fill="#000000" stroke="#000000" points="404.8486,-460.2058 412.7756,-453.1763 402.1951,-453.7282 404.8486,-460.2058"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge11" class="edge">
<title>proc~pf_residual&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M332.1768,-479.8703C349.1212,-465.4334 378.4007,-440.6792 404,-420 408.7295,-416.1795 413.8322,-412.1439 418.7274,-408.314"/>
<polygon fill="#000000" stroke="#000000" points="420.9236,-411.0399 426.6672,-402.137 416.6253,-405.515 420.9236,-411.0399"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_predictor~~CallsGraph_node17" class="node">
<title>proc~pf_set_resid</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node17"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="478,-504 407,-504 407,-480 478,-480 478,-504"/>
<text text-anchor="middle" x="442.5" y="-489.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_residual&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_predictor~~CallsGraph_edge10" class="edge">
<title>proc~pf_residual&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M350.7109,-492C364.7597,-492 381.4217,-492 396.6684,-492"/>
<polygon fill="#000000" stroke="#000000" points="396.9483,-495.5001 406.9483,-492 396.9482,-488.5001 396.9483,-495.5001"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge13" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M206.7412,-325.0438C247.5796,-338.7001 314.0859,-362.7722 368,-391 385.5992,-400.2144 404.1525,-412.6568 418.3416,-422.8242"/>
<polygon fill="#000000" stroke="#000000" points="416.4206,-425.7549 426.5649,-428.8117 420.5409,-420.096 416.4206,-425.7549"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge14" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M189.9537,-325.1119C202.3266,-332.3937 218.216,-341.9722 232,-351 253.1248,-364.8357 276.4558,-381.4737 293.4808,-393.876"/>
<polygon fill="#000000" stroke="#000000" points="291.6271,-396.8566 301.7639,-399.9383 295.7613,-391.2078 291.6271,-396.8566"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge15" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M232.3739,-304.1171C272.7193,-301.1036 325.2382,-302.1865 368,-320 392.833,-330.3448 414.3772,-352.9802 427.8212,-369.7249"/>
<polygon fill="#000000" stroke="#000000" points="425.2083,-372.068 434.0877,-377.848 430.7508,-367.7924 425.2083,-372.068"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~pf_predictor~~CallsGraph_node11" class="node">
<title>proc~restrict_ts_integral</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node11"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-150 268,-150 268,-126 368,-126 368,-150"/>
<text text-anchor="middle" x="318" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~pf_predictor~~CallsGraph_edge12" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M179.2414,-300.9715C204.4411,-271.3745 269.6694,-194.7641 300.8758,-158.1124"/>
<polygon fill="#000000" stroke="#000000" points="303.869,-159.9957 307.687,-150.1126 298.5392,-155.4577 303.869,-159.9957"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~pf_predictor~~CallsGraph_node15" class="node">
<title>proc~restrict_ts</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node15"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="347.5,-230 288.5,-230 288.5,-206 347.5,-206 347.5,-230"/>
<text text-anchor="middle" x="318" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~pf_predictor~~CallsGraph_edge16" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M185.0343,-300.8595C204.2655,-286.5279 237.7071,-262.3279 268,-244 273.1482,-240.8852 278.7085,-237.7664 284.1858,-234.8254"/>
<polygon fill="#000000" stroke="#000000" points="286.0091,-237.8213 293.2378,-230.0756 282.7566,-231.6228 286.0091,-237.8213"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_node14" class="node">
<title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="581,-427 517,-427 517,-403 581,-403 581,-427"/>
<text text-anchor="middle" x="549" y="-412.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_edge17" class="edge">
<title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M473.0186,-433.5494C483.6676,-430.9497 495.8097,-427.9854 507.2151,-425.201"/>
<polygon fill="#000000" stroke="#000000" points="508.1078,-428.586 516.9923,-422.8141 506.4475,-421.7857 508.1078,-428.586"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge18" class="edge">
<title>proc~interpolate_time_space&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M183.2639,-384.089C201.5335,-398.7509 234.8171,-422.7711 268,-433 312.1823,-446.6195 365.6262,-446.855 401.6323,-444.8171"/>
<polygon fill="#000000" stroke="#000000" points="402.0081,-448.3001 411.7596,-444.1578 401.5533,-441.3149 402.0081,-448.3001"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge19" class="edge">
<title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M213.7049,-384.0013C233.5599,-389.3315 256.7953,-395.5692 276.2891,-400.8024"/>
<polygon fill="#000000" stroke="#000000" points="275.5388,-404.2249 286.1043,-403.4374 277.3538,-397.4643 275.5388,-404.2249"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge21" class="edge">
<title>proc~interpolate_time_space&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M231.0614,-376.0845C282.8218,-379.491 355.1755,-384.2529 400.407,-387.2297"/>
<polygon fill="#000000" stroke="#000000" points="400.2523,-390.727 410.4606,-387.8914 400.7121,-383.7421 400.2523,-390.727"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_node12" class="node">
<title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node12"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="481,-230 404,-230 404,-206 481,-206 481,-230"/>
<text text-anchor="middle" x="442.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge20" class="edge">
<title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M190.4611,-359.9159C238.7918,-332.7022 356.2867,-266.5442 412.0972,-235.119"/>
<polygon fill="#000000" stroke="#000000" points="414.1422,-237.9842 421.1386,-230.028 410.7077,-231.8847 414.1422,-237.9842"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge22" class="edge">
<title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M349.7387,-419.393C365.4892,-423.0618 384.702,-427.537 401.5484,-431.4611"/>
<polygon fill="#000000" stroke="#000000" points="401.1464,-434.9611 411.6797,-433.821 402.7345,-428.1436 401.1464,-434.9611"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge23" class="edge">
<title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M349.7387,-406.3915C365.1313,-403.6716 383.8305,-400.3673 400.3962,-397.44"/>
<polygon fill="#000000" stroke="#000000" points="401.1479,-400.8615 410.3863,-395.6747 399.9298,-393.9683 401.1479,-400.8615"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_edge24" class="edge">
<title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M474.7425,-397.5687C484.8566,-399.9429 496.1748,-402.5997 506.8672,-405.1097"/>
<polygon fill="#000000" stroke="#000000" points="506.3318,-408.5791 516.8671,-407.4571 507.9316,-401.7643 506.3318,-408.5791"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node10" class="node">
<title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="350,-108 286,-108 286,-84 350,-84 350,-108"/>
<text text-anchor="middle" x="318" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge27" class="edge">
<title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M196.3289,-61.7034C218.6536,-67.9963 250.5785,-76.9953 276.1253,-84.1964"/>
<polygon fill="#000000" stroke="#000000" points="275.3497,-87.6141 285.9242,-86.9585 277.2489,-80.8766 275.3497,-87.6141"/>
</g>
<!-- pf_stop -->
<g id="proc~~pf_predictor~~CallsGraph_node13" class="node">
<title>pf_stop</title>
<polygon fill="#777777" stroke="#777777" points="345,-66 291,-66 291,-42 345,-42 345,-66"/>
<text text-anchor="middle" x="318" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop</text>
</g>
<!-- proc~pf_send&#45;&gt;pf_stop -->
<g id="proc~~pf_predictor~~CallsGraph_edge26" class="edge">
<title>proc~pf_send&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M196.3289,-54C219.9578,-54 254.3413,-54 280.534,-54"/>
<polygon fill="#000000" stroke="#000000" points="280.8444,-57.5001 290.8444,-54 280.8443,-50.5001 280.8444,-57.5001"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node16" class="node">
<title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="348.5,-24 287.5,-24 287.5,0 348.5,0 348.5,-24"/>
<text text-anchor="middle" x="318" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge25" class="edge">
<title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M196.3289,-46.2966C219.0244,-39.8992 251.6417,-30.705 277.393,-23.4463"/>
<polygon fill="#000000" stroke="#000000" points="278.5704,-26.7509 287.2457,-20.669 276.6712,-20.0134 278.5704,-26.7509"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge30" class="edge">
<title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M196.3289,-96C218.5548,-96 250.2961,-96 275.7858,-96"/>
<polygon fill="#000000" stroke="#000000" points="275.9243,-99.5001 285.9242,-96 275.9242,-92.5001 275.9243,-99.5001"/>
</g>
<!-- proc~pf_recv&#45;&gt;pf_stop -->
<g id="proc~~pf_predictor~~CallsGraph_edge29" class="edge">
<title>proc~pf_recv&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M196.3289,-88.2966C220.0628,-81.6065 254.6471,-71.8579 280.8828,-64.4626"/>
<polygon fill="#000000" stroke="#000000" points="282.169,-67.7365 290.8444,-61.6546 280.2698,-60.999 282.169,-67.7365"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge28" class="edge">
<title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M196.2041,-90.3807C207.8864,-87.1253 221.2845,-82.2051 232,-75 252.4022,-61.2816 248.1328,-47.4824 268,-33 271.2038,-30.6646 274.7064,-28.5293 278.3229,-26.5914"/>
<polygon fill="#000000" stroke="#000000" points="279.9642,-29.6855 287.4418,-22.1797 276.9156,-23.3842 279.9642,-29.6855"/>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge31" class="edge">
<title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M343.0707,-150.1197C351.1681,-154.2753 360.0923,-159.1151 368,-164 385.6696,-174.9152 404.6076,-188.6718 418.9679,-199.5683"/>
<polygon fill="#000000" stroke="#000000" points="417.2005,-202.6236 427.2655,-205.9323 421.4607,-197.0692 417.2005,-202.6236"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge32" class="edge">
<title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M347.5048,-218C361.3075,-218 378.1129,-218 393.7295,-218"/>
<polygon fill="#000000" stroke="#000000" points="393.7766,-221.5001 403.7766,-218 393.7765,-214.5001 393.7766,-221.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_predictor~~CalledByGraph Pages: 1 -->
<svg id="procpf_predictorCalledByGraph" width="302pt" height="32pt"
 viewBox="0.00 0.00 302.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_predictor~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_predictor~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 298,-28 298,4 -4,4"/>
<!-- proc~pf_predictor -->
<g id="proc~~pf_predictor~~CalledByGraph_node1" class="node">
<title>proc~pf_predictor</title>
<polygon fill="none" stroke="#000000" points="294,-24 224,-24 224,0 294,0 294,-24"/>
<text text-anchor="middle" x="259" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_predictor</text>
</g>
<!-- proc~pf_block_run -->
<g id="proc~~pf_predictor~~CalledByGraph_node2" class="node">
<title>proc~pf_block_run</title>
<g id="a_proc~~pf_predictor~~CalledByGraph_node2"><a xlink:href=".././proc/pf_block_run.html" xlink:title="pf_block_run">
<polygon fill="#d9534f" stroke="#d9534f" points="188,-24 114,-24 114,0 188,0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_block_run</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_predictor~~CalledByGraph_edge1" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M188.1675,-12C196.4095,-12 205.2328,-12 213.757,-12"/>
<polygon fill="#000000" stroke="#000000" points="213.9472,-15.5001 223.9472,-12 213.9471,-8.5001 213.9472,-15.5001"/>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_predictor~~CalledByGraph_node3" class="node">
<title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_predictor~~CalledByGraph_node3"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,0 78,0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_predictor~~CalledByGraph_edge2" class="edge">
<title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.1722,-12C86.424,-12 95.2132,-12 103.7265,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.9195,-15.5001 113.9195,-12 103.9195,-8.5001 103.9195,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_predictor.html#src">pf_predictor</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">pf</span>     <span class="c">!! PFASST main data structure</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>         <span class="kd">::</span> <span class="n">t0</span>     <span class="c">!! Initial time of this processor</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>         <span class="kd">::</span> <span class="n">dt</span>     <span class="c">!! time step</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>  <span class="c">!!  User defined flags</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c_lev</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">f_lev</span>     <span class="c">!!</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">k</span>               <span class="c">!!  Loop indices</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index</span>     <span class="c">!!  Local variable for looping over levels</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">t0k</span>             <span class="c">!!  Initial time at time step k</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>          

    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_PREDICTOR</span><span class="p">)</span>
    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TPREDICTOR</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;beginning predictor&#39;</span>
    <span class="c">!!</span>
    <span class="c">!! Step 1. Getting the  initial condition on the finest level at each processor</span>
    <span class="c">!!         If we are doing multiple levels, then we need to coarsen to fine level</span>
    <span class="n">f_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">q0_style</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  Spread q0 to all the nodes</span>
       <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">spreadq0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
    <span class="n">endif</span>
<span class="c">!    if (pf%nlevels==1) return</span>
    <span class="c">!!</span>
    <span class="c">!!  Step 2:   Proceed fine to coarse levels coarsening the fine solution and computing tau correction</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do coarsen  in predictor&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       do </span><span class="n">level_index</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
          <span class="n">f_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
          <span class="n">c_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
          <span class="k">call </span><span class="n">pf_residual</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
          <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">restrict</span><span class="p">(</span><span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
          <span class="k">call </span><span class="n">restrict_time_space_fas</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">)</span>  <span class="c">!  Restrict</span>
          <span class="k">call save</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">c_lev</span><span class="p">)</span>
       <span class="k">end do</span>  <span class="c">!  level_index = pf%state%finest_level, 2, -1</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">level_index</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">c_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">!!</span>
    <span class="c">!! Step 3. Do the &quot;Burn in&quot; step on the coarse level to make the coarse values consistent</span>
    <span class="c">!!         (this is skipped if the fine initial conditions are already consistent)</span>
    <span class="c">!! The first processor does nothing, the second does one set of sweeps, the third two, etc</span>
    <span class="c">!! Hence, this is skipped completely if nprocs=1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do burnin  in predictor&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">q0_style</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  The coarse level needs burn in</span>
       <span class="c">!! If RK_pred is true, just do some RK_steps</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">RK_pred</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  Use Runge-Kutta to get the coarse initial data</span>
          <span class="c">!  Get new initial conditions</span>
          <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="mi">100000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

          <span class="c">!  Do a RK_step</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">stepper</span><span class="p">%</span><span class="n">do_n_steps</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span><span class="n">c_lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>       
          <span class="c">!  Send forward</span>
          <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span>  <span class="mi">100000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       <span class="k">else</span>  <span class="c">!  Normal PFASST burn in</span>
          <span class="n">level_index</span><span class="o">=</span><span class="mi">1</span>
          <span class="n">c_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">)</span>
          <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>
             <span class="n">t0k</span> <span class="o">=</span> <span class="n">t0</span><span class="o">-</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>   <span class="c">! Remember t0=pf%rank*dt is the beginning of this time slice so t0-(pf%rank)*dt is 0</span>
                                                <span class="c">! and we iterate up to the correct time step.</span>
                                                <span class="c">! for optimal control problem t, t0k has no influence on f_eval, so there this does something else</span>

             <span class="c">! Get new initial value (skip on first iteration)</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">c_lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="c">! If we are doing PFASST_pred, we use the old values at nodes, otherwise spread q0</span>
                <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">PFASST_pred</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">spreadq0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="p">,</span> <span class="n">t0k</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>
             <span class="c">!  Do some sweeps</span>
             <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0k</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">nsweeps_burn</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">       </span><span class="n">endif</span>  <span class="c">!  RK_pred</span>
    <span class="k">end if</span>  <span class="c">! (q0_style .eq. 0)</span>

    <span class="c">!!</span>
    <span class="c">!! Step 4: Now we have everyone burned in, so do some coarse sweeps</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do sweeps  in predictor&#39;</span><span class="p">,</span> <span class="s1">&#39;Pipeline_pred&#39;</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">Pipeline_pred</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">Pipeline_pred</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nsweeps_pred</span>
             <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=-</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span><span class="n">k</span>

             <span class="c">!  Get new initial conditions</span>
             <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

             <span class="c">!  Do a sweep</span>
             <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
             <span class="c">!  Send forward</span>
             <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span>  <span class="n">c_lev</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
          <span class="k">end do</span> <span class="c">! k = 1, c_lev%nsweeps_pred-1</span>
       <span class="k">else</span>  <span class="c">!  Don&#39;t pipeline</span>
          <span class="c">!  Get new initial conditions</span>
          <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

          <span class="c">!  Do a sweeps</span>
          <span class="k">call </span><span class="n">c_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">nsweeps_pred</span><span class="p">)</span>
          <span class="c">!  Send forward</span>
          <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span>  <span class="n">c_lev</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       <span class="n">endif</span>  <span class="c">! (Pipeline_pred .eq. .true) then</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;returning to fine level in predictor&#39;</span>
    <span class="c">!!</span>
    <span class="c">!!  Step 5:  Return to fine level sweeping on any level in between coarsest and finest</span>
    <span class="k">do </span><span class="n">level_index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>  <span class="c">!  Will do nothing with one level</span>
       <span class="n">f_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
       <span class="n">c_lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">call </span><span class="n">interpolate_time_space</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">%</span><span class="n">Finterp</span><span class="p">)</span>
       <span class="k">call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">f_lev</span><span class="p">%</span><span class="n">Q</span><span class="p">(</span><span class="n">f_lev</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">interpolate_q0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">,</span> <span class="n">c_lev</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

       <span class="c">!  Do a sweep on level unless we are at the finest level</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">level_index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">f_lev</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_lev</span><span class="p">%</span><span class="n">nsweeps_pred</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end do</span>

<span class="k">    call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TPREDICTOR</span><span class="p">)</span>
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_PREDICTOR</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;ending predictor&#39;</span>
  <span class="k">end subroutine </span><span class="n">pf_predictor</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>