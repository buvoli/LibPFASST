<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tommaso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_predictor &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_predictor
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">89 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_predictor</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_predictor.html#src">pf_predictor</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_predictor(pf, t0, dt, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST Predictor.
  Subroutine  to initialize the solution on each processor
  The goal is to have a solution at each level and each node set to a consistent value
  When this is called, the value of q0 at the fine level on each processor has been set somehow (see q0_style below)</p>
<p>This can be broken down into four substeps
 1. Get the  initial condition on the finest level at each node
 2. Coarsen the initial condition to each coarser level with tau corrections
 3. Do the "Burn in" step on the coarse level to make the coarse values consistent
    (this is skipped if the fine initial conditions are already consistent)
 4. Do some coarse grid sweeps to improve initial solutions on coarsest nodes
 5. Interpolating coarse correction back to finer levels sweeping along the way.</p>
<p>There are several parameters or flags that determine how things are done:
  integer  q0_style:    can take 3 values
           0:  Only the q0 at t=0 is valid  (default)
           1:  The q0 at each processor is valid
           2:  q0 and all nodes at each processor is valid
 logical  PFASST_pred:  If true, the burn-in step uses the "PFASST predictor" trick
 integer  nsweeps_burn: Determines how many sweeps are done on the coarse level during burn in
 integer  nsweeps_pred: Determines how many sweeps are done at the coarse level after burn in
 logical Pipeline_burn: True if coarse sweeps during burn in are pipelined  (meaningless if nsweeps_burn&gt;1 on coarse level)
 logical Pipeline_pred: True if coarse sweeps after burn in are pipelined  (meaningless if nsweeps_pred&gt;1 on coarse level)
    Pipeline variables do nothing if there is only one processor
 logical  RK_pred:      If true, the coarse level is initialized with Runge-Kutta instead of the  PFASST burn in.
                        We  will still do coarse sweeps after and correct finer levels</p>
<p>The user defined flags(:) parameter is used to determine whether we are in a (standard) forward-in-time run (flags(1) == 1)
 or backward-in-time (for the adjoint) with a given terminal condition qend instead of initial condition q0  (flags(1) == 2).
 In the latter case, e.g., sweeper%spreadq0 has to do the correct thing (i.e., spread qend instead of q0).</p>
<p>No time communication is performed during the predictor since all
 procesors can do the work themselves</p>
<p>The iteration count is reset to 0, and the status is reset to
  ITERATING.</p>
<p>Step 1. Getting the  initial condition on the finest level at each processor
         If we are doing multiple levels, then we need to coarsen to fine level</p>
<p>Step 2:   Proceed fine to coarse levels coarsening the fine solution and computing tau correction</p>
<p>Step 3. Do the "Burn in" step on the coarse level to make the coarse values consistent
         (this is skipped if the fine initial conditions are already consistent)
 The first processor does nothing, the second does one set of sweeps, the third two, etc
 Hence, this is skipped completely if nprocs=1
 If RK_pred is true, just do some RK_steps</p>
<p>Step 4: Now we have everyone burned in, so do some coarse sweeps</p>
<p>Step 5:  Return to fine level sweeping on any level in between coarsest and finest</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E128"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td><p>PFASST main data structure</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0%7E35"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t0</strong></td><td><p>Initial time of this processor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E56"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>time step</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E127"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td><p>User defined flags</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_predictor~~CallsGraph Pages: 1 -->
<svg id="procpf_predictorCallsGraph" width="589pt" height="584pt"
 viewBox="0.00 0.00 589.00 584.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_predictor~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 580)">
<title>proc~~pf_predictor~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-580 585,-580 585,4 -4,4"/>
<!-- proc~pf_predictor -->
<g id="proc~~pf_predictor~~CallsGraph_node1" class="node"><title>proc~pf_predictor</title>
<polygon fill="none" stroke="black" points="70,-252 0,-252 0,-228 70,-228 70,-252"/>
<text text-anchor="middle" x="35" y="-237.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_predictor</text>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node2" class="node"><title>proc~end_timer</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node2"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="473,-224 412,-224 412,-200 473,-200 473,-224"/>
<text text-anchor="middle" x="442.5" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge1" class="edge"><title>proc~pf_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M48.4124,-227.9C61.6819,-215.559 83.8227,-196.621 106,-185 172.743,-150.026 193.491,-146.237 268,-135 311.947,-128.372 327.139,-117.516 368,-135 394.574,-146.371 416.112,-172.59 428.849,-191.269"/>
<polygon fill="#000000" stroke="#000000" points="425.979,-193.276 434.378,-199.735 431.84,-189.448 425.979,-193.276"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_predictor~~CallsGraph_node3" class="node"><title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node3"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="232,-496 106,-496 106,-472 232,-472 232,-496"/>
<text text-anchor="middle" x="169" y="-481.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_predictor~~CallsGraph_edge2" class="edge"><title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M36.4732,-252.11C38.5158,-288.174 49.3084,-396.187 106,-458 109.101,-461.382 112.713,-464.338 116.603,-466.92"/>
<polygon fill="#000000" stroke="#000000" points="115.061,-470.069 125.479,-471.993 118.534,-463.992 115.061,-470.069"/>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_predictor~~CallsGraph_node4" class="node"><title>proc~pf_residual</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node4"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="350.5,-184 285.5,-184 285.5,-160 350.5,-160 350.5,-184"/>
<text text-anchor="middle" x="318" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_predictor~~CallsGraph_edge3" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M70.0404,-229.249C81.4243,-225.798 94.2145,-222.076 106,-219 164.372,-203.764 232.631,-189.131 275.346,-180.351"/>
<polygon fill="#000000" stroke="#000000" points="276.275,-183.733 285.371,-178.301 274.873,-176.875 276.275,-183.733"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_predictor~~CallsGraph_node5" class="node"><title>proc~pf_send</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node5"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-24 142,-24 142,-0 196,-0 196,-24"/>
<text text-anchor="middle" x="169" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_predictor~~CallsGraph_edge4" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M36.5129,-227.809C38.6564,-192.543 49.6806,-89.3469 106,-33 113.096,-25.9009 122.675,-21.2006 132.179,-18.089"/>
<polygon fill="#000000" stroke="#000000" points="133.244,-21.4259 141.95,-15.3875 131.379,-14.6791 133.244,-21.4259"/>
</g>
<!-- proc~interpolate_q0 -->
<g id="proc~~pf_predictor~~CallsGraph_node6" class="node"><title>proc~interpolate_q0</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node6"><a xlink:href=".././proc/interpolate_q0.html" xlink:title="interpolate_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="209.5,-252 128.5,-252 128.5,-228 209.5,-228 209.5,-252"/>
<text text-anchor="middle" x="169" y="-237.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_q0</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_predictor~~CallsGraph_edge5" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M70.3369,-240C84.8746,-240 102.098,-240 118.003,-240"/>
<polygon fill="#000000" stroke="#000000" points="118.222,-243.5 128.222,-240 118.222,-236.5 118.222,-243.5"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_node7" class="node"><title>proc~call_hooks</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node7"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="349.5,-302 286.5,-302 286.5,-278 349.5,-278 349.5,-302"/>
<text text-anchor="middle" x="318" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge6" class="edge"><title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M70.2593,-251.433C81.5451,-254.888 94.2215,-258.44 106,-261 164.583,-273.733 233.594,-281.97 276.327,-286.298"/>
<polygon fill="#000000" stroke="#000000" points="276.045,-289.787 286.341,-287.289 276.734,-282.821 276.045,-289.787"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_predictor~~CallsGraph_node8" class="node"><title>proc~pf_recv</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node8"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="196,-66 142,-66 142,-42 196,-42 196,-66"/>
<text text-anchor="middle" x="169" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_predictor~~CallsGraph_edge7" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M38.1196,-227.819C43.8256,-198.49 62.1457,-123.187 106,-80 113.283,-72.8275 122.839,-67.5195 132.261,-63.6399"/>
<polygon fill="#000000" stroke="#000000" points="133.745,-66.8236 141.93,-60.0956 131.336,-60.2513 133.745,-66.8236"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node9" class="node"><title>proc~start_timer</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node9"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="474.5,-302 410.5,-302 410.5,-278 474.5,-278 474.5,-302"/>
<text text-anchor="middle" x="442.5" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge8" class="edge"><title>proc~pf_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M40.1335,-252.218C48.4809,-274.687 69.7118,-321.999 106,-341 209.266,-395.073 256.232,-362.1 368,-329 384.431,-324.134 401.416,-315.404 414.914,-307.435"/>
<polygon fill="#000000" stroke="#000000" points="416.943,-310.297 423.652,-302.097 413.294,-304.323 416.943,-310.297"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_predictor~~CallsGraph_node10" class="node"><title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node10"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="231,-332 107,-332 107,-308 231,-308 231,-332"/>
<text text-anchor="middle" x="169" y="-317.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_predictor~~CallsGraph_edge9" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M49.4491,-252.096C63.013,-263.866 84.9078,-281.724 106,-294 112.032,-297.511 118.629,-300.8 125.198,-303.78"/>
<polygon fill="#000000" stroke="#000000" points="124.166,-307.147 134.733,-307.913 126.95,-300.724 124.166,-307.147"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_node14" class="node"><title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="581,-263 517,-263 517,-239 581,-239 581,-263"/>
<text text-anchor="middle" x="549" y="-248.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_edge10" class="edge"><title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M473.166,-223.072C483.713,-227.008 495.781,-231.512 507.102,-235.737"/>
<polygon fill="#000000" stroke="#000000" points="506.209,-239.139 516.801,-239.356 508.656,-232.581 506.209,-239.139"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge15" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M186.175,-471.812C221.34,-444.916 306.524,-377.567 368,-311 391.278,-285.794 414.219,-253.343 428.121,-232.6"/>
<polygon fill="#000000" stroke="#000000" points="431.066,-234.491 433.67,-224.222 425.23,-230.626 431.066,-234.491"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge11" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M174.339,-471.928C185.587,-442.067 218.322,-363.718 268,-316 271.293,-312.837 275.046,-309.954 278.977,-307.356"/>
<polygon fill="#000000" stroke="#000000" points="280.956,-310.251 287.755,-302.124 277.373,-304.238 280.956,-310.251"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge14" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M232.129,-490.814C274.412,-492.13 329.475,-486.952 368,-458 415.512,-422.294 432.815,-349.322 438.702,-312.425"/>
<polygon fill="#000000" stroke="#000000" points="442.212,-312.613 440.184,-302.214 435.284,-311.608 442.212,-312.613"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~pf_predictor~~CallsGraph_node11" class="node"><title>proc~restrict_ts_integral</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node11"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="368,-576 268,-576 268,-552 368,-552 368,-576"/>
<text text-anchor="middle" x="318" y="-561.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~pf_predictor~~CallsGraph_edge12" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M188.354,-496.09C207.728,-508.602 239.366,-528.332 268,-543 271.143,-544.61 274.438,-546.207 277.769,-547.758"/>
<polygon fill="#000000" stroke="#000000" points="276.603,-551.072 287.159,-551.984 279.476,-544.688 276.603,-551.072"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~pf_predictor~~CallsGraph_node13" class="node"><title>proc~restrict_ts</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node13"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="347.5,-534 288.5,-534 288.5,-510 347.5,-510 347.5,-534"/>
<text text-anchor="middle" x="318" y="-519.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~pf_predictor~~CallsGraph_edge13" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M216.512,-496.023C236.476,-501.184 259.524,-507.142 278.508,-512.05"/>
<polygon fill="#000000" stroke="#000000" points="277.75,-515.469 288.308,-514.583 279.502,-508.692 277.75,-515.469"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge17" class="edge"><title>proc~pf_residual&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M350.547,-182.301C366.163,-187.4 385.177,-193.609 401.775,-199.029"/>
<polygon fill="#000000" stroke="#000000" points="401.154,-202.507 411.746,-202.284 403.326,-195.853 401.154,-202.507"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge16" class="edge"><title>proc~pf_residual&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M331.648,-184.184C352.921,-204.675 396.025,-246.196 421.456,-270.692"/>
<polygon fill="#000000" stroke="#000000" points="419.107,-273.289 428.737,-277.706 423.963,-268.248 419.107,-273.289"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node12" class="node"><title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="348.5,-24 287.5,-24 287.5,-0 348.5,-0 348.5,-24"/>
<text text-anchor="middle" x="318" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge19" class="edge"><title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M196.281,-12C218.781,-12 251.52,-12 277.229,-12"/>
<polygon fill="#000000" stroke="#000000" points="277.41,-15.5001 287.41,-12 277.41,-8.5001 277.41,-15.5001"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_node15" class="node"><title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="350,-66 286,-66 286,-42 350,-42 350,-66"/>
<text text-anchor="middle" x="318" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge18" class="edge"><title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M196.281,-19.5088C218.444,-25.8411 250.541,-35.0116 276.068,-42.3051"/>
<polygon fill="#000000" stroke="#000000" points="275.271,-45.7174 285.848,-45.0993 277.194,-38.9867 275.271,-45.7174"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge22" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M178.539,-227.793C193.736,-207.27 227.695,-166.57 268,-151 309.458,-134.984 326.195,-135.912 368,-151 390.768,-159.217 411.468,-177.896 425.056,-192.434"/>
<polygon fill="#000000" stroke="#000000" points="422.556,-194.889 431.841,-199.993 427.765,-190.213 422.556,-194.889"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge20" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M205.585,-252.104C227.05,-259.405 254.456,-268.727 276.715,-276.298"/>
<polygon fill="#000000" stroke="#000000" points="275.629,-279.625 286.223,-279.532 277.883,-272.998 275.629,-279.625"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge21" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M209.722,-244.244C249.898,-248.905 313.656,-257.311 368,-269 378.619,-271.284 389.96,-274.254 400.477,-277.238"/>
<polygon fill="#000000" stroke="#000000" points="399.677,-280.65 410.257,-280.081 401.631,-273.929 399.677,-280.65"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge24" class="edge"><title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M337.872,-277.983C358.135,-265.081 390.536,-244.451 413.712,-229.693"/>
<polygon fill="#000000" stroke="#000000" points="415.849,-232.482 422.405,-224.159 412.089,-226.577 415.849,-232.482"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge23" class="edge"><title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M349.596,-290C364.972,-290 383.82,-290 400.437,-290"/>
<polygon fill="#000000" stroke="#000000" points="400.443,-293.5 410.443,-290 400.443,-286.5 400.443,-293.5"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge26" class="edge"><title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M196.281,-46.4912C218.881,-40.0339 251.811,-30.6253 277.571,-23.2653"/>
<polygon fill="#000000" stroke="#000000" points="278.756,-26.5669 287.41,-20.4543 276.833,-19.8363 278.756,-26.5669"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge25" class="edge"><title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M196.281,-54C218.346,-54 250.257,-54 275.729,-54"/>
<polygon fill="#000000" stroke="#000000" points="275.848,-57.5001 285.848,-54 275.848,-50.5001 275.848,-57.5001"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_predictor~~CallsGraph_edge27" class="edge"><title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M474.571,-278.404C484.901,-274.549 496.561,-270.197 507.496,-266.116"/>
<polygon fill="#000000" stroke="#000000" points="508.724,-269.394 516.869,-262.618 506.276,-262.836 508.724,-269.394"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~end_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge31" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M190.932,-307.837C210.455,-296.802 240.602,-280.539 268,-269 312.811,-250.126 366.199,-233.41 401.805,-223.039"/>
<polygon fill="#000000" stroke="#000000" points="403.164,-226.29 411.804,-220.157 401.226,-219.563 403.164,-226.29"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_predictor~~CallsGraph_edge28" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M228.944,-307.971C244.755,-304.744 261.503,-301.326 276.1,-298.347"/>
<polygon fill="#000000" stroke="#000000" points="277.206,-301.693 286.304,-296.264 275.806,-294.835 277.206,-301.693"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~start_timer -->
<g id="proc~~pf_predictor~~CallsGraph_edge30" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M231.038,-320.879C270.376,-320.548 322.493,-318.431 368,-311 378.72,-309.25 390.097,-306.472 400.617,-303.503"/>
<polygon fill="#000000" stroke="#000000" points="401.786,-306.807 410.39,-300.625 399.809,-300.092 401.786,-306.807"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_node16" class="node"><title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_predictor~~CallsGraph_node16"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="481,-534 404,-534 404,-510 481,-510 481,-534"/>
<text text-anchor="middle" x="442.5" y="-519.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge29" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M186.17,-332.031C231.899,-366.054 362.36,-463.119 416.981,-503.757"/>
<polygon fill="#000000" stroke="#000000" points="414.959,-506.615 425.071,-509.777 419.137,-500.999 414.959,-506.615"/>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge32" class="edge"><title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M354.104,-551.964C367.431,-547.395 382.791,-542.129 396.88,-537.298"/>
<polygon fill="#000000" stroke="#000000" points="398.067,-540.591 406.391,-534.037 395.797,-533.97 398.067,-540.591"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_predictor~~CallsGraph_edge33" class="edge"><title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M347.721,-522C361.281,-522 377.838,-522 393.244,-522"/>
<polygon fill="#000000" stroke="#000000" points="393.676,-525.5 403.676,-522 393.676,-518.5 393.676,-525.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_predictor~~CalledByGraph Pages: 1 -->
<svg id="procpf_predictorCalledByGraph" width="302pt" height="32pt"
 viewBox="0.00 0.00 302.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_predictor~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_predictor~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 298,-28 298,4 -4,4"/>
<!-- proc~pf_predictor -->
<g id="proc~~pf_predictor~~CalledByGraph_node1" class="node"><title>proc~pf_predictor</title>
<polygon fill="none" stroke="black" points="294,-24 224,-24 224,-0 294,-0 294,-24"/>
<text text-anchor="middle" x="259" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_predictor</text>
</g>
<!-- proc~pf_block_run -->
<g id="proc~~pf_predictor~~CalledByGraph_node2" class="node"><title>proc~pf_block_run</title>
<g id="a_proc~~pf_predictor~~CalledByGraph_node2"><a xlink:href=".././proc/pf_block_run.html" xlink:title="pf_block_run">
<polygon fill="#d9534f" stroke="#d9534f" points="188,-24 114,-24 114,-0 188,-0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_block_run</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_predictor~~CalledByGraph_edge1" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M188.183,-12C196.369,-12 205.153,-12 213.634,-12"/>
<polygon fill="#000000" stroke="#000000" points="213.768,-15.5001 223.768,-12 213.768,-8.5001 213.768,-15.5001"/>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_predictor~~CalledByGraph_node3" class="node"><title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_predictor~~CalledByGraph_node3"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,-0 78,-0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_predictor~~CalledByGraph_edge2" class="edge"><title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.164,-12C86.3694,-12 95.1281,-12 103.607,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.755,-15.5001 113.754,-12 103.754,-8.5001 103.755,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_predictor.html#src">pf_predictor</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">pf</span>     <span class="c">!! PFASST main data structure</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>         <span class="kd">::</span> <span class="n">t0</span>     <span class="c">!! Initial time of this processor</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>         <span class="kd">::</span> <span class="n">dt</span>     <span class="c">!! time step</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>  <span class="c">!!  User defined flags</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c_lev_p</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">f_lev_p</span>     <span class="c">!!</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">k</span>               <span class="c">!!  Loop indices</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index</span>     <span class="c">!!  Local variable for looping over levels</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">t0k</span>             <span class="c">!!  Initial time at time step k</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>          

    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_PREDICTOR</span><span class="p">)</span>
    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TPREDICTOR</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;beginning predictor&#39;</span>
    <span class="c">!!</span>
    <span class="c">!! Step 1. Getting the  initial condition on the finest level at each processor</span>
    <span class="c">!!         If we are doing multiple levels, then we need to coarsen to fine level</span>
    <span class="n">f_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">q0_style</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  Spread q0 to all the nodes</span>
       <span class="k">call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">spreadq0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="c">!!</span>
    <span class="c">!!  Step 2:   Proceed fine to coarse levels coarsening the fine solution and computing tau correction</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do coarsen  in predictor&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       do </span><span class="n">level_index</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
          <span class="n">f_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
          <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
          <span class="k">call </span><span class="n">pf_residual</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
          <span class="k">call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">restrict</span><span class="p">(</span><span class="n">f_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
          <span class="k">call </span><span class="n">restrict_time_space_fas</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">)</span>  <span class="c">!  Restrict</span>
          <span class="k">call save</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">c_lev_p</span><span class="p">)</span>
       <span class="k">end do</span>  <span class="c">!  level_index = pf%state%finest_level, 2, -1</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">level_index</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">end if</span>

    <span class="c">!!</span>
    <span class="c">!! Step 3. Do the &quot;Burn in&quot; step on the coarse level to make the coarse values consistent</span>
    <span class="c">!!         (this is skipped if the fine initial conditions are already consistent)</span>
    <span class="c">!! The first processor does nothing, the second does one set of sweeps, the third two, etc</span>
    <span class="c">!! Hence, this is skipped completely if nprocs=1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do burnin  in predictor&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">q0_style</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  The coarse level needs burn in</span>
       <span class="c">!! If RK_pred is true, just do some RK_steps</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">RK_pred</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!  Use Runge-Kutta to get the coarse initial data</span>
          <span class="c">!  Get new initial conditions</span>
          <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="mi">100000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

          <span class="c">!  Do a RK_step</span>
          <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
          <span class="c">!  Send forward</span>
          <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span>  <span class="mi">100000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       <span class="k">else</span>  <span class="c">!  Normal PFASST burn in</span>
          <span class="n">level_index</span><span class="o">=</span><span class="mi">1</span>
          <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">)</span>
          <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>
             <span class="n">t0k</span> <span class="o">=</span> <span class="n">t0</span><span class="o">-</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>   <span class="c">! Remember t0=pf%rank*dt is the beginning of this time slice so t0-(pf%rank)*dt is 0</span>
                                                <span class="c">! and we iterate up to the correct time step.</span>
                                                <span class="c">! for optimal control problem t, t0k has no influence on f_eval, so there this does something else</span>

             <span class="c">! Get new initial value (skip on first iteration)</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="c">! If we are doing PFASST_pred, we use the old values at nodes, otherwise spread q0</span>
                <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">PFASST_pred</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">spreadq0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">level_index</span><span class="p">,</span> <span class="n">t0k</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">             end if</span>
             <span class="c">!  Do some sweeps</span>
             <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0k</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">nsweeps_burn</span><span class="p">)</span>
          <span class="k">end do</span>
<span class="k">       </span><span class="n">endif</span>  <span class="c">!  RK_pred</span>
    <span class="k">end if</span>  <span class="c">! (q0_style .eq. 0)</span>

    <span class="c">!!</span>
    <span class="c">!! Step 4: Now we have everyone burned in, so do some coarse sweeps</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">       if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;do sweeps  in predictor&#39;</span><span class="p">,</span> <span class="s1">&#39;Pipeline_pred&#39;</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">Pipeline_pred</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">Pipeline_pred</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">nsweeps_pred</span>
             <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=-</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span><span class="n">k</span>

             <span class="c">!  Get new initial conditions</span>
             <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

             <span class="c">!  Do a sweep</span>
             <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
             <span class="c">!  Send forward</span>
             <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span>  <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
          <span class="k">end do</span> <span class="c">! k = 1, c_lev_p%nsweeps_pred-1</span>
       <span class="k">else</span>  <span class="c">!  Don&#39;t pipeline</span>
          <span class="c">!  Get new initial conditions</span>
          <span class="k">call </span><span class="n">pf_recv</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>

          <span class="c">!  Do a sweeps</span>
          <span class="k">call </span><span class="n">c_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">nsweeps_pred</span><span class="p">)</span>
          <span class="c">!  Send forward</span>
          <span class="k">call </span><span class="n">pf_send</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span>  <span class="n">c_lev_p</span><span class="p">%</span><span class="nb">index</span><span class="o">*</span><span class="mi">110000</span><span class="o">+</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.)</span>
       <span class="n">endif</span>  <span class="c">! (Pipeline_pred .eq. .true) then</span>
    <span class="k">end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;returning to fine level in predictor&#39;</span>
    <span class="c">!!</span>
    <span class="c">!!  Step 5:  Return to fine level sweeping on any level in between coarsest and finest</span>
    <span class="k">do </span><span class="n">level_index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>  <span class="c">!  Will do nothing with one level</span>
       <span class="n">f_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="p">);</span>
       <span class="n">c_lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">level_index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">call </span><span class="n">interpolate_time_space</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">%</span><span class="n">Finterp</span><span class="p">)</span>
       <span class="k">call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">Q</span><span class="p">(</span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">nnodes</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
       <span class="k">call </span><span class="n">interpolate_q0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">,</span> <span class="n">c_lev_p</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

       <span class="c">!  Do a sweep on level unless we are at the finest level</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">level_index</span> <span class="o">&lt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          call </span><span class="n">f_lev_p</span><span class="p">%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">level_index</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_lev_p</span><span class="p">%</span><span class="n">nsweeps_pred</span><span class="p">)</span>
       <span class="k">end if</span>
<span class="k">    end do</span>

<span class="k">    call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TPREDICTOR</span><span class="p">)</span>
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_PREDICTOR</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_ITERATING</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="s1">&#39;ending predictor&#39;</span>
  <span class="k">end subroutine </span><span class="n">pf_predictor</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tommaso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>