<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_parareal_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_parareal_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">38 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parareal.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parareal.f90.html'>pf_parareal.f90</a></li>
    
     <li><a href='../module/pf_mod_parareal.html'>pf_mod_parareal</a></li>
    
  
     <li class="active">pf_parareal_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_run.html#src">pf_parareal_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_parareal_run(pf, q0, dt, tend, nsteps, qend)
    
    
   
</h2>
    
  


    
    <p>Do the parareal algorithm
  Set the number of time steps to do
  The user can either pass in the number of time steps or
  pass in the time step size and length of run
  Allocate stuff for holding results </p>
<p>Try to sync everyone</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E78"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td><p>The complete PFASST structure</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E5"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td><p>The initial condition</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E47"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td><p>The time step for each processor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tend%7E2"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tend</strong></td><td><p>The final time of run</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E7"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td><p>The number of time steps</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E4"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td><p>The computed solution at tend</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_parareal_run~~CallsGraph Pages: 1 -->
<svg id="procpf_parareal_runCallsGraph" width="641pt" height="348pt"
 viewBox="0.00 0.00 641.00 347.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_parareal_run~~CallsGraph" class="graph" transform="scale(.925 .925) rotate(0) translate(4 372.1774)">
<title>proc~~pf_parareal_run~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-372.1774 689,-372.1774 689,4 -4,4"/>
<!-- proc~pf_parareal_run -->
<g id="proc~~pf_parareal_run~~CallsGraph_node1" class="node">
<title>proc~pf_parareal_run</title>
<polygon fill="none" stroke="#000000" points="89,-168 0,-168 0,-144 89,-144 89,-168"/>
<text text-anchor="middle" x="44.5" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_parareal_run</text>
</g>
<!-- pf_stop -->
<g id="proc~~pf_parareal_run~~CallsGraph_node2" class="node">
<title>pf_stop</title>
<polygon fill="#777777" stroke="#777777" points="672.5,-271 618.5,-271 618.5,-247 672.5,-247 672.5,-271"/>
<text text-anchor="middle" x="645.5" y="-256.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop</text>
</g>
<!-- proc~pf_parareal_run&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge1" class="edge">
<title>proc~pf_parareal_run&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M54.4254,-168.0669C84.2196,-203.2098 177.2556,-305.2504 281,-341 402.672,-382.9274 452.3789,-375.2232 570,-323 592.9243,-312.8217 614.2525,-293.4431 628.3517,-278.6651"/>
<polygon fill="#000000" stroke="#000000" points="631.1991,-280.7403 635.4051,-271.0161 626.053,-275.9949 631.1991,-280.7403"/>
</g>
<!-- proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_run~~CallsGraph_node3" class="node">
<title>proc~pf_parareal_block_run</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node3"><a xlink:href=".././proc/pf_parareal_block_run.html" xlink:title="pf_parareal_block_run">
<polygon fill="#d9534f" stroke="#d9534f" points="245,-210 125,-210 125,-186 245,-186 245,-210"/>
<text text-anchor="middle" x="185" y="-195.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_block_run</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge2" class="edge">
<title>proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run</title>
<path fill="none" stroke="#000000" d="M84.7617,-168.0355C100.3409,-172.6926 118.3424,-178.0739 134.7547,-182.9801"/>
<polygon fill="#000000" stroke="#000000" points="134.1489,-186.4519 144.7325,-185.9627 136.1538,-179.7452 134.1489,-186.4519"/>
</g>
<!-- proc~initialize_results -->
<g id="proc~~pf_parareal_run~~CallsGraph_node4" class="node">
<title>proc~initialize_results</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node4"><a xlink:href=".././proc/initialize_results.html" xlink:title="initialize_results">
<polygon fill="#d9534f" stroke="#d9534f" points="229,-168 141,-168 141,-144 229,-144 229,-168"/>
<text text-anchor="middle" x="185" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">initialize_results</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_run&#45;&gt;proc~initialize_results -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge3" class="edge">
<title>proc~pf_parareal_run&#45;&gt;proc~initialize_results</title>
<path fill="none" stroke="#000000" d="M89.3414,-156C102.3966,-156 116.805,-156 130.391,-156"/>
<polygon fill="#000000" stroke="#000000" points="130.5841,-159.5001 140.5841,-156 130.5841,-152.5001 130.5841,-159.5001"/>
</g>
<!-- proc~dump_results -->
<g id="proc~~pf_parareal_run~~CallsGraph_node5" class="node">
<title>proc~dump_results</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node5"><a xlink:href=".././proc/dump_results.html" xlink:title="dump_results">
<polygon fill="#d9534f" stroke="#d9534f" points="223.5,-126 146.5,-126 146.5,-102 223.5,-102 223.5,-126"/>
<text text-anchor="middle" x="185" y="-111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dump_results</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_run&#45;&gt;proc~dump_results -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge4" class="edge">
<title>proc~pf_parareal_run&#45;&gt;proc~dump_results</title>
<path fill="none" stroke="#000000" d="M84.7617,-143.9645C100.8945,-139.1418 119.625,-133.5427 136.4984,-128.4987"/>
<polygon fill="#000000" stroke="#000000" points="137.6063,-131.8206 146.1849,-125.6031 135.6014,-125.1139 137.6063,-131.8206"/>
</g>
<!-- mpi_barrier -->
<g id="proc~~pf_parareal_run~~CallsGraph_node6" class="node">
<title>mpi_barrier</title>
<polygon fill="#777777" stroke="#777777" points="218.5,-84 151.5,-84 151.5,-60 218.5,-60 218.5,-84"/>
<text text-anchor="middle" x="185" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_barrier</text>
</g>
<!-- proc~pf_parareal_run&#45;&gt;mpi_barrier -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge5" class="edge">
<title>proc~pf_parareal_run&#45;&gt;mpi_barrier</title>
<path fill="none" stroke="#000000" d="M57.2236,-143.8554C72.3468,-129.9654 98.8404,-107.3033 125,-93 130.2729,-90.1169 136.0173,-87.5103 141.794,-85.1928"/>
<polygon fill="#000000" stroke="#000000" points="143.3325,-88.354 151.4688,-81.568 140.8765,-81.799 143.3325,-88.354"/>
</g>
<!-- proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_run~~CallsGraph_node7" class="node">
<title>proc~pf_parareal_v_cycle</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node7"><a xlink:href=".././proc/pf_parareal_v_cycle.html" xlink:title="pf_parareal_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="412.5,-210 303.5,-210 303.5,-186 412.5,-186 412.5,-210"/>
<text text-anchor="middle" x="358" y="-195.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge7" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle</title>
<path fill="none" stroke="#000000" d="M245.0215,-198C260.5522,-198 277.3432,-198 293.1106,-198"/>
<polygon fill="#000000" stroke="#000000" points="293.3007,-201.5001 303.3007,-198 293.3007,-194.5001 293.3007,-201.5001"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_parareal_run~~CallsGraph_node8" class="node">
<title>proc~pf_set_resid</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node8"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="556,-292 485,-292 485,-268 556,-268 556,-292"/>
<text text-anchor="middle" x="520.5" y="-277.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge6" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M198.4412,-210.0492C216.002,-224.9834 248.3728,-249.8258 281,-261 345.6542,-283.1429 425.6542,-284.7248 474.8724,-282.9944"/>
<polygon fill="#000000" stroke="#000000" points="475.0441,-286.4904 484.8913,-282.5811 474.7555,-279.4963 475.0441,-286.4904"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_parareal_run~~CallsGraph_node9" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node9"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-108 489,-108 489,-84 552,-84 552,-108"/>
<text text-anchor="middle" x="520.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge8" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M223.2581,-185.9753C230.5882,-183.2905 238.1188,-180.2615 245,-177 261.9442,-168.9689 263.6931,-162.2163 281,-155 347.6046,-127.2284 430.2991,-110.4537 479.0411,-102.2318"/>
<polygon fill="#000000" stroke="#000000" points="479.6106,-105.6852 488.9087,-100.6062 478.4728,-98.7783 479.6106,-105.6852"/>
</g>
<!-- proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_run~~CallsGraph_node10" class="node">
<title>proc~pf_parareal_predictor</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node10"><a xlink:href=".././proc/pf_parareal_predictor.html" xlink:title="pf_parareal_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="415.5,-92 300.5,-92 300.5,-68 415.5,-68 415.5,-92"/>
<text text-anchor="middle" x="358" y="-77.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge9" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor</title>
<path fill="none" stroke="#000000" d="M231.5692,-185.8487C236.4138,-183.4086 241.0142,-180.4895 245,-177 271.6199,-153.6948 254.2519,-129.158 281,-106 285.2002,-102.3636 289.9299,-99.2307 294.9269,-96.5324"/>
<polygon fill="#000000" stroke="#000000" points="296.6354,-99.5953 304.1536,-92.1302 293.621,-93.2776 296.6354,-99.5953"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_parareal_run~~CallsGraph_node11" class="node">
<title>proc~pf_broadcast</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="395.5,-332 320.5,-332 320.5,-308 395.5,-308 395.5,-332"/>
<text text-anchor="middle" x="358" y="-317.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge10" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M194.0013,-210.0968C209.5888,-230.2453 243.5516,-270.7548 281,-294 290.0846,-299.639 300.538,-304.2178 310.7539,-307.87"/>
<polygon fill="#000000" stroke="#000000" points="309.8297,-311.2512 320.4233,-311.092 312.0426,-304.6101 309.8297,-311.2512"/>
</g>
<!-- proc~pf_set_delta_q0 -->
<g id="proc~~pf_parareal_run~~CallsGraph_node12" class="node">
<title>proc~pf_set_delta_q0</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node12"><a xlink:href=".././proc/pf_set_delta_q0.html" xlink:title="pf_set_delta_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="565,-166 476,-166 476,-142 565,-142 565,-166"/>
<text text-anchor="middle" x="520.5" y="-151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_delta_q0</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_set_delta_q0 -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge11" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_set_delta_q0</title>
<path fill="none" stroke="#000000" d="M234.6123,-185.9622C249.4621,-182.6805 265.8307,-179.3788 281,-177 343.9908,-167.1221 417.0123,-160.8467 465.7078,-157.3896"/>
<polygon fill="#000000" stroke="#000000" points="465.9839,-160.8789 475.7173,-156.6944 465.4988,-153.8957 465.9839,-160.8789"/>
</g>
<!-- proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_run~~CallsGraph_node13" class="node">
<title>proc~pf_check_convergence_block~2</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node13"><a xlink:href=".././proc/pf_check_convergence_block%7E2.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="435,-50 281,-50 281,-26 435,-26 435,-50"/>
<text text-anchor="middle" x="358" y="-35.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge12" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2</title>
<path fill="none" stroke="#000000" d="M233.3723,-185.854C237.657,-183.4215 241.6367,-180.5026 245,-177 282.9771,-137.4505 241.6542,-97.188 281,-59 282.1186,-57.9143 283.2876,-56.8835 284.5004,-55.9048"/>
<polygon fill="#000000" stroke="#000000" points="286.7036,-58.642 293.0705,-50.1736 282.8123,-52.8232 286.7036,-58.642"/>
</g>
<!-- proc~pf_set_iter -->
<g id="proc~~pf_parareal_run~~CallsGraph_node14" class="node">
<title>proc~pf_set_iter</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_set_iter.html" xlink:title="pf_set_iter">
<polygon fill="#d9534f" stroke="#d9534f" points="389.5,-252 326.5,-252 326.5,-228 389.5,-228 389.5,-252"/>
<text text-anchor="middle" x="358" y="-237.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_iter</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_set_iter -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge13" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_set_iter</title>
<path fill="none" stroke="#000000" d="M234.5749,-210.0355C260.5504,-216.3417 291.995,-223.9757 316.6444,-229.9599"/>
<polygon fill="#000000" stroke="#000000" points="315.8703,-233.3736 326.4138,-232.3317 317.5218,-226.5712 315.8703,-233.3736"/>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge16" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M412.6539,-208.69C420.463,-211.4018 428.1575,-214.7849 435,-219 455.3638,-231.5445 451.5285,-245.1108 471,-259 473.0614,-260.4705 475.2418,-261.8651 477.4926,-263.1834"/>
<polygon fill="#000000" stroke="#000000" points="475.9432,-266.3231 486.4217,-267.8892 479.2069,-260.1305 475.9432,-266.3231"/>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_delta_q0 -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge15" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_delta_q0</title>
<path fill="none" stroke="#000000" d="M402.4038,-185.9768C422.198,-180.6172 445.6937,-174.2552 466.495,-168.6229"/>
<polygon fill="#000000" stroke="#000000" points="467.4122,-172.0007 476.1498,-166.0087 465.5826,-165.244 467.4122,-172.0007"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_parareal_run~~CallsGraph_node15" class="node">
<title>proc~pf_send</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node15"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="547.5,-250 493.5,-250 493.5,-226 547.5,-226 547.5,-250"/>
<text text-anchor="middle" x="520.5" y="-235.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge14" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M406.7554,-210.0013C431.2388,-216.028 460.4352,-223.2148 483.1175,-228.7982"/>
<polygon fill="#000000" stroke="#000000" points="482.4936,-232.249 493.0404,-231.2407 484.1668,-225.4519 482.4936,-232.249"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_parareal_run~~CallsGraph_node17" class="node">
<title>proc~pf_recv</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node17"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="547.5,-208 493.5,-208 493.5,-184 547.5,-184 547.5,-208"/>
<text text-anchor="middle" x="520.5" y="-193.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge17" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M412.5622,-197.3285C435.752,-197.0431 462.2046,-196.7175 483.1188,-196.4601"/>
<polygon fill="#000000" stroke="#000000" points="483.2463,-199.9589 493.2024,-196.336 483.16,-192.9594 483.2463,-199.9589"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge18" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M415.749,-85.6861C436.5312,-87.7323 459.5577,-89.9995 478.7171,-91.886"/>
<polygon fill="#000000" stroke="#000000" points="478.6296,-95.3942 488.9244,-92.891 479.3155,-88.4279 478.6296,-95.3942"/>
</g>
<!-- proc~pf_broadcast&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge19" class="edge">
<title>proc~pf_broadcast&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M395.6672,-321.2885C438.7718,-321.7053 511.0177,-319.1499 570,-301 587.7575,-295.5357 606.0066,-285.5264 620.1144,-276.6496"/>
<polygon fill="#000000" stroke="#000000" points="622.2659,-279.4254 628.7403,-271.0389 618.4492,-273.5575 622.2659,-279.4254"/>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge20" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M406.817,-50.1095C416.2484,-52.7869 425.9936,-55.7914 435,-59 451.4937,-64.876 454.9401,-68.0251 471,-75 474.6992,-76.6066 478.5597,-78.269 482.4216,-79.9227"/>
<polygon fill="#000000" stroke="#000000" points="481.3617,-83.2756 491.9332,-83.9784 484.1074,-76.8365 481.3617,-83.2756"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_parareal_run~~CallsGraph_node16" class="node">
<title>proc~pf_send_status</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node16"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="563,-66 478,-66 478,-42 563,-42 563,-66"/>
<text text-anchor="middle" x="520.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge21" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M435.4426,-45.6251C446.3557,-46.6996 457.3604,-47.7832 467.6672,-48.798"/>
<polygon fill="#000000" stroke="#000000" points="467.4172,-52.2902 477.7121,-49.787 468.1032,-45.3239 467.4172,-52.2902"/>
</g>
<!-- proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_run~~CallsGraph_node18" class="node">
<title>proc~pf_check_residual~2</title>
<g id="a_proc~~pf_parareal_run~~CallsGraph_node18"><a xlink:href=".././proc/pf_check_residual%7E2.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="570,-24 471,-24 471,0 570,0 570,-24"/>
<text text-anchor="middle" x="520.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge22" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2</title>
<path fill="none" stroke="#000000" d="M433.0664,-25.9894C442.3712,-24.5006 451.7848,-22.9944 460.8152,-21.5496"/>
<polygon fill="#000000" stroke="#000000" points="461.5005,-24.9845 470.8219,-19.9485 460.3945,-18.0724 461.5005,-24.9845"/>
</g>
<!-- proc~pf_send&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge23" class="edge">
<title>proc~pf_send&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M547.6231,-242.5567C565.3957,-245.5425 588.8589,-249.4843 608.3572,-252.76"/>
<polygon fill="#000000" stroke="#000000" points="607.9881,-256.247 618.4298,-254.4522 609.1479,-249.3437 607.9881,-256.247"/>
</g>
<!-- proc~pf_send_status&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge24" class="edge">
<title>proc~pf_send_status&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M559.7594,-66.2374C563.6054,-68.6621 567.1358,-71.5541 570,-75 617.423,-132.0548 561.1151,-178.9276 606,-238 607.2334,-239.6233 608.6292,-241.1345 610.1411,-242.5395"/>
<polygon fill="#000000" stroke="#000000" points="608.3374,-245.5593 618.4538,-248.7071 612.5084,-239.9377 608.3374,-245.5593"/>
</g>
<!-- pf_start_timer -->
<g id="proc~~pf_parareal_run~~CallsGraph_node19" class="node">
<title>pf_start_timer</title>
<polygon fill="#777777" stroke="#777777" points="685,-187 606,-187 606,-163 685,-163 685,-187"/>
<text text-anchor="middle" x="645.5" y="-172.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_start_timer</text>
</g>
<!-- proc~pf_recv&#45;&gt;pf_start_timer -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge25" class="edge">
<title>proc~pf_recv&#45;&gt;pf_start_timer</title>
<path fill="none" stroke="#000000" d="M547.6231,-191.4433C561.6563,-189.0857 579.2373,-186.1321 595.613,-183.381"/>
<polygon fill="#000000" stroke="#000000" points="596.329,-186.8099 605.6109,-181.7014 595.1692,-179.9066 596.329,-186.8099"/>
</g>
<!-- pf_stop_timer -->
<g id="proc~~pf_parareal_run~~CallsGraph_node20" class="node">
<title>pf_stop_timer</title>
<polygon fill="#777777" stroke="#777777" points="684.5,-229 606.5,-229 606.5,-205 684.5,-205 684.5,-229"/>
<text text-anchor="middle" x="645.5" y="-214.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop_timer</text>
</g>
<!-- proc~pf_recv&#45;&gt;pf_stop_timer -->
<g id="proc~~pf_parareal_run~~CallsGraph_edge26" class="edge">
<title>proc~pf_recv&#45;&gt;pf_stop_timer</title>
<path fill="none" stroke="#000000" d="M547.6231,-200.5567C561.7752,-202.9342 579.5356,-205.918 596.0291,-208.6889"/>
<polygon fill="#000000" stroke="#000000" points="595.6496,-212.1741 606.0913,-210.3793 596.8094,-205.2708 595.6496,-212.1741"/>
</g>
</g>
</svg>
</div><script>var panprocpf_parareal_runCallsGraph = svgPanZoom('#procpf_parareal_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_run.html#src">pf_parareal_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_parareal_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">tend</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>   <span class="c">!!  The complete PFASST structure</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>   <span class="c">!!  The initial condition</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>   <span class="c">!!  The time step for each processor</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">tend</span> <span class="c">!!  The final time of run</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">nsteps</span>  <span class="c">!!  The number of time steps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>    <span class="c">!!  The computed solution at tend</span>

    <span class="c">!  Local variables</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nproc</span>  <span class="c">!!  Total number of processors</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nsteps_loc</span>  <span class="c">!!  local number of time steps</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tend_loc</span> <span class="c">!!  The final time of run</span>
    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ierr</span> 


    <span class="c">! make a local copy of nproc</span>
    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>

    <span class="c">!&gt;  Set the number of time steps to do</span>
    <span class="c">!!  The user can either pass in the number of time steps or</span>
    <span class="c">!!  pass in the time step size and length of run</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">nsteps</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      </span><span class="n">nsteps_loc</span> <span class="o">=</span> <span class="n">nsteps</span>
      <span class="n">tend_loc</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">nsteps_loc</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">pfdp</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">nsteps_loc</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span><span class="n">tend</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
      <span class="c">!  Do  sanity check on steps</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">nsteps_loc</span><span class="p">,</span><span class="n">pfdp</span><span class="p">)</span><span class="o">-</span><span class="n">tend</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">dt</span><span class="o">/</span><span class="mi">1</span><span class="n">d</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        print</span> <span class="o">*</span><span class="p">,</span><span class="s1">&#39;dt=&#39;</span><span class="p">,</span><span class="n">dt</span>
       <span class="k">print</span> <span class="o">*</span><span class="p">,</span><span class="s1">&#39;nsteps=&#39;</span><span class="p">,</span><span class="n">nsteps_loc</span>
        <span class="k">print</span> <span class="o">*</span><span class="p">,</span><span class="s1">&#39;tend=&#39;</span><span class="p">,</span><span class="n">tend</span>
       <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;Invalid nsteps ,nsteps=&#39;</span><span class="p">,</span><span class="n">nsteps</span><span class="p">)</span>
      <span class="k">end if</span>
<span class="k">    end if</span>
<span class="k">    </span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">nsteps</span> <span class="o">=</span> <span class="n">nsteps_loc</span>


    <span class="c">!  do sanity checks on Nproc</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nsteps</span><span class="p">,</span><span class="n">nproc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="k">call </span><span class="n">pf_stop</span><span class="p">(</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="s1">&#39;nsteps must be multiple of nproc ,nsteps=&#39;</span><span class="p">,</span><span class="n">nsteps</span><span class="p">)</span>

    <span class="c">!&gt;  Allocate stuff for holding results </span>
    <span class="k">call </span><span class="n">initialize_results</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
    
    <span class="c">!&gt;  Try to sync everyone</span>
    <span class="k">call </span><span class="n">mpi_barrier</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">comm</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_TOTAL</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">pf_parareal_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps_loc</span><span class="p">,</span><span class="n">qend</span><span class="o">=</span><span class="n">qend</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">       call </span><span class="n">pf_parareal_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span>  <span class="n">nsteps_loc</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_TOTAL</span><span class="p">)</span>

    <span class="k">call </span><span class="n">dump_results</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">results</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">dump_timingsl</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">results</span><span class="p">,</span><span class="n">pf</span><span class="p">)</span>

  <span class="k">end subroutine </span><span class="n">pf_parareal_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>