<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_parareal_block_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_parareal_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">65 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parareal.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parareal.f90.html'>pf_parareal.f90</a></li>
    
     <li><a href='../module/pf_mod_parareal.html'>pf_mod_parareal</a></li>
    
  
     <li class="active">pf_parareal_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_block_run.html#src">pf_parareal_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_parareal_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>parareal controller for block mode
  When starting a new block, broadcast new initial conditions to all procs
  For initial block, this is done when initial conditions are set
 Reset some flags
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the parareal iterations</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E74"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E7"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E41"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E7"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E6"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E84"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_parareal_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_parareal_block_runCallsGraph" width="641pt" height="395pt"
 viewBox="0.00 0.00 641.00 394.59" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_parareal_block_run~~CallsGraph" class="graph" transform="scale(.9816 .9816) rotate(0) translate(4 397.9724)">
<title>proc~~pf_parareal_block_run~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-397.9724 649,-397.9724 649,4 -4,4"/>
<!-- proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node1" class="node">
<title>proc~pf_parareal_block_run</title>
<polygon fill="none" stroke="#000000" points="120,-274 0,-274 0,-250 120,-250 120,-274"/>
<text text-anchor="middle" x="60" y="-259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_parareal_block_run</text>
</g>
<!-- proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node2" class="node">
<title>proc~pf_parareal_predictor</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_parareal_predictor.html" xlink:title="pf_parareal_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-353 175.5,-353 175.5,-329 290.5,-329 290.5,-353"/>
<text text-anchor="middle" x="233" y="-338.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge1" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor</title>
<path fill="none" stroke="#000000" d="M79.3325,-274.0218C98.3569,-285.5249 128.4738,-302.8709 156,-315 164.7204,-318.8425 174.199,-322.4673 183.4287,-325.7216"/>
<polygon fill="#000000" stroke="#000000" points="182.3201,-329.0415 192.9147,-328.9726 184.5895,-322.4196 182.3201,-329.0415"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node3" class="node">
<title>proc~end_timer</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node3"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="543.5,-332 482.5,-332 482.5,-308 543.5,-308 543.5,-332"/>
<text text-anchor="middle" x="513" y="-317.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge2" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M120.1317,-256.4309C197.1343,-251.2145 333.8964,-248.447 445,-281 460.4489,-285.5265 476.1394,-294.1966 488.5497,-302.2147"/>
<polygon fill="#000000" stroke="#000000" points="486.7052,-305.1921 496.9563,-307.8693 490.6122,-299.3838 486.7052,-305.1921"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node4" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node4"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="427,-314 364,-314 364,-290 427,-290 427,-314"/>
<text text-anchor="middle" x="395.5" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge3" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M120.1259,-271.1137C132.0049,-272.8168 144.3876,-274.5235 156,-276 225.1904,-284.7978 305.8682,-293.1665 353.7063,-297.9319"/>
<polygon fill="#000000" stroke="#000000" points="353.3923,-301.4178 363.6888,-298.9214 354.0829,-294.4519 353.3923,-301.4178"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node5" class="node">
<title>proc~start_timer</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node5"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="545,-383 481,-383 481,-359 545,-359 545,-383"/>
<text text-anchor="middle" x="513" y="-368.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge4" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M67.1219,-274.0196C80.9918,-296.1357 113.9837,-342.7714 156,-362 260.5648,-409.8535 401.0124,-393.0893 470.4569,-380.2216"/>
<polygon fill="#000000" stroke="#000000" points="471.4146,-383.6018 480.5758,-378.28 470.0954,-376.7272 471.4146,-383.6018"/>
</g>
<!-- proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node6" class="node">
<title>proc~pf_parareal_v_cycle</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node6"><a xlink:href=".././proc/pf_parareal_v_cycle.html" xlink:title="pf_parareal_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="287.5,-129 178.5,-129 178.5,-105 287.5,-105 287.5,-129"/>
<text text-anchor="middle" x="233" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge5" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle</title>
<path fill="none" stroke="#000000" d="M74.4523,-249.8868C104.5249,-224.6815 174.0351,-166.4215 210.2037,-136.1067"/>
<polygon fill="#000000" stroke="#000000" points="212.8063,-138.4922 218.2221,-129.3861 208.3098,-133.1273 212.8063,-138.4922"/>
</g>
<!-- proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node7" class="node">
<title>proc~pf_check_convergence_block~2</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node7"><a xlink:href=".././proc/pf_check_convergence_block%7E2.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="310,-234 156,-234 156,-210 310,-210 310,-234"/>
<text text-anchor="middle" x="233" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge6" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2</title>
<path fill="none" stroke="#000000" d="M111.9057,-249.9987C130.4669,-245.7071 151.5724,-240.8272 170.9062,-236.3569"/>
<polygon fill="#000000" stroke="#000000" points="171.8777,-239.7247 180.8322,-234.0619 170.3007,-232.9047 171.8777,-239.7247"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node8" class="node">
<title>proc~pf_broadcast</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node8"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-24 358,-24 358,0 433,0 433,-24"/>
<text text-anchor="middle" x="395.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge7" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M63.8004,-249.5984C73.7934,-219.0144 103.703,-139.33 156,-96 212.1438,-49.4828 295.7684,-28.0057 347.8928,-18.6328"/>
<polygon fill="#000000" stroke="#000000" points="348.6178,-22.0596 357.8802,-16.9158 347.4317,-15.1608 348.6178,-22.0596"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge8" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M290.6767,-336.6742C344.817,-332.6137 424.4322,-326.6426 472.2485,-323.0564"/>
<polygon fill="#000000" stroke="#000000" points="472.5276,-326.5454 482.2378,-322.3072 472.004,-319.565 472.5276,-326.5454"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge9" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M283.0813,-328.9805C305.7837,-323.5319 332.3127,-317.1649 353.8969,-311.9848"/>
<polygon fill="#000000" stroke="#000000" points="354.8378,-315.3584 363.7448,-309.6212 353.2041,-308.5517 354.8378,-315.3584"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge10" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M290.6767,-347.1796C344.2204,-352.9165 422.6807,-361.3229 470.6563,-366.4632"/>
<polygon fill="#000000" stroke="#000000" points="470.3867,-369.9542 480.7026,-367.5396 471.1324,-362.9941 470.3867,-369.9542"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node14" class="node">
<title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="645,-357 581,-357 581,-333 645,-333 645,-357"/>
<text text-anchor="middle" x="613" y="-342.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge11" class="edge">
<title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M543.5467,-327.6367C552.2359,-329.809 561.8538,-332.2135 571.093,-334.5233"/>
<polygon fill="#000000" stroke="#000000" points="570.3577,-337.9471 580.908,-336.977 572.0555,-331.1561 570.3577,-337.9471"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge12" class="edge">
<title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M427.2972,-306.8711C441.213,-309.0028 457.7047,-311.5292 472.4865,-313.7937"/>
<polygon fill="#000000" stroke="#000000" points="471.9796,-317.2568 482.3943,-315.3115 473.0396,-310.3375 471.9796,-317.2568"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge13" class="edge">
<title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M415.9669,-314.0189C434.6387,-324.9836 462.4482,-341.3143 483.5152,-353.6855"/>
<polygon fill="#000000" stroke="#000000" points="481.9779,-356.8416 492.3734,-358.8873 485.5226,-350.8054 481.9779,-356.8416"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge14" class="edge">
<title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M545.1911,-362.6303C553.3986,-360.4964 562.3426,-358.1709 570.9626,-355.9297"/>
<polygon fill="#000000" stroke="#000000" points="572.0718,-359.2578 580.8692,-353.354 570.3103,-352.483 572.0718,-359.2578"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node15" class="node">
<title>proc~pf_send</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node15"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="422.5,-108 368.5,-108 368.5,-84 422.5,-84 422.5,-108"/>
<text text-anchor="middle" x="395.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge15" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M287.5622,-109.9489C310.752,-106.9521 337.2046,-103.5336 358.1188,-100.8308"/>
<polygon fill="#000000" stroke="#000000" points="358.7335,-104.2806 368.2024,-99.5277 357.8363,-97.3383 358.7335,-104.2806"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node16" class="node">
<title>proc~pf_recv</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node16"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="422.5,-66 368.5,-66 368.5,-42 422.5,-42 422.5,-66"/>
<text text-anchor="middle" x="395.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge16" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M264.3316,-104.853C291.3093,-94.3939 330.2747,-79.2874 358.7248,-68.2574"/>
<polygon fill="#000000" stroke="#000000" points="360.254,-71.4185 368.3126,-64.5403 357.7236,-64.8918 360.254,-71.4185"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node17" class="node">
<title>proc~pf_set_resid</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node17"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="431,-150 360,-150 360,-126 431,-126 431,-150"/>
<text text-anchor="middle" x="395.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge17" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M287.5622,-124.0511C307.7266,-126.657 330.358,-129.5816 349.67,-132.0773"/>
<polygon fill="#000000" stroke="#000000" points="349.361,-135.5664 359.7271,-133.377 350.2582,-128.6242 349.361,-135.5664"/>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge19" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M257.6803,-234.1503C285.5205,-247.8562 330.9521,-270.2226 361.9863,-285.5009"/>
<polygon fill="#000000" stroke="#000000" points="360.6023,-288.7207 371.1199,-289.9975 363.6941,-282.4405 360.6023,-288.7207"/>
</g>
<!-- proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node10" class="node">
<title>proc~pf_check_residual~2</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node10"><a xlink:href=".././proc/pf_check_residual%7E2.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="445,-192 346,-192 346,-168 445,-168 445,-192"/>
<text text-anchor="middle" x="395.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge20" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2</title>
<path fill="none" stroke="#000000" d="M279.566,-209.9645C298.0946,-205.1756 319.5857,-199.6209 338.9943,-194.6045"/>
<polygon fill="#000000" stroke="#000000" points="340.1212,-197.9284 348.9272,-192.0373 338.3695,-191.1511 340.1212,-197.9284"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node11" class="node">
<title>proc~pf_send_status</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="438,-234 353,-234 353,-210 438,-210 438,-234"/>
<text text-anchor="middle" x="395.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge18" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M310.4426,-222C321.3557,-222 332.3604,-222 342.6672,-222"/>
<polygon fill="#000000" stroke="#000000" points="342.7121,-225.5001 352.7121,-222 342.712,-218.5001 342.7121,-225.5001"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node9" class="node">
<title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="545,-66 481,-66 481,-42 545,-42 545,-66"/>
<text text-anchor="middle" x="513" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge23" class="edge">
<title>proc~pf_broadcast&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M429.1708,-24.0355C442.2675,-28.7169 457.4111,-34.1299 471.1941,-39.0566"/>
<polygon fill="#000000" stroke="#000000" points="470.3465,-42.4705 480.9411,-42.5407 472.7027,-35.8789 470.3465,-42.4705"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node12" class="node">
<title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="543.5,-24 482.5,-24 482.5,0 543.5,0 543.5,-24"/>
<text text-anchor="middle" x="513" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge21" class="edge">
<title>proc~pf_broadcast&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M433.0008,-12C445.3839,-12 459.2226,-12 471.8627,-12"/>
<polygon fill="#000000" stroke="#000000" points="472.1403,-15.5001 482.1403,-12 472.1402,-8.5001 472.1403,-15.5001"/>
</g>
<!-- pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node13" class="node">
<title>pf_stop</title>
<polygon fill="#777777" stroke="#777777" points="540,-108 486,-108 486,-84 540,-84 540,-108"/>
<text text-anchor="middle" x="513" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge22" class="edge">
<title>proc~pf_broadcast&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M429.6489,-24.0131C435.0173,-26.5882 440.3291,-29.5822 445,-33 464.8411,-47.5181 462.5403,-58.7617 481,-75 482.1226,-75.9875 483.2951,-76.9637 484.5,-77.9228"/>
<polygon fill="#000000" stroke="#000000" points="482.5993,-80.8689 492.7373,-83.9464 486.7312,-75.2184 482.5993,-80.8689"/>
</g>
<!-- proc~pf_send_status&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge24" class="edge">
<title>proc~pf_send_status&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M431.0886,-209.9951C436.0461,-207.4649 440.8542,-204.4825 445,-201 472.5232,-177.8803 492.8809,-140.767 503.834,-117.4179"/>
<polygon fill="#000000" stroke="#000000" points="507.1405,-118.6002 508.0715,-108.0463 500.7623,-115.7161 507.1405,-118.6002"/>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge27" class="edge">
<title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M422.7522,-86.2588C437.1246,-81.1214 455.0676,-74.7077 471.1603,-68.9555"/>
<polygon fill="#000000" stroke="#000000" points="472.6542,-72.1384 480.8926,-65.4767 470.298,-65.5469 472.6542,-72.1384"/>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge25" class="edge">
<title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M422.6515,-87.1132C430.2693,-83.9392 438.295,-79.9062 445,-75 464.8411,-60.4819 462.5403,-49.2383 481,-33 482.1226,-32.0125 483.2951,-31.0363 484.5,-30.0772"/>
<polygon fill="#000000" stroke="#000000" points="486.7312,-32.7816 492.7373,-24.0536 482.5993,-27.1311 486.7312,-32.7816"/>
</g>
<!-- proc~pf_send&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge26" class="edge">
<title>proc~pf_send&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M422.7522,-96C438.472,-96 458.4633,-96 475.6331,-96"/>
<polygon fill="#000000" stroke="#000000" points="475.8956,-99.5001 485.8956,-96 475.8956,-92.5001 475.8956,-99.5001"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge30" class="edge">
<title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M422.7522,-54C436.989,-54 454.7294,-54 470.7043,-54"/>
<polygon fill="#000000" stroke="#000000" points="470.8926,-57.5001 480.8926,-54 470.8926,-50.5001 470.8926,-57.5001"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge28" class="edge">
<title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M422.7522,-44.2588C437.4614,-39.001 455.9107,-32.4064 472.2887,-26.5521"/>
<polygon fill="#000000" stroke="#000000" points="473.9282,-29.683 482.1666,-23.0213 471.572,-23.0915 473.9282,-29.683"/>
</g>
<!-- proc~pf_recv&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge29" class="edge">
<title>proc~pf_recv&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M422.7522,-63.7412C438.6203,-69.4132 458.8409,-76.641 476.1182,-82.8167"/>
<polygon fill="#000000" stroke="#000000" points="475.301,-86.2414 485.8956,-86.3116 477.6572,-79.6499 475.301,-86.2414"/>
</g>
</g>
</svg>
</div><script>var panprocpf_parareal_block_runCallsGraph = svgPanZoom('#procpf_parareal_block_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_parareal_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_parareal_block_runCalledByGraph" width="253pt" height="32pt"
 viewBox="0.00 0.00 253.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_parareal_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_parareal_block_run~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 249,-28 249,4 -4,4"/>
<!-- proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_node1" class="node">
<title>proc~pf_parareal_block_run</title>
<polygon fill="none" stroke="#000000" points="245,-24 125,-24 125,0 245,0 245,-24"/>
<text text-anchor="middle" x="185" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_parareal_block_run</text>
</g>
<!-- proc~pf_parareal_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_node2" class="node">
<title>proc~pf_parareal_run</title>
<g id="a_proc~~pf_parareal_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_parareal_run.html" xlink:title="pf_parareal_run">
<polygon fill="#d9534f" stroke="#d9534f" points="89,-24 0,-24 0,0 89,0 89,-24"/>
<text text-anchor="middle" x="44.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_run</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_edge1" class="edge">
<title>proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run</title>
<path fill="none" stroke="#000000" d="M89.3414,-12C97.4802,-12 106.1449,-12 114.8084,-12"/>
<polygon fill="#000000" stroke="#000000" points="114.9465,-15.5001 124.9465,-12 114.9465,-8.5001 114.9465,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_block_run.html#src">pf_parareal_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_parareal_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest level in V (Lambda)-cycle</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_max_depth</span> <span class="c">!!  Finest level in V-cycle</span>
    <span class="kt">integer</span><span class="kd">::</span>  <span class="n">nsteps_c</span><span class="p">,</span><span class="n">nsteps_f</span>  

    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c">! set finest level to visit in the following run</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k</span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>

       <span class="c">!&gt; Reset some flags</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pfblock</span> <span class="o">=</span> <span class="n">k</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">sweep</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c">!  Needed for compatibility of residual storage       </span>


       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_parareal_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">!&gt;  Start the parareal iterations</span>
       <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>

          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>

          <span class="c">!  Do a v_cycle</span>
          <span class="k">call </span><span class="n">pf_parareal_v_cycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

          <span class="c">!  Check for convergence</span>
          <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

          <span class="c">!  If we are converged, exit block</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">exit</span>
<span class="k">       end do</span>  <span class="c">!  Loop over the iteration in this bloc</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
       <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_STEP</span><span class="p">)</span>
    <span class="k">end do</span> <span class="c">!  Loop over the blocks</span>

    <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_parareal_block_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>