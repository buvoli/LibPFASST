<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_parareal_block_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_parareal_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">75 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parareal.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parareal.f90.html'>pf_parareal.f90</a></li>
    
     <li><a href='../module/pf_mod_parareal.html'>pf_mod_parareal</a></li>
    
  
     <li class="active">pf_parareal_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_block_run.html#src">pf_parareal_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_parareal_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>parareal controller for block mode
  For initial block, this is done when initial conditions are set
  When starting a new block, broadcast new initial conditions to all procs
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the parareal iterations</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E79"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E6"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E48"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E8"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E5"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E115"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_parareal_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_parareal_block_runCallsGraph" width="568pt" height="350pt"
 viewBox="0.00 0.00 568.00 350.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_parareal_block_run~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 346)">
<title>proc~~pf_parareal_block_run~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-346 564,-346 564,4 -4,4"/>
<!-- proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node1" class="node">
<title>proc~pf_parareal_block_run</title>
<polygon fill="none" stroke="#000000" points="120,-167 0,-167 0,-143 120,-143 120,-167"/>
<text text-anchor="middle" x="60" y="-152.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_parareal_block_run</text>
</g>
<!-- proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node2" class="node">
<title>proc~pf_parareal_v_cycle</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_parareal_v_cycle.html" xlink:title="pf_parareal_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="287.5,-268 178.5,-268 178.5,-244 287.5,-244 287.5,-268"/>
<text text-anchor="middle" x="233" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge2" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle</title>
<path fill="none" stroke="#000000" d="M72.6662,-167.2201C90.1462,-183.511 123.2339,-212.3364 156,-230 163.2404,-233.9032 171.1762,-237.3769 179.1152,-240.4145"/>
<polygon fill="#000000" stroke="#000000" points="178.16,-243.7909 188.7542,-243.9028 180.5421,-237.2087 178.16,-243.7909"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node3" class="node">
<title>proc~pf_set_resid</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node3"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="431,-342 360,-342 360,-318 431,-318 431,-342"/>
<text text-anchor="middle" x="395.5" y="-327.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge1" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M65.9771,-167.3325C78.7594,-192.3129 111.27,-248.8977 156,-277 215.8805,-314.6209 298.8508,-325.7356 349.7594,-328.9019"/>
<polygon fill="#000000" stroke="#000000" points="349.6311,-332.4 359.8067,-329.4492 350.0119,-325.4104 349.6311,-332.4"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node4" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node4"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="427,-127 364,-127 364,-103 427,-103 427,-127"/>
<text text-anchor="middle" x="395.5" y="-112.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge3" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M80.8855,-142.8417C99.7866,-132.5879 128.756,-118.6989 156,-113 224.0631,-98.7627 305.4032,-103.9796 353.6301,-109.3095"/>
<polygon fill="#000000" stroke="#000000" points="353.3561,-112.8011 363.6929,-110.477 354.1629,-105.8478 353.3561,-112.8011"/>
</g>
<!-- proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node5" class="node">
<title>proc~pf_parareal_predictor</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node5"><a xlink:href=".././proc/pf_parareal_predictor.html" xlink:title="pf_parareal_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-146 175.5,-146 175.5,-122 290.5,-122 290.5,-146"/>
<text text-anchor="middle" x="233" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge4" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor</title>
<path fill="none" stroke="#000000" d="M120.0215,-147.7142C134.6113,-145.9431 150.3134,-144.0371 165.2343,-142.2259"/>
<polygon fill="#000000" stroke="#000000" points="165.9107,-145.6696 175.416,-140.99 165.0671,-138.7206 165.9107,-145.6696"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node6" class="node">
<title>proc~pf_broadcast</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node6"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="270.5,-188 195.5,-188 195.5,-164 270.5,-164 270.5,-188"/>
<text text-anchor="middle" x="233" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge5" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M120.0215,-162.2858C141.2963,-164.8683 164.9361,-167.7379 185.0701,-170.1819"/>
<polygon fill="#000000" stroke="#000000" points="184.8993,-173.6868 195.2482,-171.4174 185.7429,-166.7378 184.8993,-173.6868"/>
</g>
<!-- proc~pf_set_delta_q0 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node7" class="node">
<title>proc~pf_set_delta_q0</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node7"><a xlink:href=".././proc/pf_set_delta_q0.html" xlink:title="pf_set_delta_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="440,-216 351,-216 351,-192 440,-192 440,-216"/>
<text text-anchor="middle" x="395.5" y="-201.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_delta_q0</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_set_delta_q0 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge6" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_set_delta_q0</title>
<path fill="none" stroke="#000000" d="M81.2998,-167.1643C100.2347,-177.2725 129.0197,-190.9436 156,-197 218.1434,-210.9497 291.623,-210.7171 340.6499,-208.2768"/>
<polygon fill="#000000" stroke="#000000" points="340.9332,-211.7667 350.7276,-207.7269 340.5518,-204.7771 340.9332,-211.7667"/>
</g>
<!-- proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node8" class="node">
<title>proc~pf_check_convergence_block~2</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node8"><a xlink:href=".././proc/pf_check_convergence_block%7E2.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="310,-66 156,-66 156,-42 310,-42 310,-66"/>
<text text-anchor="middle" x="233" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge7" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2</title>
<path fill="none" stroke="#000000" d="M72.6662,-142.7799C90.1462,-126.489 123.2339,-97.6636 156,-80 163.2404,-76.0968 171.1762,-72.6231 179.1152,-69.5855"/>
<polygon fill="#000000" stroke="#000000" points="180.5421,-72.7913 188.7542,-66.0972 178.16,-66.2091 180.5421,-72.7913"/>
</g>
<!-- proc~pf_set_iter -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node9" class="node">
<title>proc~pf_set_iter</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node9"><a xlink:href=".././proc/pf_set_iter.html" xlink:title="pf_set_iter">
<polygon fill="#d9534f" stroke="#d9534f" points="264.5,-24 201.5,-24 201.5,0 264.5,0 264.5,-24"/>
<text text-anchor="middle" x="233" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_iter</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_set_iter -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge8" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_set_iter</title>
<path fill="none" stroke="#000000" d="M66.0915,-142.8448C79.0847,-118.1913 111.9641,-62.1779 156,-33 166.4679,-26.064 179.174,-21.4071 191.2218,-18.2848"/>
<polygon fill="#000000" stroke="#000000" points="192.1629,-21.6598 201.1235,-16.0067 190.5934,-14.838 192.1629,-21.6598"/>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge11" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M258.0099,-268.058C280.8262,-278.98 315.529,-295.3963 346,-309 349.6361,-310.6233 353.4348,-312.2887 357.2409,-313.9371"/>
<polygon fill="#000000" stroke="#000000" points="356.0592,-317.2386 366.629,-317.9658 358.8197,-310.8059 356.0592,-317.2386"/>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_delta_q0 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge10" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_delta_q0</title>
<path fill="none" stroke="#000000" d="M270.6892,-243.9395C293.7823,-236.5497 323.5409,-227.0269 348.2077,-219.1335"/>
<polygon fill="#000000" stroke="#000000" points="349.2765,-222.4664 357.7341,-216.0851 347.1431,-215.7994 349.2765,-222.4664"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node13" class="node">
<title>proc~pf_send</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node13"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="422.5,-258 368.5,-258 368.5,-234 422.5,-234 422.5,-258"/>
<text text-anchor="middle" x="395.5" y="-243.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge9" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M287.5622,-252.6423C310.752,-251.2153 337.2046,-249.5874 358.1188,-248.3004"/>
<polygon fill="#000000" stroke="#000000" points="358.4363,-251.7876 368.2024,-247.6799 358.0063,-244.8008 358.4363,-251.7876"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node14" class="node">
<title>proc~pf_recv</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="422.5,-300 368.5,-300 368.5,-276 422.5,-276 422.5,-300"/>
<text text-anchor="middle" x="395.5" y="-285.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge12" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M287.5622,-266.7446C310.752,-271.3112 337.2046,-276.5203 358.1188,-280.6388"/>
<polygon fill="#000000" stroke="#000000" points="357.7146,-284.1263 368.2024,-282.6245 359.0671,-277.2582 357.7146,-284.1263"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge13" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M290.749,-127.2478C311.6274,-124.8066 334.771,-122.1006 353.9829,-119.8543"/>
<polygon fill="#000000" stroke="#000000" points="354.3986,-123.3296 363.9244,-118.6919 353.5856,-116.377 354.3986,-123.3296"/>
</g>
<!-- pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node10" class="node">
<title>pf_stop</title>
<polygon fill="#777777" stroke="#777777" points="547.5,-176 493.5,-176 493.5,-152 547.5,-152 547.5,-176"/>
<text text-anchor="middle" x="520.5" y="-161.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge14" class="edge">
<title>proc~pf_broadcast&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M270.5856,-174.4312C325.7805,-172.1274 428.1557,-167.8544 483.1919,-165.5572"/>
<polygon fill="#000000" stroke="#000000" points="483.3725,-169.0528 493.2178,-165.1387 483.0806,-162.0589 483.3725,-169.0528"/>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge15" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M270.3733,-66.0938C283.0167,-70.3245 297.1771,-75.2159 310,-80 325.7789,-85.8869 342.9976,-92.8327 357.8207,-98.9784"/>
<polygon fill="#000000" stroke="#000000" points="356.5998,-102.2614 367.1764,-102.8823 359.2955,-95.8012 356.5998,-102.2614"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node11" class="node">
<title>proc~pf_send_status</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="438,-85 353,-85 353,-61 438,-61 438,-85"/>
<text text-anchor="middle" x="395.5" y="-70.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge16" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M310.4426,-63.0548C321.3557,-64.3308 332.3604,-65.6175 342.6672,-66.8226"/>
<polygon fill="#000000" stroke="#000000" points="342.3732,-70.312 352.7121,-67.9971 343.1862,-63.3594 342.3732,-70.312"/>
</g>
<!-- proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node12" class="node">
<title>proc~pf_check_residual~2</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node12"><a xlink:href=".././proc/pf_check_residual%7E2.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="445,-43 346,-43 346,-19 445,-19 445,-43"/>
<text text-anchor="middle" x="395.5" y="-28.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge17" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2</title>
<path fill="none" stroke="#000000" d="M310.4426,-43.0389C319.0438,-41.8215 327.702,-40.596 336.0304,-39.4172"/>
<polygon fill="#000000" stroke="#000000" points="336.5891,-42.8731 345.9999,-38.0062 335.6081,-35.9422 336.5891,-42.8731"/>
</g>
<!-- proc~pf_send_status&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge18" class="edge">
<title>proc~pf_send_status&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M428.2786,-85.0001C434.0322,-87.635 439.8276,-90.6523 445,-94 467.1066,-108.308 488.7729,-129.3299 503.1846,-144.6002"/>
<polygon fill="#000000" stroke="#000000" points="500.6643,-147.0299 510.0237,-151.9952 505.8035,-142.2771 500.6643,-147.0299"/>
</g>
<!-- proc~pf_send&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge19" class="edge">
<title>proc~pf_send&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M422.6297,-236.0905C430.088,-232.9421 438.0357,-229.1784 445,-225 465.1171,-212.9303 485.6826,-195.9478 500.2592,-182.9654"/>
<polygon fill="#000000" stroke="#000000" points="502.6413,-185.5301 507.7003,-176.2211 497.9404,-180.3435 502.6413,-185.5301"/>
</g>
<!-- pf_start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node15" class="node">
<title>pf_start_timer</title>
<polygon fill="#777777" stroke="#777777" points="560,-279 481,-279 481,-255 560,-255 560,-279"/>
<text text-anchor="middle" x="520.5" y="-264.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_start_timer</text>
</g>
<!-- proc~pf_recv&#45;&gt;pf_start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge20" class="edge">
<title>proc~pf_recv&#45;&gt;pf_start_timer</title>
<path fill="none" stroke="#000000" d="M422.6231,-283.4433C436.6563,-281.0857 454.2373,-278.1321 470.613,-275.381"/>
<polygon fill="#000000" stroke="#000000" points="471.329,-278.8099 480.6109,-273.7014 470.1692,-271.9066 471.329,-278.8099"/>
</g>
<!-- pf_stop_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node16" class="node">
<title>pf_stop_timer</title>
<polygon fill="#777777" stroke="#777777" points="559.5,-321 481.5,-321 481.5,-297 559.5,-297 559.5,-321"/>
<text text-anchor="middle" x="520.5" y="-306.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop_timer</text>
</g>
<!-- proc~pf_recv&#45;&gt;pf_stop_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge21" class="edge">
<title>proc~pf_recv&#45;&gt;pf_stop_timer</title>
<path fill="none" stroke="#000000" d="M422.6231,-292.5567C436.7752,-294.9342 454.5356,-297.918 471.0291,-300.6889"/>
<polygon fill="#000000" stroke="#000000" points="470.6496,-304.1741 481.0913,-302.3793 471.8094,-297.2708 470.6496,-304.1741"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_parareal_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_parareal_block_runCalledByGraph" width="253pt" height="32pt"
 viewBox="0.00 0.00 253.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_parareal_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_parareal_block_run~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 249,-28 249,4 -4,4"/>
<!-- proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_node1" class="node">
<title>proc~pf_parareal_block_run</title>
<polygon fill="none" stroke="#000000" points="245,-24 125,-24 125,0 245,0 245,-24"/>
<text text-anchor="middle" x="185" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_parareal_block_run</text>
</g>
<!-- proc~pf_parareal_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_node2" class="node">
<title>proc~pf_parareal_run</title>
<g id="a_proc~~pf_parareal_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_parareal_run.html" xlink:title="pf_parareal_run">
<polygon fill="#d9534f" stroke="#d9534f" points="89,-24 0,-24 0,0 89,0 89,-24"/>
<text text-anchor="middle" x="44.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_run</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_edge1" class="edge">
<title>proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run</title>
<path fill="none" stroke="#000000" d="M89.3414,-12C97.4802,-12 106.1449,-12 114.8084,-12"/>
<polygon fill="#000000" stroke="#000000" points="114.9465,-15.5001 124.9465,-12 114.9465,-8.5001 114.9465,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_block_run.html#src">pf_parareal_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_parareal_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest level in V (Lambda)-cycle</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_max_depth</span> <span class="c">!!  Finest level in V-cycle</span>
    <span class="kt">integer</span><span class="kd">::</span>  <span class="n">nsteps_c</span><span class="p">,</span><span class="n">nsteps_f</span>  

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c">! set finest level to visit in the following run</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_BLOCK</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_BLOCK</span><span class="p">)</span>
       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k</span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pfblock</span> <span class="o">=</span> <span class="n">k</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">sweep</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c">!  Needed for compatibility of residual storage       </span>


       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
          <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_parareal_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
       <span class="c">! After the predictor, the residual and delta_q0 are just zero</span>
       <span class="k">call </span><span class="n">pf_set_delta_q0</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0_pfdp</span><span class="p">)</span>       
       <span class="k">call </span><span class="n">pf_set_resid</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">,</span><span class="mf">0.0_pfdp</span><span class="p">)</span>       
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>       <span class="c">!  This is the zero iteration</span>
       
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
          <span class="c">!&gt;  Start the parareal iterations</span>
          <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>
             <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_ITERATION</span><span class="p">)</span>
             
             <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>
             
             <span class="c">!  Do a v_cycle</span>
             <span class="k">call </span><span class="n">pf_parareal_v_cycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             
             <span class="c">!  Check for convergence</span>
             <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
             
             <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_ITERATION</span><span class="p">)</span>
             <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>
             
             <span class="c">!  If we are converged, exit block</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">                call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
                <span class="k">call </span><span class="n">pf_set_iter</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>                 
                <span class="k">exit</span>
<span class="k">             end if</span>
<span class="k">          end do</span>  <span class="c">!  Loop over j, the iterations in this block</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_BLOCK</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_BLOCK</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">    </span>
<span class="k">    </span>
<span class="k">    end do</span> <span class="c">!  Loop over the blocks</span>
    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ALL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_parareal_block_run</span> 
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>