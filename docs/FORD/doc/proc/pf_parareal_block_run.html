<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_parareal_block_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_parareal_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">65 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parareal.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parareal.f90.html'>pf_parareal.f90</a></li>
    
     <li><a href='../module/pf_mod_parareal.html'>pf_mod_parareal</a></li>
    
  
     <li class="active">pf_parareal_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_block_run.html#src">pf_parareal_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_parareal_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>parareal controller for block mode
  When starting a new block, broadcast new initial conditions to all procs
  For initial block, this is done when initial conditions are set
 Reset some flags
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the parareal iterations</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E74"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E7"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E41"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E7"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E6"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E84"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_parareal_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_parareal_block_runCallsGraph" width="641pt" height="395pt"
 viewBox="0.00 0.00 641.00 394.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_parareal_block_run~~CallsGraph" class="graph" transform="scale(.9816 .9816) rotate(0) translate(4 397.9225)">
<title>proc~~pf_parareal_block_run~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-397.9225 649,-397.9225 649,4 -4,4"/>
<!-- proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node1" class="node">
<title>proc~pf_parareal_block_run</title>
<polygon fill="none" stroke="#000000" points="120,-143.9225 0,-143.9225 0,-119.9225 120,-119.9225 120,-143.9225"/>
<text text-anchor="middle" x="60" y="-129.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_parareal_block_run</text>
</g>
<!-- proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node2" class="node">
<title>proc~pf_parareal_v_cycle</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_parareal_v_cycle.html" xlink:title="pf_parareal_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="287.5,-288.9225 178.5,-288.9225 178.5,-264.9225 287.5,-264.9225 287.5,-288.9225"/>
<text text-anchor="middle" x="233" y="-274.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge1" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_v_cycle</title>
<path fill="none" stroke="#000000" d="M74.4523,-144.0357C104.5249,-169.241 174.0351,-227.501 210.2037,-257.8158"/>
<polygon fill="#000000" stroke="#000000" points="208.3098,-260.7952 218.2221,-264.5364 212.8063,-255.4303 208.3098,-260.7952"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node3" class="node">
<title>proc~end_timer</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node3"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="543.5,-85.9225 482.5,-85.9225 482.5,-61.9225 543.5,-61.9225 543.5,-85.9225"/>
<text text-anchor="middle" x="513" y="-71.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge3" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M120.1317,-137.4916C197.1343,-142.708 333.8964,-145.4755 445,-112.9225 460.4489,-108.396 476.1394,-99.7259 488.5497,-91.7078"/>
<polygon fill="#000000" stroke="#000000" points="490.6122,-94.5387 496.9563,-86.0532 486.7052,-88.7304 490.6122,-94.5387"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node4" class="node">
<title>proc~start_timer</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node4"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="545,-34.9225 481,-34.9225 481,-10.9225 545,-10.9225 545,-34.9225"/>
<text text-anchor="middle" x="513" y="-20.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge2" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M67.0427,-119.6809C80.7805,-97.174 113.561,-49.8004 156,-30.9225 261.0615,15.8114 401.2861,-.975 470.57,-13.7699"/>
<polygon fill="#000000" stroke="#000000" points="470.1855,-17.2597 480.6648,-15.6997 471.4999,-10.3842 470.1855,-17.2597"/>
</g>
<!-- proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node5" class="node">
<title>proc~pf_check_convergence_block~2</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node5"><a xlink:href=".././proc/pf_check_convergence_block%7E2.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="310,-183.9225 156,-183.9225 156,-159.9225 310,-159.9225 310,-183.9225"/>
<text text-anchor="middle" x="233" y="-169.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge4" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_check_convergence_block~2</title>
<path fill="none" stroke="#000000" d="M111.9057,-143.9238C130.4669,-148.2154 151.5724,-153.0953 170.9062,-157.5656"/>
<polygon fill="#000000" stroke="#000000" points="170.3007,-161.0178 180.8322,-159.8606 171.8777,-154.1978 170.3007,-161.0178"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node6" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node6"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="427,-103.9225 364,-103.9225 364,-79.9225 427,-79.9225 427,-103.9225"/>
<text text-anchor="middle" x="395.5" y="-89.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge5" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M120.1259,-122.8088C132.0049,-121.1057 144.3876,-119.3991 156,-117.9225 225.1904,-109.1247 305.8682,-100.756 353.7063,-95.9906"/>
<polygon fill="#000000" stroke="#000000" points="354.0829,-99.4706 363.6888,-95.0011 353.3923,-92.5047 354.0829,-99.4706"/>
</g>
<!-- proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node7" class="node">
<title>proc~pf_parareal_predictor</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node7"><a xlink:href=".././proc/pf_parareal_predictor.html" xlink:title="pf_parareal_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-63.9225 175.5,-63.9225 175.5,-39.9225 290.5,-39.9225 290.5,-63.9225"/>
<text text-anchor="middle" x="233" y="-49.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge6" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_parareal_predictor</title>
<path fill="none" stroke="#000000" d="M79.7266,-119.7527C98.7925,-108.3009 128.7185,-91.1334 156,-78.9225 165.2126,-74.799 175.2617,-70.8794 184.968,-67.3695"/>
<polygon fill="#000000" stroke="#000000" points="186.2487,-70.6292 194.5164,-64.0038 183.9216,-64.0273 186.2487,-70.6292"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node8" class="node">
<title>proc~pf_broadcast</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node8"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="433,-393.9225 358,-393.9225 358,-369.9225 433,-369.9225 433,-393.9225"/>
<text text-anchor="middle" x="395.5" y="-379.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge7" class="edge">
<title>proc~pf_parareal_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M63.8004,-144.3241C73.7934,-174.9081 103.703,-254.5925 156,-297.9225 212.1438,-344.4397 295.7684,-365.9168 347.8928,-375.2897"/>
<polygon fill="#000000" stroke="#000000" points="347.4317,-378.7617 357.8802,-377.0067 348.6178,-371.8629 347.4317,-378.7617"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node11" class="node">
<title>proc~pf_send</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="422.5,-267.9225 368.5,-267.9225 368.5,-243.9225 422.5,-243.9225 422.5,-267.9225"/>
<text text-anchor="middle" x="395.5" y="-253.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge9" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M287.5622,-269.8714C310.752,-266.8746 337.2046,-263.4561 358.1188,-260.7533"/>
<polygon fill="#000000" stroke="#000000" points="358.7335,-264.2031 368.2024,-259.4502 357.8363,-257.2608 358.7335,-264.2031"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node14" class="node">
<title>proc~pf_recv</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="422.5,-351.9225 368.5,-351.9225 368.5,-327.9225 422.5,-327.9225 422.5,-351.9225"/>
<text text-anchor="middle" x="395.5" y="-337.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge8" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M264.3316,-289.0695C291.3093,-299.5286 330.2747,-314.6351 358.7248,-325.6651"/>
<polygon fill="#000000" stroke="#000000" points="357.7236,-329.0307 368.3126,-329.3822 360.254,-322.504 357.7236,-329.0307"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node17" class="node">
<title>proc~pf_set_resid</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node17"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="431,-309.9225 360,-309.9225 360,-285.9225 431,-285.9225 431,-309.9225"/>
<text text-anchor="middle" x="395.5" y="-295.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge10" class="edge">
<title>proc~pf_parareal_v_cycle&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M287.5622,-283.9736C307.7266,-286.5795 330.358,-289.5042 349.67,-291.9999"/>
<polygon fill="#000000" stroke="#000000" points="349.361,-295.4889 359.7271,-293.2996 350.2582,-288.5467 349.361,-295.4889"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node15" class="node">
<title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="645,-55.9225 581,-55.9225 581,-31.9225 645,-31.9225 645,-55.9225"/>
<text text-anchor="middle" x="613" y="-41.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge11" class="edge">
<title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M543.5467,-64.7585C552.2359,-62.1517 561.8538,-59.2664 571.093,-56.4946"/>
<polygon fill="#000000" stroke="#000000" points="572.3355,-59.776 580.908,-53.5501 570.324,-53.0713 572.3355,-59.776"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge12" class="edge">
<title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M545.1911,-29.6826C553.3986,-31.4062 562.3426,-33.2845 570.9626,-35.0946"/>
<polygon fill="#000000" stroke="#000000" points="570.3634,-38.5451 580.8692,-37.175 571.802,-31.6945 570.3634,-38.5451"/>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge15" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M257.6803,-159.7722C285.5205,-146.0663 330.9521,-123.6999 361.9863,-108.4216"/>
<polygon fill="#000000" stroke="#000000" points="363.6941,-111.482 371.1199,-103.925 360.6023,-105.2018 363.6941,-111.482"/>
</g>
<!-- proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node9" class="node">
<title>proc~pf_check_residual~2</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node9"><a xlink:href=".././proc/pf_check_residual%7E2.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="445,-225.9225 346,-225.9225 346,-201.9225 445,-201.9225 445,-225.9225"/>
<text text-anchor="middle" x="395.5" y="-211.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2 -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge13" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_check_residual~2</title>
<path fill="none" stroke="#000000" d="M279.566,-183.958C298.0946,-188.7469 319.5857,-194.3016 338.9943,-199.318"/>
<polygon fill="#000000" stroke="#000000" points="338.3695,-202.7714 348.9272,-201.8852 340.1212,-195.9941 338.3695,-202.7714"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node10" class="node">
<title>proc~pf_send_status</title>
<g id="a_proc~~pf_parareal_block_run~~CallsGraph_node10"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="438,-183.9225 353,-183.9225 353,-159.9225 438,-159.9225 438,-183.9225"/>
<text text-anchor="middle" x="395.5" y="-169.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge14" class="edge">
<title>proc~pf_check_convergence_block~2&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M310.4426,-171.9225C321.3557,-171.9225 332.3604,-171.9225 342.6672,-171.9225"/>
<polygon fill="#000000" stroke="#000000" points="342.7121,-175.4226 352.7121,-171.9225 342.712,-168.4226 342.7121,-175.4226"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge16" class="edge">
<title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M427.2972,-87.0514C441.213,-84.9197 457.7047,-82.3933 472.4865,-80.1288"/>
<polygon fill="#000000" stroke="#000000" points="473.0396,-83.585 482.3943,-78.611 471.9796,-76.6657 473.0396,-83.585"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge17" class="edge">
<title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M415.9669,-79.9036C434.6387,-68.9389 462.4482,-52.6082 483.5152,-40.237"/>
<polygon fill="#000000" stroke="#000000" points="485.5226,-43.1171 492.3734,-35.0352 481.9779,-37.0809 485.5226,-43.1171"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge18" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M290.6767,-56.4542C344.817,-60.7081 424.4322,-66.9636 472.2485,-70.7206"/>
<polygon fill="#000000" stroke="#000000" points="471.9944,-74.2113 482.2378,-71.5055 472.5427,-67.2328 471.9944,-74.2113"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge19" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M290.6767,-45.9488C344.2204,-40.4033 422.6807,-32.277 470.6563,-27.3081"/>
<polygon fill="#000000" stroke="#000000" points="471.1165,-30.7793 480.7026,-26.2676 470.3952,-23.8165 471.1165,-30.7793"/>
</g>
<!-- proc~pf_parareal_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge20" class="edge">
<title>proc~pf_parareal_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M281.7554,-63.9238C304.7795,-69.5913 331.9716,-76.2847 353.9947,-81.7058"/>
<polygon fill="#000000" stroke="#000000" points="353.1694,-85.1071 363.7161,-84.0988 354.8426,-78.31 353.1694,-85.1071"/>
</g>
<!-- pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node12" class="node">
<title>pf_stop</title>
<polygon fill="#777777" stroke="#777777" points="540,-288.9225 486,-288.9225 486,-264.9225 540,-264.9225 540,-288.9225"/>
<text text-anchor="middle" x="513" y="-274.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge22" class="edge">
<title>proc~pf_broadcast&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M431.0204,-369.8356C435.9873,-367.3167 440.8162,-364.3593 445,-360.9225 467.0037,-342.8476 462.678,-329.7209 481,-307.9225 484.3967,-303.8813 488.2567,-299.7915 492.0916,-295.9663"/>
<polygon fill="#000000" stroke="#000000" points="494.531,-298.4762 499.3067,-289.0187 489.6756,-293.4338 494.531,-298.4762"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node13" class="node">
<title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="543.5,-382.9225 482.5,-382.9225 482.5,-358.9225 543.5,-358.9225 543.5,-382.9225"/>
<text text-anchor="middle" x="513" y="-368.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">end_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge23" class="edge">
<title>proc~pf_broadcast&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M433.0008,-378.4118C445.3839,-377.2525 459.2226,-375.957 471.8627,-374.7737"/>
<polygon fill="#000000" stroke="#000000" points="472.5101,-378.2284 482.1403,-373.8115 471.8575,-371.2589 472.5101,-378.2284"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_node16" class="node">
<title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="545,-340.9225 481,-340.9225 481,-316.9225 545,-316.9225 545,-340.9225"/>
<text text-anchor="middle" x="513" y="-326.5225" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge21" class="edge">
<title>proc~pf_broadcast&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M424.3737,-369.8945C431.1612,-367.0058 438.353,-363.8951 445,-360.9225 456.0545,-355.9787 468.0315,-350.4136 478.809,-345.3274"/>
<polygon fill="#000000" stroke="#000000" points="480.3816,-348.4553 487.918,-341.0086 477.3827,-342.1302 480.3816,-348.4553"/>
</g>
<!-- proc~pf_send_status&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge24" class="edge">
<title>proc~pf_send_status&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M429.9917,-183.9487C435.2611,-186.5095 440.4522,-189.4956 445,-192.9225 468.2026,-210.4062 488.2141,-237.4703 500.4065,-256.1293"/>
<polygon fill="#000000" stroke="#000000" points="497.582,-258.2108 505.8942,-264.7802 503.493,-254.461 497.582,-258.2108"/>
</g>
<!-- proc~pf_send&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge26" class="edge">
<title>proc~pf_send&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M422.7522,-260.7931C438.472,-263.6026 458.4633,-267.1755 475.6331,-270.2442"/>
<polygon fill="#000000" stroke="#000000" points="475.4358,-273.7643 485.8956,-272.0783 476.6674,-266.8735 475.4358,-273.7643"/>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge27" class="edge">
<title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M422.7294,-263.4743C430.6079,-266.6541 438.7568,-271.0249 445,-276.9225 471.2973,-301.7639 457.0354,-322.8238 481,-349.9225 481.7263,-350.7438 482.492,-351.5465 483.2888,-352.3296"/>
<polygon fill="#000000" stroke="#000000" points="481.1604,-355.1117 491.0853,-358.8193 485.6387,-349.7317 481.1604,-355.1117"/>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge25" class="edge">
<title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M422.5575,-265.9542C430.0152,-269.1037 437.9805,-272.8376 445,-276.9225 461.543,-286.5496 478.6513,-299.651 491.5691,-310.2945"/>
<polygon fill="#000000" stroke="#000000" points="489.4955,-313.1235 499.4049,-316.8726 493.9963,-307.7623 489.4955,-313.1235"/>
</g>
<!-- proc~pf_recv&#45;&gt;pf_stop -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge29" class="edge">
<title>proc~pf_recv&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M422.5605,-329.3187C429.9427,-326.1902 437.8689,-322.6103 445,-318.9225 459.0836,-311.6394 474.1423,-302.4903 486.4998,-294.592"/>
<polygon fill="#000000" stroke="#000000" points="488.4779,-297.4808 494.968,-289.1065 484.6721,-291.6058 488.4779,-297.4808"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge30" class="edge">
<title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M422.7522,-347.1124C437.4614,-350.9932 455.9107,-355.8606 472.2887,-360.1816"/>
<polygon fill="#000000" stroke="#000000" points="471.6046,-363.6209 482.1666,-362.7877 473.3904,-356.8525 471.6046,-363.6209"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_parareal_block_run~~CallsGraph_edge28" class="edge">
<title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M422.7522,-337.3712C436.989,-336.0384 454.7294,-334.3776 470.7043,-332.8821"/>
<polygon fill="#000000" stroke="#000000" points="471.2624,-336.3452 480.8926,-331.9283 470.6099,-329.3757 471.2624,-336.3452"/>
</g>
</g>
</svg>
</div><script>var panprocpf_parareal_block_runCallsGraph = svgPanZoom('#procpf_parareal_block_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_parareal_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_parareal_block_runCalledByGraph" width="253pt" height="32pt"
 viewBox="0.00 0.00 253.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_parareal_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_parareal_block_run~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 249,-28 249,4 -4,4"/>
<!-- proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_node1" class="node">
<title>proc~pf_parareal_block_run</title>
<polygon fill="none" stroke="#000000" points="245,-24 125,-24 125,0 245,0 245,-24"/>
<text text-anchor="middle" x="185" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_parareal_block_run</text>
</g>
<!-- proc~pf_parareal_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_node2" class="node">
<title>proc~pf_parareal_run</title>
<g id="a_proc~~pf_parareal_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_parareal_run.html" xlink:title="pf_parareal_run">
<polygon fill="#d9534f" stroke="#d9534f" points="89,-24 0,-24 0,0 89,0 89,-24"/>
<text text-anchor="middle" x="44.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_parareal_run</text>
</a>
</g>
</g>
<!-- proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run -->
<g id="proc~~pf_parareal_block_run~~CalledByGraph_edge1" class="edge">
<title>proc~pf_parareal_run&#45;&gt;proc~pf_parareal_block_run</title>
<path fill="none" stroke="#000000" d="M89.3414,-12C97.4802,-12 106.1449,-12 114.8084,-12"/>
<polygon fill="#000000" stroke="#000000" points="114.9465,-15.5001 124.9465,-12 114.9465,-8.5001 114.9465,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_parareal_block_run.html#src">pf_parareal_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_parareal_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest level in V (Lambda)-cycle</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_max_depth</span> <span class="c">!!  Finest level in V-cycle</span>
    <span class="kt">integer</span><span class="kd">::</span>  <span class="n">nsteps_c</span><span class="p">,</span><span class="n">nsteps_f</span>  

    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c">! set finest level to visit in the following run</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k</span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>

       <span class="c">!&gt; Reset some flags</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pfblock</span> <span class="o">=</span> <span class="n">k</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">sweep</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c">!  Needed for compatibility of residual storage       </span>


       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_parareal_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">!&gt;  Start the parareal iterations</span>
       <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>

          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>

          <span class="c">!  Do a v_cycle</span>
          <span class="k">call </span><span class="n">pf_parareal_v_cycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

          <span class="c">!  Check for convergence</span>
          <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

          <span class="c">!  If we are converged, exit block</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">exit</span>
<span class="k">       end do</span>  <span class="c">!  Loop over the iteration in this bloc</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
       <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_STEP</span><span class="p">)</span>
    <span class="k">end do</span> <span class="c">!  Loop over the blocks</span>

    <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_parareal_block_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>