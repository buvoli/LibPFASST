<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_block_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">65 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST controller for block mode
  When starting a new block, broadcast new initial conditions to all procs
  For initial block, this is done when initial conditions are set
 Reset some flags
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the loops over SDC sweeps</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E65"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E3"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E16"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E3"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E33"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_block_runCallsGraph" width="641pt" height="606pt"
 viewBox="0.00 0.00 641.00 605.64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CallsGraph" class="graph" transform="scale(0.818646 0.818646) rotate(0) translate(4 735.806)">
<title>proc~~pf_block_run~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-735.806 779,-735.806 779,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CallsGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="74,-334.806 0,-334.806 0,-310.806 74,-310.806 74,-334.806"/>
<text text-anchor="middle" x="37" y="-320.406" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_node2" class="node"><title>proc~pf_check_convergence_block</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_check_convergence_block.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-689.806 110,-689.806 110,-665.806 264,-665.806 264,-689.806"/>
<text text-anchor="middle" x="187" y="-675.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_edge1" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block</title>
<path fill="none" stroke="#000000" d="M39.0838,-335.01C44.0782,-388.658 66.509,-603.043 110,-651.806 112.924,-655.085 116.279,-657.95 119.915,-660.454"/>
<polygon fill="#000000" stroke="#000000" points="118.437,-663.644 128.837,-665.666 121.968,-657.6 118.437,-663.644"/>
</g>
<!-- proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_node3" class="node"><title>proc~pf_v_cycle</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node3"><a xlink:href=".././proc/pf_v_cycle.html" xlink:title="pf_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="218.5,-334.806 155.5,-334.806 155.5,-310.806 218.5,-310.806 218.5,-334.806"/>
<text text-anchor="middle" x="187" y="-320.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_edge2" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_v_cycle</title>
<path fill="none" stroke="#000000" d="M74.2049,-322.806C95.6291,-322.806 122.831,-322.806 145.038,-322.806"/>
<polygon fill="#000000" stroke="#000000" points="145.17,-326.306 155.17,-322.806 145.17,-319.306 145.17,-326.306"/>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_node4" class="node"><title>proc~pf_predictor</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node4"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="222,-274.806 152,-274.806 152,-250.806 222,-250.806 222,-274.806"/>
<text text-anchor="middle" x="187" y="-260.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_edge3" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M67.95,-310.664C90.6928,-301.444 122.163,-288.686 146.892,-278.661"/>
<polygon fill="#000000" stroke="#000000" points="148.395,-281.828 156.347,-274.828 145.765,-275.341 148.395,-281.828"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node5" class="node"><title>proc~end_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node5"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="667,-352.806 606,-352.806 606,-328.806 667,-328.806 667,-352.806"/>
<text text-anchor="middle" x="636.5" y="-338.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge4" class="edge"><title>proc~pf_block_run&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M44.7481,-335.071C56.4344,-355.71 81.9003,-398.129 110,-428.806 183.611,-509.168 201.8,-536.548 300,-583.806 366.375,-615.749 388.755,-610.984 462,-618.806 506.193,-623.526 526.785,-645.921 562,-618.806 582.756,-602.824 618.887,-426.163 631.227,-363.052"/>
<polygon fill="#000000" stroke="#000000" points="634.714,-363.455 633.184,-352.972 627.842,-362.121 634.714,-363.455"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_node6" class="node"><title>proc~pf_broadcast</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node6"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="400.5,-94.8063 325.5,-94.8063 325.5,-70.8063 400.5,-70.8063 400.5,-94.8063"/>
<text text-anchor="middle" x="363" y="-80.4063" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_edge5" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M47.5099,-310.534C60.6316,-293.988 85.4606,-264.041 110,-241.806 187.342,-171.729 207.3,-151.758 300,-103.806 304.921,-101.261 310.216,-98.9233 315.564,-96.8068"/>
<polygon fill="#000000" stroke="#000000" points="317.022,-99.9992 325.179,-93.2387 314.586,-93.4365 317.022,-99.9992"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_node7" class="node"><title>proc~call_hooks</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node7"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="543.5,-411.806 480.5,-411.806 480.5,-387.806 543.5,-387.806 543.5,-411.806"/>
<text text-anchor="middle" x="512" y="-397.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge6" class="edge"><title>proc~pf_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M53.3596,-334.875C92.0145,-364.383 197.568,-439.672 300,-465.806 354.262,-479.65 376.036,-491.097 426,-465.806 450.111,-453.602 440.253,-432.848 462,-416.806 464.802,-414.739 467.876,-412.909 471.075,-411.29"/>
<polygon fill="#000000" stroke="#000000" points="472.532,-414.474 480.303,-407.272 469.737,-408.056 472.532,-414.474"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node8" class="node"><title>proc~start_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node8"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="668.5,-238.806 604.5,-238.806 604.5,-214.806 668.5,-214.806 668.5,-238.806"/>
<text text-anchor="middle" x="636.5" y="-224.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge7" class="edge"><title>proc~pf_block_run&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M39.0792,-310.728C42.7278,-276.69 57.4852,-178.761 110,-121.806 172.833,-53.6609 209.393,-55.3572 300,-35.8063 413.825,-11.2453 466.008,30.1088 562,-35.8063 618.343,-74.4951 631.512,-162.885 634.577,-204.439"/>
<polygon fill="#000000" stroke="#000000" points="631.095,-204.842 635.191,-214.613 638.083,-204.42 631.095,-204.842"/>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge8" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M194.741,-665.733C210.034,-639.411 249.949,-576.445 300,-541.806 348.656,-508.134 381.544,-537.857 426,-498.806 453.179,-474.932 436.803,-451.763 462,-425.806 465.019,-422.697 468.49,-419.877 472.162,-417.341"/>
<polygon fill="#000000" stroke="#000000" points="474.279,-420.149 480.974,-411.937 470.619,-414.181 474.279,-420.149"/>
</g>
<!-- proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node16" class="node"><title>proc~pf_check_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node16"><a xlink:href=".././proc/pf_check_residual.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="412.5,-731.806 313.5,-731.806 313.5,-707.806 412.5,-707.806 412.5,-731.806"/>
<text text-anchor="middle" x="363" y="-717.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge9" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual</title>
<path fill="none" stroke="#000000" d="M237.861,-689.842C258.321,-694.78 282.154,-700.533 303.436,-705.67"/>
<polygon fill="#000000" stroke="#000000" points="302.79,-709.115 313.332,-708.059 304.433,-702.31 302.79,-709.115"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_node20" class="node"><title>proc~pf_send_status</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node20"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="405.5,-689.806 320.5,-689.806 320.5,-665.806 405.5,-665.806 405.5,-689.806"/>
<text text-anchor="middle" x="363" y="-675.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_edge10" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M264.066,-677.806C279.519,-677.806 295.44,-677.806 309.836,-677.806"/>
<polygon fill="#000000" stroke="#000000" points="310.021,-681.306 320.021,-677.806 310.021,-674.306 310.021,-681.306"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_node9" class="node"><title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node9"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="426,-574.806 300,-574.806 300,-550.806 426,-550.806 426,-574.806"/>
<text text-anchor="middle" x="363" y="-560.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge11" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M196.868,-335.038C224.967,-373.796 312.236,-494.166 347.247,-542.457"/>
<polygon fill="#000000" stroke="#000000" points="344.447,-544.558 353.15,-550.599 350.114,-540.449 344.447,-544.558"/>
</g>
<!-- proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_node10" class="node"><title>proc~pf_post</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node10"><a xlink:href=".././proc/pf_post.html" xlink:title="pf_post">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-456.806 336,-456.806 336,-432.806 390,-432.806 390,-456.806"/>
<text text-anchor="middle" x="363" y="-442.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_post</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_edge12" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_post</title>
<path fill="none" stroke="#000000" d="M198.52,-335.13C217.037,-356.112 257.534,-398.914 300,-423.806 308.05,-428.525 317.313,-432.377 326.184,-435.432"/>
<polygon fill="#000000" stroke="#000000" points="325.356,-438.842 335.946,-438.548 327.484,-432.173 325.356,-438.842"/>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node11" class="node"><title>proc~pf_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="544.5,-179.806 479.5,-179.806 479.5,-155.806 544.5,-155.806 544.5,-179.806"/>
<text text-anchor="middle" x="512" y="-165.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge13" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M218.611,-312.679C264.843,-296.868 354.656,-264.126 426,-225.806 447.712,-214.145 470.707,-198.209 487.297,-185.992"/>
<polygon fill="#000000" stroke="#000000" points="489.426,-188.77 495.348,-179.984 485.24,-183.159 489.426,-188.77"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_node13" class="node"><title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node13"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="425,-414.806 301,-414.806 301,-390.806 425,-390.806 425,-414.806"/>
<text text-anchor="middle" x="363" y="-400.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge17" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M212.298,-334.974C234.869,-346.169 269.492,-363.066 300,-376.806 307.333,-380.109 315.211,-383.518 322.808,-386.736"/>
<polygon fill="#000000" stroke="#000000" points="321.644,-390.043 332.22,-390.688 324.355,-383.589 321.644,-390.043"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_node14" class="node"><title>proc~pf_send</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-136.806 336,-136.806 336,-112.806 390,-112.806 390,-136.806"/>
<text text-anchor="middle" x="363" y="-122.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge14" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M218.604,-313.835C234.304,-307.751 252.495,-298.152 264,-283.806 303.656,-234.357 256.808,-192.198 300,-145.806 306.897,-138.398 316.499,-133.603 326.09,-130.499"/>
<polygon fill="#000000" stroke="#000000" points="327.22,-133.82 335.966,-127.838 325.399,-127.061 327.22,-133.82"/>
</g>
<!-- proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_node15" class="node"><title>proc~interpolate_q0</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node15"><a xlink:href=".././proc/interpolate_q0.html" xlink:title="interpolate_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-334.806 322.5,-334.806 322.5,-310.806 403.5,-310.806 403.5,-334.806"/>
<text text-anchor="middle" x="363" y="-320.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_q0</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge15" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M218.707,-322.806C244.54,-322.806 281.977,-322.806 312.107,-322.806"/>
<polygon fill="#000000" stroke="#000000" points="312.428,-326.306 322.428,-322.806 312.428,-319.306 312.428,-326.306"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_node19" class="node"><title>proc~pf_recv</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node19"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-178.806 336,-178.806 336,-154.806 390,-154.806 390,-178.806"/>
<text text-anchor="middle" x="363" y="-164.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge16" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M218.152,-310.714C232.817,-304.02 250.209,-294.818 264,-283.806 299.406,-255.534 331.238,-212.828 348.473,-187.586"/>
<polygon fill="#000000" stroke="#000000" points="351.477,-189.39 354.141,-179.135 345.664,-185.49 351.477,-189.39"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge18" class="edge"><title>proc~pf_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M222.143,-267.843C288.043,-277.702 437.282,-300.699 562,-324.806 573.093,-326.95 585.083,-329.473 596.096,-331.873"/>
<polygon fill="#000000" stroke="#000000" points="595.364,-335.295 605.882,-334.028 596.869,-328.459 595.364,-335.295"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge23" class="edge"><title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M218.099,-274.966C232.751,-281.677 250.147,-290.873 264,-301.806 283.299,-317.038 279.18,-330.73 300,-343.806 314.495,-352.91 413.606,-377.052 470.692,-390.475"/>
<polygon fill="#000000" stroke="#000000" points="469.958,-393.897 480.493,-392.771 471.555,-387.082 469.958,-393.897"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge25" class="edge"><title>proc~pf_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M190.373,-250.577C198.228,-213.881 227.154,-104.607 300,-61.8063 350.199,-32.3119 513.168,-30.1008 562,-61.8063 611.102,-93.687 627.677,-166.817 633.052,-204.081"/>
<polygon fill="#000000" stroke="#000000" points="629.634,-204.938 634.384,-214.408 636.576,-204.042 629.634,-204.938"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge19" class="edge"><title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M222.297,-272.971C237.199,-279.053 253.592,-288.295 264,-301.806 309.54,-360.924 271.463,-396.854 300,-465.806 311.811,-494.343 331.953,-523.772 346.066,-542.618"/>
<polygon fill="#000000" stroke="#000000" points="343.409,-544.907 352.26,-550.73 348.973,-540.658 343.409,-544.907"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge20" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M222.261,-252.73C282.057,-235.142 405.231,-198.915 469.663,-179.964"/>
<polygon fill="#000000" stroke="#000000" points="470.874,-183.256 479.48,-177.077 468.899,-176.541 470.874,-183.256"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge26" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M222.089,-274.648C236.417,-280.954 252.412,-289.906 264,-301.806 289.795,-328.297 273.204,-351.329 300,-376.806 303.711,-380.335 307.972,-383.418 312.484,-386.104"/>
<polygon fill="#000000" stroke="#000000" points="310.914,-389.233 321.393,-390.794 314.175,-383.039 310.914,-389.233"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge21" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M198.328,-250.628C221.263,-223.824 276.28,-160.907 300,-145.806 307.871,-140.796 317.07,-136.839 325.936,-133.776"/>
<polygon fill="#000000" stroke="#000000" points="327.234,-137.036 335.716,-130.688 325.127,-130.361 327.234,-137.036"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge22" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M222.377,-274.66C249.605,-284.049 287.849,-297.237 317.428,-307.437"/>
<polygon fill="#000000" stroke="#000000" points="316.504,-310.82 327.099,-310.771 318.786,-304.203 316.504,-310.82"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge24" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M205.327,-250.743C226.906,-236.013 265.182,-210.837 300,-192.806 308.449,-188.431 317.803,-184.206 326.63,-180.479"/>
<polygon fill="#000000" stroke="#000000" points="328.02,-183.692 335.933,-176.647 325.354,-177.219 328.02,-183.692"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_node17" class="node"><title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="775,-304.806 711,-304.806 711,-280.806 775,-280.806 775,-304.806"/>
<text text-anchor="middle" x="743" y="-290.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_edge27" class="edge"><title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M663.87,-328.694C676.741,-322.782 692.415,-315.582 706.337,-309.187"/>
<polygon fill="#000000" stroke="#000000" points="708.012,-312.269 715.639,-304.915 705.091,-305.908 708.012,-312.269"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node12" class="node"><title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="542.5,-136.806 481.5,-136.806 481.5,-112.806 542.5,-112.806 542.5,-136.806"/>
<text text-anchor="middle" x="512" y="-122.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge29" class="edge"><title>proc~pf_broadcast&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M400.715,-93.2963C422.249,-99.4488 449.458,-107.223 471.462,-113.51"/>
<polygon fill="#000000" stroke="#000000" points="470.59,-116.9 481.167,-116.282 472.513,-110.17 470.59,-116.9"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node18" class="node"><title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="544,-94.8063 480,-94.8063 480,-70.8063 544,-70.8063 544,-94.8063"/>
<text text-anchor="middle" x="512" y="-80.4063" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge28" class="edge"><title>proc~pf_broadcast&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M400.715,-82.8063C421.616,-82.8063 447.865,-82.8063 469.51,-82.8063"/>
<polygon fill="#000000" stroke="#000000" points="469.723,-86.3064 479.722,-82.8063 469.722,-79.3064 469.723,-86.3064"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge31" class="edge"><title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M538.085,-387.724C556.335,-378.935 581.257,-366.931 601.325,-357.266"/>
<polygon fill="#000000" stroke="#000000" points="602.958,-360.365 610.448,-352.872 599.92,-354.058 602.958,-360.365"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge30" class="edge"><title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M521.614,-387.641C542.299,-358.429 594.966,-284.05 620.782,-247.591"/>
<polygon fill="#000000" stroke="#000000" points="623.809,-249.373 626.732,-239.189 618.096,-245.328 623.809,-249.373"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_edge32" class="edge"><title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M656.667,-238.912C672.871,-249.146 696.285,-263.934 714.49,-275.432"/>
<polygon fill="#000000" stroke="#000000" points="712.631,-278.397 722.955,-280.778 716.369,-272.478 712.631,-278.397"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge37" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M397.59,-550.781C440.007,-534.26 513.314,-501.113 562,-453.806 590.176,-426.428 613.005,-386.366 625.383,-362.027"/>
<polygon fill="#000000" stroke="#000000" points="628.584,-363.451 629.891,-352.937 622.313,-360.341 628.584,-363.451"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge33" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M406.507,-550.786C413.733,-547.221 420.627,-542.648 426,-536.806 461.111,-498.636 428.657,-465.53 462,-425.806 464.786,-422.487 468.107,-419.531 471.688,-416.914"/>
<polygon fill="#000000" stroke="#000000" points="473.809,-419.713 480.388,-411.409 470.066,-413.798 473.809,-419.713"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge36" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M400.866,-550.753C409.91,-546.482 418.994,-540.916 426,-533.806 453.367,-506.035 433.033,-479.904 462,-453.806 496.771,-422.479 528.517,-453.507 562,-420.806 596.093,-387.51 581.086,-364.359 598,-319.806 607.332,-295.225 618.705,-267.278 626.463,-248.493"/>
<polygon fill="#000000" stroke="#000000" points="629.769,-249.657 630.365,-239.079 623.303,-246.977 629.769,-249.657"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~pf_block_run~~CallsGraph_node21" class="node"><title>proc~restrict_ts</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node21"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-609.806 482.5,-609.806 482.5,-585.806 541.5,-585.806 541.5,-609.806"/>
<text text-anchor="middle" x="512" y="-595.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~pf_block_run~~CallsGraph_edge35" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M414.589,-574.851C433.473,-579.347 454.598,-584.377 472.25,-588.58"/>
<polygon fill="#000000" stroke="#000000" points="471.66,-592.037 482.199,-590.949 473.281,-585.228 471.66,-592.037"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~pf_block_run~~CallsGraph_node23" class="node"><title>proc~restrict_ts_integral</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node23"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-567.806 462,-567.806 462,-543.806 562,-543.806 562,-567.806"/>
<text text-anchor="middle" x="512" y="-553.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~pf_block_run~~CallsGraph_edge34" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M426.341,-559.838C434.797,-559.435 443.455,-559.023 451.853,-558.623"/>
<polygon fill="#000000" stroke="#000000" points="452.114,-562.114 461.936,-558.143 451.781,-555.122 452.114,-562.114"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge39" class="edge"><title>proc~pf_residual&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M521.614,-179.971C542.299,-209.183 594.966,-283.562 620.782,-320.021"/>
<polygon fill="#000000" stroke="#000000" points="618.096,-322.285 626.732,-328.423 623.809,-318.239 618.096,-322.285"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge38" class="edge"><title>proc~pf_residual&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M538.085,-179.888C556.335,-188.678 581.257,-200.681 601.325,-210.346"/>
<polygon fill="#000000" stroke="#000000" points="599.92,-213.555 610.448,-214.741 602.958,-207.248 599.92,-213.555"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge43" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M412.045,-390.791C427.928,-386.885 445.704,-382.586 462,-378.806 507.93,-368.154 560.89,-356.67 596.097,-349.148"/>
<polygon fill="#000000" stroke="#000000" points="596.929,-352.549 605.98,-347.041 595.47,-345.703 596.929,-352.549"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge40" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M425.064,-401.56C440.276,-401.25 456.22,-400.924 470.187,-400.639"/>
<polygon fill="#000000" stroke="#000000" points="470.51,-404.133 480.437,-400.43 470.368,-397.135 470.51,-404.133"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge42" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M382.661,-390.709C429.645,-360.252 552.99,-280.293 608.154,-244.533"/>
<polygon fill="#000000" stroke="#000000" points="610.221,-247.365 616.708,-238.988 606.413,-241.491 610.221,-247.365"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_node22" class="node"><title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node22"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="675,-567.806 598,-567.806 598,-543.806 675,-543.806 675,-567.806"/>
<text text-anchor="middle" x="636.5" y="-553.406" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge41" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M404.241,-414.891C411.602,-417.534 419.125,-420.533 426,-423.806 496.787,-457.514 573.044,-510.189 611.049,-537.698"/>
<polygon fill="#000000" stroke="#000000" points="609.287,-540.744 619.43,-543.806 613.41,-535.087 609.287,-540.744"/>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge45" class="edge"><title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.281,-124.806C412.781,-124.806 445.52,-124.806 471.229,-124.806"/>
<polygon fill="#000000" stroke="#000000" points="471.41,-128.306 481.41,-124.806 471.41,-121.306 471.41,-128.306"/>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge44" class="edge"><title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.281,-117.298C412.444,-110.965 444.541,-101.795 470.068,-94.5012"/>
<polygon fill="#000000" stroke="#000000" points="471.194,-97.8196 479.848,-91.707 469.271,-91.0889 471.194,-97.8196"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge48" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M403.769,-325.443C455.167,-328.85 544.148,-334.75 595.606,-338.161"/>
<polygon fill="#000000" stroke="#000000" points="595.473,-341.66 605.683,-338.829 595.936,-334.675 595.473,-341.66"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge46" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M395.302,-334.909C405.253,-339.027 416.212,-343.85 426,-348.806 445.949,-358.909 467.546,-371.895 483.977,-382.234"/>
<polygon fill="#000000" stroke="#000000" points="482.215,-385.261 492.532,-387.671 485.969,-379.353 482.215,-385.261"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge47" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M403.703,-310.812C411.676,-307.178 419.57,-302.573 426,-296.806 450.585,-274.758 433.793,-248.98 462,-231.806 501.878,-207.526 557.036,-210.804 594.373,-217.176"/>
<polygon fill="#000000" stroke="#000000" points="593.933,-220.654 604.403,-219.035 595.209,-213.771 593.933,-220.654"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge50" class="edge"><title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.281,-159.298C412.881,-152.84 445.811,-143.432 471.571,-136.072"/>
<polygon fill="#000000" stroke="#000000" points="472.756,-139.373 481.41,-133.261 470.833,-132.643 472.756,-139.373"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge49" class="edge"><title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.158,-161.287C401.798,-158.019 415.266,-153.061 426,-145.806 446.369,-132.039 442.186,-118.361 462,-103.806 464.685,-101.834 467.584,-100.001 470.584,-98.3071"/>
<polygon fill="#000000" stroke="#000000" points="472.439,-101.291 479.771,-93.6434 469.27,-95.049 472.439,-101.291"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge51" class="edge"><title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M541.721,-587.959C556.244,-582.98 574.206,-576.822 590.51,-571.232"/>
<polygon fill="#000000" stroke="#000000" points="592.077,-574.394 600.402,-567.84 589.807,-567.773 592.077,-574.394"/>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge52" class="edge"><title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M562.12,-555.806C570.543,-555.806 579.285,-555.806 587.674,-555.806"/>
<polygon fill="#000000" stroke="#000000" points="587.686,-559.306 597.686,-555.806 587.686,-552.306 587.686,-559.306"/>
</g>
</g>
</svg>
</div><script>var panprocpf_block_runCallsGraph = svgPanZoom('#procpf_block_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_block_runCalledByGraph" width="196pt" height="32pt"
 viewBox="0.00 0.00 196.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_block_run~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 192,-28 192,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="188,-24 114,-24 114,-0 188,-0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node2" class="node"><title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,-0 78,-0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_edge1" class="edge"><title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.164,-12C86.3694,-12 95.1281,-12 103.607,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.755,-15.5001 113.754,-12 103.754,-8.5001 103.755,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev_p</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest level in V (Lambda)-cycle</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_max_depth</span> <span class="c">!!  Finest level in V-cycle</span>


    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c">! set finest level to visit in the following run</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k</span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>

       <span class="c">!&gt; Reset some flags</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pfblock</span> <span class="o">=</span> <span class="n">k</span>


       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">!&gt;  Start the loops over SDC sweeps</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

       <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>

          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>

          <span class="c">!  Do a v_cycle</span>
          <span class="k">call </span><span class="n">pf_v_cycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index_c</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

          <span class="c">!  Check for convergence</span>
          <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>

<span class="c">!          print *,pf%rank, &#39; post res&#39;</span>
          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

          <span class="c">!  If we are converged, exit block</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">exit</span>
<span class="k">       end do</span>  <span class="c">!  Loop over the iteration in this bloc</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
       <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_STEP</span><span class="p">)</span>
    <span class="k">end do</span> <span class="c">!  Loop over the blocks</span>

    <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_block_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>