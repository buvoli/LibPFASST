<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_block_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">65 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST controller for block mode
  When starting a new block, broadcast new initial conditions to all procs
  For initial block, this is done when initial conditions are set
 Reset some flags
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the loops over SDC sweeps</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E141"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E4"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E58"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E3"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E136"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_block_runCallsGraph" width="641pt" height="701pt"
 viewBox="0.00 0.00 641.00 701.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CallsGraph" class="graph" transform="scale(0.818646 0.818646) rotate(0) translate(4 852.606)">
<title>proc~~pf_block_run~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-852.606 779,-852.606 779,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CallsGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="74,-614 0,-614 0,-590 74,-590 74,-614"/>
<text text-anchor="middle" x="37" y="-599.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_node2" class="node"><title>proc~pf_check_convergence_block</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_check_convergence_block.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-730 110,-730 110,-706 264,-706 264,-730"/>
<text text-anchor="middle" x="187" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_edge1" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block</title>
<path fill="none" stroke="#000000" d="M53.5589,-614.195C79.6086,-634.612 132.186,-675.821 162.676,-699.719"/>
<polygon fill="#000000" stroke="#000000" points="160.62,-702.554 170.65,-705.969 164.938,-697.045 160.62,-702.554"/>
</g>
<!-- proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_node3" class="node"><title>proc~pf_v_cycle</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node3"><a xlink:href=".././proc/pf_v_cycle.html" xlink:title="pf_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="218.5,-393 155.5,-393 155.5,-369 218.5,-369 218.5,-393"/>
<text text-anchor="middle" x="187" y="-378.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_edge2" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_v_cycle</title>
<path fill="none" stroke="#000000" d="M41.3986,-589.821C49.6539,-561.76 72.8561,-491.271 110,-443 123.406,-425.579 142.617,-409.961 158.37,-398.759"/>
<polygon fill="#000000" stroke="#000000" points="160.464,-401.566 166.707,-393.006 156.489,-395.805 160.464,-401.566"/>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_node4" class="node"><title>proc~pf_predictor</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node4"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="222,-476 152,-476 152,-452 222,-452 222,-476"/>
<text text-anchor="middle" x="187" y="-461.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_edge3" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M50.8751,-589.995C76.5693,-566.037 134.398,-512.115 165.418,-483.192"/>
<polygon fill="#000000" stroke="#000000" points="168.122,-485.455 173.049,-476.076 163.348,-480.336 168.122,-485.455"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node5" class="node"><title>proc~end_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node5"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="667,-565 606,-565 606,-541 667,-541 667,-565"/>
<text text-anchor="middle" x="636.5" y="-550.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge4" class="edge"><title>proc~pf_block_run&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M41.3778,-614.37C49.1713,-640.742 70.8102,-703.02 110,-739 216.72,-836.978 295.663,-882.255 426,-819 534.308,-766.436 603.404,-627.733 626.709,-574.356"/>
<polygon fill="#000000" stroke="#000000" points="629.934,-575.716 630.643,-565.144 623.497,-572.966 629.934,-575.716"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_node6" class="node"><title>proc~pf_broadcast</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node6"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="400.5,-66 325.5,-66 325.5,-42 400.5,-42 400.5,-66"/>
<text text-anchor="middle" x="363" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_edge5" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M39.8643,-589.765C45.8121,-553.104 66.5493,-441.648 110,-360 175.1,-237.672 293.688,-118.473 341.352,-73.1561"/>
<polygon fill="#000000" stroke="#000000" points="344.016,-75.4549 348.888,-66.0468 339.212,-70.3631 344.016,-75.4549"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_node7" class="node"><title>proc~call_hooks</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node7"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="543.5,-614 480.5,-614 480.5,-590 543.5,-590 543.5,-614"/>
<text text-anchor="middle" x="512" y="-599.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge6" class="edge"><title>proc~pf_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M74.3301,-602C160.998,-602 379.404,-602 470.312,-602"/>
<polygon fill="#000000" stroke="#000000" points="470.495,-605.5 480.495,-602 470.495,-598.5 470.495,-605.5"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node8" class="node"><title>proc~start_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node8"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="668.5,-506 604.5,-506 604.5,-482 668.5,-482 668.5,-506"/>
<text text-anchor="middle" x="636.5" y="-491.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge7" class="edge"><title>proc~pf_block_run&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M67.0565,-614.083C151.971,-647.3 403.693,-730.618 562,-623 597.97,-598.548 574.246,-568.435 598,-532 602.315,-525.381 607.915,-518.956 613.465,-513.331"/>
<polygon fill="#000000" stroke="#000000" points="616.09,-515.662 620.878,-506.211 611.241,-510.614 616.09,-515.662"/>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge8" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M221.653,-705.914C281.468,-684.432 406.052,-639.69 470.474,-616.554"/>
<polygon fill="#000000" stroke="#000000" points="472.049,-619.708 480.277,-613.034 469.683,-613.12 472.049,-619.708"/>
</g>
<!-- proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node16" class="node"><title>proc~pf_check_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node16"><a xlink:href=".././proc/pf_check_residual.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="412.5,-810 313.5,-810 313.5,-786 412.5,-786 412.5,-810"/>
<text text-anchor="middle" x="363" y="-795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge9" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual</title>
<path fill="none" stroke="#000000" d="M208.572,-730.104C230.679,-742.808 267.085,-762.862 300,-777 304.402,-778.891 309.035,-780.728 313.705,-782.479"/>
<polygon fill="#000000" stroke="#000000" points="312.683,-785.831 323.277,-785.939 315.062,-779.248 312.683,-785.831"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_node20" class="node"><title>proc~pf_send_status</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node20"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="405.5,-768 320.5,-768 320.5,-744 405.5,-744 405.5,-768"/>
<text text-anchor="middle" x="363" y="-753.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_edge10" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M243.055,-730.023C264.628,-734.735 289.246,-740.111 310.466,-744.746"/>
<polygon fill="#000000" stroke="#000000" points="309.751,-748.172 320.267,-746.886 311.244,-741.333 309.751,-748.172"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_node9" class="node"><title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node9"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="426,-414 300,-414 300,-390 426,-390 426,-414"/>
<text text-anchor="middle" x="363" y="-399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge11" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M218.707,-384.706C238.429,-387.086 264.915,-390.283 289.749,-393.28"/>
<polygon fill="#000000" stroke="#000000" points="289.55,-396.781 299.898,-394.505 290.389,-389.832 289.55,-396.781"/>
</g>
<!-- proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_node10" class="node"><title>proc~pf_post</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node10"><a xlink:href=".././proc/pf_post.html" xlink:title="pf_post">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-246 336,-246 336,-222 390,-222 390,-246"/>
<text text-anchor="middle" x="363" y="-231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_post</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_edge12" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_post</title>
<path fill="none" stroke="#000000" d="M195.694,-368.703C211.935,-343.716 252.186,-286.694 300,-255 307.93,-249.743 317.304,-245.679 326.33,-242.589"/>
<polygon fill="#000000" stroke="#000000" points="327.395,-245.923 335.902,-239.609 325.313,-239.24 327.395,-245.923"/>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node11" class="node"><title>proc~pf_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="395.5,-372 330.5,-372 330.5,-348 395.5,-348 395.5,-372"/>
<text text-anchor="middle" x="363" y="-357.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge13" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M218.707,-377.294C246.932,-373.888 289.009,-368.809 320.273,-365.036"/>
<polygon fill="#000000" stroke="#000000" points="320.917,-368.484 330.425,-363.811 320.078,-361.534 320.917,-368.484"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_node13" class="node"><title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node13"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="425,-456 301,-456 301,-432 425,-432 425,-456"/>
<text text-anchor="middle" x="363" y="-441.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge17" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M218.802,-392.856C241.246,-401.419 272.421,-413.161 300,-423 305.218,-424.862 310.697,-426.776 316.149,-428.655"/>
<polygon fill="#000000" stroke="#000000" points="315.274,-432.055 325.869,-431.981 317.54,-425.432 315.274,-432.055"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_node14" class="node"><title>proc~pf_send</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-288 336,-288 336,-264 390,-264 390,-288"/>
<text text-anchor="middle" x="363" y="-273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge14" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M201.185,-368.877C221.208,-351.01 261.081,-317.512 300,-297 308.181,-292.688 317.426,-288.996 326.231,-285.964"/>
<polygon fill="#000000" stroke="#000000" points="327.475,-289.241 335.906,-282.825 325.314,-282.583 327.475,-289.241"/>
</g>
<!-- proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_node15" class="node"><title>proc~interpolate_q0</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node15"><a xlink:href=".././proc/interpolate_q0.html" xlink:title="interpolate_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-536 322.5,-536 322.5,-512 403.5,-512 403.5,-536"/>
<text text-anchor="middle" x="363" y="-521.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_q0</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge15" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M202.877,-393.09C218.215,-405.565 242.813,-425.602 264,-443 289.972,-464.327 319.714,-488.936 339.556,-505.38"/>
<polygon fill="#000000" stroke="#000000" points="337.481,-508.206 347.413,-511.894 341.949,-502.818 337.481,-508.206"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_node19" class="node"><title>proc~pf_recv</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node19"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-330 336,-330 336,-306 390,-306 390,-330"/>
<text text-anchor="middle" x="363" y="-315.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge16" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M218.802,-369.144C241.246,-360.581 272.421,-348.839 300,-339 308.555,-335.948 317.811,-332.755 326.497,-329.806"/>
<polygon fill="#000000" stroke="#000000" points="327.637,-333.115 335.993,-326.602 325.399,-326.483 327.637,-333.115"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge18" class="edge"><title>proc~pf_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M196.287,-476.275C213,-500.058 253.175,-552.489 300,-580 364.228,-617.736 388.133,-613.363 462,-623 506.071,-628.749 520.734,-639.506 562,-623 586.939,-613.024 608.238,-590.111 621.389,-573.203"/>
<polygon fill="#000000" stroke="#000000" points="624.327,-575.118 627.5,-565.01 618.716,-570.933 624.327,-575.118"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge23" class="edge"><title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M201.444,-476.262C221.48,-493.915 261.012,-526.407 300,-545 356.123,-571.764 426.848,-587.619 470.488,-595.565"/>
<polygon fill="#000000" stroke="#000000" points="469.983,-599.03 480.44,-597.325 471.202,-592.137 469.983,-599.03"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge25" class="edge"><title>proc~pf_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M222.003,-466.279C302.852,-471.7 506.355,-485.342 594.138,-491.227"/>
<polygon fill="#000000" stroke="#000000" points="594.041,-494.728 604.253,-491.905 594.51,-487.744 594.041,-494.728"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge19" class="edge"><title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M220.273,-451.95C242.609,-443.668 273.049,-432.496 300,-423 305.225,-421.159 310.709,-419.258 316.163,-417.386"/>
<polygon fill="#000000" stroke="#000000" points="317.552,-420.61 325.886,-414.067 315.291,-413.985 317.552,-420.61"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge20" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M201.547,-451.739C221.712,-434.028 261.403,-401.2 300,-381 306.507,-377.594 313.68,-374.57 320.768,-371.951"/>
<polygon fill="#000000" stroke="#000000" points="322.013,-375.224 330.309,-368.634 319.715,-368.612 322.013,-375.224"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge26" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M222.377,-460.049C241.962,-457.797 267.247,-454.891 290.906,-452.172"/>
<polygon fill="#000000" stroke="#000000" points="291.391,-455.639 300.926,-451.02 290.591,-448.685 291.391,-455.639"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge21" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M208.451,-451.914C225.503,-440.878 249.304,-423.099 264,-402 292.197,-361.519 265.051,-331.819 300,-297 307.111,-289.916 316.694,-285.22 326.199,-282.108"/>
<polygon fill="#000000" stroke="#000000" points="327.263,-285.445 335.967,-279.405 325.396,-278.699 327.263,-285.445"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge22" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M222.377,-475.854C249.605,-485.243 287.849,-498.431 317.428,-508.631"/>
<polygon fill="#000000" stroke="#000000" points="316.504,-512.014 327.099,-511.965 318.786,-505.396 316.504,-512.014"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge24" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M206.509,-451.845C222.99,-440.381 247.05,-422.009 264,-402 284.845,-377.393 275.11,-359.506 300,-339 307.472,-332.844 316.837,-328.46 326.007,-325.35"/>
<polygon fill="#000000" stroke="#000000" points="327.19,-328.65 335.782,-322.451 325.2,-321.938 327.19,-328.65"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_node17" class="node"><title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="775,-535 711,-535 711,-511 775,-511 775,-535"/>
<text text-anchor="middle" x="743" y="-520.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_edge27" class="edge"><title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M667.166,-544.483C677.713,-541.455 689.781,-537.991 701.102,-534.741"/>
<polygon fill="#000000" stroke="#000000" points="702.155,-538.08 710.801,-531.957 700.224,-531.352 702.155,-538.08"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node12" class="node"><title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="542.5,-24 481.5,-24 481.5,-0 542.5,-0 542.5,-24"/>
<text text-anchor="middle" x="512" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge29" class="edge"><title>proc~pf_broadcast&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M400.715,-43.51C422.249,-37.3575 449.458,-29.5834 471.462,-23.2966"/>
<polygon fill="#000000" stroke="#000000" points="472.513,-26.6365 481.167,-20.5238 470.59,-19.9058 472.513,-26.6365"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node18" class="node"><title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="544,-66 480,-66 480,-42 544,-42 544,-66"/>
<text text-anchor="middle" x="512" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge28" class="edge"><title>proc~pf_broadcast&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M400.715,-54C421.616,-54 447.865,-54 469.51,-54"/>
<polygon fill="#000000" stroke="#000000" points="469.723,-57.5001 479.722,-54 469.722,-50.5001 469.723,-57.5001"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge31" class="edge"><title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M543.281,-589.888C559.272,-583.491 579.085,-575.566 596.244,-568.703"/>
<polygon fill="#000000" stroke="#000000" points="598.005,-571.768 605.99,-564.804 595.405,-565.268 598.005,-571.768"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge30" class="edge"><title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M527.052,-589.611C548.375,-570.813 589.059,-534.944 614.082,-512.883"/>
<polygon fill="#000000" stroke="#000000" points="616.425,-515.483 621.612,-506.244 611.796,-510.232 616.425,-515.483"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_edge32" class="edge"><title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M668.571,-502.622C678.796,-505.46 690.325,-508.66 701.165,-511.668"/>
<polygon fill="#000000" stroke="#000000" points="700.297,-515.059 710.869,-514.361 702.169,-508.314 700.297,-515.059"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge37" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M407.813,-414.016C449.684,-426.767 513.437,-449.575 562,-482 568.024,-486.022 596.277,-513.81 615.944,-533.402"/>
<polygon fill="#000000" stroke="#000000" points="613.7,-536.108 623.25,-540.697 618.646,-531.155 613.7,-536.108"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge33" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M412.518,-414.038C417.394,-416.495 422.009,-419.45 426,-423 474.193,-465.871 497.387,-541.96 506.35,-579.614"/>
<polygon fill="#000000" stroke="#000000" points="502.982,-580.589 508.599,-589.573 509.81,-579.047 502.982,-580.589"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge36" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M426.179,-396.976C466.688,-396.214 519.679,-400.09 562,-420 587.115,-431.815 608.505,-456.011 621.626,-473.526"/>
<polygon fill="#000000" stroke="#000000" points="619.027,-475.905 627.711,-481.975 624.707,-471.815 619.027,-475.905"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~pf_block_run~~CallsGraph_node22" class="node"><title>proc~restrict_ts</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node22"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-192 482.5,-192 482.5,-168 541.5,-168 541.5,-192"/>
<text text-anchor="middle" x="512" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~pf_block_run~~CallsGraph_edge35" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M414.716,-389.828C418.888,-387.401 422.744,-384.491 426,-381 468.94,-334.961 434.322,-300.546 462,-244 469.898,-227.865 482.197,-211.818 492.496,-199.829"/>
<polygon fill="#000000" stroke="#000000" points="495.22,-202.032 499.229,-192.225 489.979,-197.392 495.22,-202.032"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~pf_block_run~~CallsGraph_node24" class="node"><title>proc~restrict_ts_integral</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node24"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-150 462,-150 462,-126 562,-126 562,-150"/>
<text text-anchor="middle" x="512" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~pf_block_run~~CallsGraph_edge34" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M415.368,-389.969C419.353,-387.512 422.989,-384.556 426,-381 490.583,-304.71 400.453,-237.759 462,-159 462.684,-158.125 463.411,-157.286 464.177,-156.481"/>
<polygon fill="#000000" stroke="#000000" points="466.416,-159.171 471.939,-150.129 461.984,-153.753 466.416,-159.171"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge40" class="edge"><title>proc~pf_residual&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M395.54,-363.209C438.423,-369.155 515.134,-385.635 562,-430 591.794,-458.204 575.185,-480.903 598,-515 602.394,-521.567 608.02,-527.974 613.571,-533.6"/>
<polygon fill="#000000" stroke="#000000" points="611.339,-536.311 620.969,-540.728 616.196,-531.27 611.339,-536.311"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge39" class="edge"><title>proc~pf_residual&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M395.683,-358.416C437.037,-357.831 510.225,-362.006 562,-394 592.472,-412.83 614.364,-449.377 625.969,-472.688"/>
<polygon fill="#000000" stroke="#000000" points="622.841,-474.261 630.307,-481.778 629.158,-471.246 622.841,-474.261"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_block_run~~CallsGraph_node21" class="node"><title>proc~pf_set_resid</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node21"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="547.5,-108 476.5,-108 476.5,-84 547.5,-84 547.5,-108"/>
<text text-anchor="middle" x="512" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_residual&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_block_run~~CallsGraph_edge38" class="edge"><title>proc~pf_residual&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M395.54,-356.122C406.699,-353.178 418.363,-348.021 426,-339 490.583,-262.71 400.453,-195.759 462,-117 463.646,-114.894 465.543,-112.996 467.615,-111.286"/>
<polygon fill="#000000" stroke="#000000" points="469.869,-113.993 476.307,-105.578 466.027,-108.142 469.869,-113.993"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge44" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M394.093,-456.081C443.455,-475.899 541.595,-515.3 596.319,-537.27"/>
<polygon fill="#000000" stroke="#000000" points="595.102,-540.553 605.686,-541.031 597.71,-534.057 595.102,-540.553"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge41" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M377.682,-456.282C390.504,-467.963 410.034,-486.196 426,-503 450.985,-529.297 477.969,-561.429 494.677,-581.809"/>
<polygon fill="#000000" stroke="#000000" points="492.139,-584.235 501.172,-589.772 497.564,-579.811 492.139,-584.235"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge43" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M409.872,-431.945C450.96,-423.394 512.232,-416.266 562,-434 584.518,-442.024 605.126,-460.233 618.753,-474.5"/>
<polygon fill="#000000" stroke="#000000" points="616.233,-476.93 625.573,-481.931 621.39,-472.197 616.233,-476.93"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_node23" class="node"><title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node23"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="675,-192 598,-192 598,-168 675,-168 675,-192"/>
<text text-anchor="middle" x="636.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge42" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M409.058,-431.951C414.998,-429.454 420.816,-426.493 426,-423 518.483,-360.683 594.445,-247.215 623.163,-200.716"/>
<polygon fill="#000000" stroke="#000000" points="626.2,-202.458 628.416,-192.097 620.223,-198.815 626.2,-202.458"/>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge46" class="edge"><title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.128,-273.396C402.778,-270.761 417.115,-265.495 426,-255 490.583,-178.71 400.453,-111.759 462,-33 464.833,-29.3742 468.415,-26.3646 472.346,-23.8688"/>
<polygon fill="#000000" stroke="#000000" points="474.099,-26.9024 481.358,-19.1855 470.871,-20.6911 474.099,-26.9024"/>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge45" class="edge"><title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.282,-273.192C402.814,-270.5 416.999,-265.245 426,-255 479.845,-193.708 410.596,-138.353 462,-75 464.551,-71.8557 467.662,-69.1727 471.066,-66.8853"/>
<polygon fill="#000000" stroke="#000000" points="472.908,-69.8661 479.98,-61.9766 469.532,-63.7343 472.908,-69.8661"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge49" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M403.512,-530.156C421.35,-532.803 442.705,-535.789 462,-538 507.732,-543.239 560.435,-547.552 595.642,-550.187"/>
<polygon fill="#000000" stroke="#000000" points="595.748,-553.705 605.979,-550.951 596.264,-546.724 595.748,-553.705"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge47" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M396.523,-536.003C406.225,-540.015 416.737,-544.803 426,-550 443.213,-559.657 445.243,-565.572 462,-576 467.028,-579.129 472.469,-582.256 477.833,-585.2"/>
<polygon fill="#000000" stroke="#000000" points="476.235,-588.314 486.702,-589.951 479.54,-582.144 476.235,-588.314"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge48" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M403.769,-519.606C454.753,-513.972 542.719,-504.252 594.357,-498.546"/>
<polygon fill="#000000" stroke="#000000" points="594.934,-502.004 604.489,-497.427 594.165,-495.046 594.934,-502.004"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge51" class="edge"><title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.239,-315.488C402.919,-312.878 417.248,-307.607 426,-297 501.366,-205.66 390.267,-127.22 462,-33 464.787,-29.3387 468.34,-26.3075 472.256,-23.7997"/>
<polygon fill="#000000" stroke="#000000" points="474.007,-26.8341 481.253,-19.1043 470.768,-20.6285 474.007,-26.8341"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge50" class="edge"><title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.128,-315.396C402.778,-312.761 417.115,-307.495 426,-297 490.583,-220.71 400.453,-153.759 462,-75 464.493,-71.8095 467.565,-69.0961 470.946,-66.79"/>
<polygon fill="#000000" stroke="#000000" points="472.786,-69.7716 479.829,-61.8568 469.388,-63.6519 472.786,-69.7716"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge52" class="edge"><title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M541.721,-180C555.281,-180 571.838,-180 587.244,-180"/>
<polygon fill="#000000" stroke="#000000" points="587.676,-183.5 597.676,-180 587.676,-176.5 587.676,-183.5"/>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge53" class="edge"><title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M548.104,-150.036C561.431,-154.605 576.791,-159.871 590.88,-164.702"/>
<polygon fill="#000000" stroke="#000000" points="589.797,-168.03 600.391,-167.963 592.067,-161.409 589.797,-168.03"/>
</g>
</g>
</svg>
</div><script>var panprocpf_block_runCallsGraph = svgPanZoom('#procpf_block_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_block_runCalledByGraph" width="196pt" height="32pt"
 viewBox="0.00 0.00 196.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_block_run~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 192,-28 192,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="188,-24 114,-24 114,-0 188,-0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node2" class="node"><title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,-0 78,-0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_edge1" class="edge"><title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.164,-12C86.3694,-12 95.1281,-12 103.607,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.755,-15.5001 113.754,-12 103.754,-8.5001 103.755,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev_p</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest level in V (Lambda)-cycle</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_max_depth</span> <span class="c">!!  Finest level in V-cycle</span>


    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c">! set finest level to visit in the following run</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k</span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>

       <span class="c">!&gt; Reset some flags</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pfblock</span> <span class="o">=</span> <span class="n">k</span>


       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">!&gt;  Start the loops over SDC sweeps</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

       <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>

          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>

          <span class="c">!  Do a v_cycle</span>
          <span class="k">call </span><span class="n">pf_v_cycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index_c</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

          <span class="c">!  Check for convergence</span>
          <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>

<span class="c">!          print *,pf%rank, &#39; post res&#39;</span>
          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

          <span class="c">!  If we are converged, exit block</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">exit</span>
<span class="k">       end do</span>  <span class="c">!  Loop over the iteration in this bloc</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
       <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_STEP</span><span class="p">)</span>
    <span class="k">end do</span> <span class="c">!  Loop over the blocks</span>

    <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_block_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>