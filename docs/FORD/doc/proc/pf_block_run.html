<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_block_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">83 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST controller for block mode
  When starting a new block, broadcast new initial conditions to all procs
  For initial block, this is done when initial conditions are set
 Reset some flags
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the loops over SDC sweeps</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E24"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E3"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E18"></span>real(kind=pfdp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E6"></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E3"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E44"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_block_runCallsGraph" width="641pt" height="518pt"
 viewBox="0.00 0.00 641.00 517.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CallsGraph" class="graph" transform="scale(.9385 .9385) rotate(0) translate(4 547.6158)">
<title>proc~~pf_block_run~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-547.6158 679,-547.6158 679,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CallsGraph_node1" class="node">
<title>proc~pf_block_run</title>
<polygon fill="none" stroke="#000000" points="74,-319.6158 0,-319.6158 0,-295.6158 74,-295.6158 74,-319.6158"/>
<text text-anchor="middle" x="37" y="-305.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_block_run</text>
</g>
<!-- proc~pf_vcycle_pysdc -->
<g id="proc~~pf_block_run~~CallsGraph_node2" class="node">
<title>proc~pf_vcycle_pysdc</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_vcycle_pysdc.html" xlink:title="pf_Vcycle_pySDC">
<polygon fill="#d9534f" stroke="#d9534f" points="235.5,-340.6158 138.5,-340.6158 138.5,-316.6158 235.5,-316.6158 235.5,-340.6158"/>
<text text-anchor="middle" x="187" y="-326.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_Vcycle_pySDC</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_vcycle_pysdc -->
<g id="proc~~pf_block_run~~CallsGraph_edge1" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_vcycle_pysdc</title>
<path fill="none" stroke="#000000" d="M74.0787,-312.8069C90.4756,-315.1024 110.1542,-317.8574 128.4574,-320.4199"/>
<polygon fill="#000000" stroke="#000000" points="128.066,-323.8991 138.4547,-321.8195 129.0366,-316.9667 128.066,-323.8991"/>
</g>
<!-- proc~pf_set_resid -->
<g id="proc~~pf_block_run~~CallsGraph_node3" class="node">
<title>proc~pf_set_resid</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node3"><a xlink:href=".././proc/pf_set_resid.html" xlink:title="pf_set_resid">
<polygon fill="#d9534f" stroke="#d9534f" points="547.5,-543.6158 476.5,-543.6158 476.5,-519.6158 547.5,-519.6158 547.5,-543.6158"/>
<text text-anchor="middle" x="512" y="-529.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_resid</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_block_run~~CallsGraph_edge2" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M39.7356,-319.6778C46.6119,-347.2753 67.2113,-415.4904 110,-452.6158 212.2672,-541.3476 384.72,-541.8005 466.4343,-536.199"/>
<polygon fill="#000000" stroke="#000000" points="466.6972,-539.6892 476.4084,-535.4534 466.1753,-532.7087 466.6972,-539.6892"/>
</g>
<!-- proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_node4" class="node">
<title>proc~pf_check_convergence_block</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node4"><a xlink:href=".././proc/pf_check_convergence_block.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-132.6158 110,-132.6158 110,-108.6158 264,-108.6158 264,-132.6158"/>
<text text-anchor="middle" x="187" y="-118.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_edge3" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block</title>
<path fill="none" stroke="#000000" d="M46.8419,-295.3462C72.1706,-263.7699 139.7932,-179.467 170.9158,-140.6674"/>
<polygon fill="#000000" stroke="#000000" points="173.7899,-142.6781 177.3168,-132.6875 168.3295,-138.2981 173.7899,-142.6781"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_node5" class="node">
<title>proc~call_hooks</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node5"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="543.5,-424.6158 480.5,-424.6158 480.5,-400.6158 543.5,-400.6158 543.5,-424.6158"/>
<text text-anchor="middle" x="512" y="-410.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge4" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M45.332,-319.6474C57.8551,-337.1018 82.9603,-369.7452 110,-391.6158 185.0149,-452.2904 206.5764,-472.5188 300,-496.6158 354.2253,-510.6023 374.1376,-517.7414 426,-496.6158 457.3173,-483.8591 483.4417,-453.6023 498.4017,-433.107"/>
<polygon fill="#000000" stroke="#000000" points="501.3983,-434.9304 504.2904,-424.7379 495.6734,-430.9023 501.3983,-434.9304"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_node6" class="node">
<title>proc~pf_broadcast</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node6"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="224.5,-29.6158 149.5,-29.6158 149.5,-5.6158 224.5,-5.6158 224.5,-29.6158"/>
<text text-anchor="middle" x="187" y="-15.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_edge5" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M39.2214,-295.5509C47.6319,-250.9189 78.6368,-95.7798 110,-57.6158 118.1507,-47.6978 129.4075,-39.9503 140.7992,-34.0275"/>
<polygon fill="#000000" stroke="#000000" points="142.4024,-37.1404 149.9073,-29.662 139.3768,-30.828 142.4024,-37.1404"/>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_node7" class="node">
<title>proc~pf_predictor</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node7"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="222,-382.6158 152,-382.6158 152,-358.6158 222,-358.6158 222,-382.6158"/>
<text text-anchor="middle" x="187" y="-368.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_edge6" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M54.9341,-319.6743C69.3177,-328.9096 90.2896,-341.4175 110,-349.6158 120.0831,-353.8098 131.2557,-357.4118 141.8914,-360.3888"/>
<polygon fill="#000000" stroke="#000000" points="141.3066,-363.8551 151.8709,-363.0505 143.1106,-357.0916 141.3066,-363.8551"/>
</g>
<!-- proc~pf_set_iter -->
<g id="proc~~pf_block_run~~CallsGraph_node8" class="node">
<title>proc~pf_set_iter</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node8"><a xlink:href=".././proc/pf_set_iter.html" xlink:title="pf_set_iter">
<polygon fill="#d9534f" stroke="#d9534f" points="218.5,-90.6158 155.5,-90.6158 155.5,-66.6158 218.5,-66.6158 218.5,-90.6158"/>
<text text-anchor="middle" x="187" y="-76.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_iter</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_set_iter -->
<g id="proc~~pf_block_run~~CallsGraph_edge7" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_set_iter</title>
<path fill="none" stroke="#000000" d="M37.511,-295.4423C39.6856,-259.7636 51.0423,-154.514 110,-99.6158 119.6021,-90.6749 132.6351,-85.4751 145.2474,-82.4721"/>
<polygon fill="#000000" stroke="#000000" points="146.067,-85.8779 155.1985,-80.5052 144.7096,-79.0107 146.067,-85.8779"/>
</g>
<!-- proc~pf_vcycle -->
<g id="proc~~pf_block_run~~CallsGraph_node9" class="node">
<title>proc~pf_vcycle</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node9"><a xlink:href=".././proc/pf_vcycle.html" xlink:title="pf_Vcycle">
<polygon fill="#d9534f" stroke="#d9534f" points="216,-298.6158 158,-298.6158 158,-274.6158 216,-274.6158 216,-298.6158"/>
<text text-anchor="middle" x="187" y="-284.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_Vcycle</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_vcycle -->
<g id="proc~~pf_block_run~~CallsGraph_edge8" class="edge">
<title>proc~pf_block_run&#45;&gt;proc~pf_vcycle</title>
<path fill="none" stroke="#000000" d="M74.0787,-302.4248C96.4984,-299.2861 125.0533,-295.2884 147.8387,-292.0984"/>
<polygon fill="#000000" stroke="#000000" points="148.4408,-295.5484 157.8589,-290.6956 147.4702,-288.616 148.4408,-295.5484"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_node11" class="node">
<title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node11"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="425,-424.6158 301,-424.6158 301,-400.6158 425,-400.6158 425,-424.6158"/>
<text text-anchor="middle" x="363" y="-410.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge9" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M235.6841,-337.1748C245.5188,-340.175 255.4526,-344.2068 264,-349.6158 284.775,-362.7629 279.5978,-377.8974 300,-391.6158 302.4218,-393.2442 304.9805,-394.7559 307.6256,-396.158"/>
<polygon fill="#000000" stroke="#000000" points="306.3387,-399.4206 316.877,-400.5135 309.3204,-393.0874 306.3387,-399.4206"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_node12" class="node">
<title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node12"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="426,-382.6158 300,-382.6158 300,-358.6158 426,-358.6158 426,-382.6158"/>
<text text-anchor="middle" x="363" y="-368.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge10" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M235.5587,-340.2037C256.2938,-345.1519 280.7125,-350.979 302.5975,-356.2016"/>
<polygon fill="#000000" stroke="#000000" points="301.9129,-359.6364 312.4522,-358.5533 303.5378,-352.8276 301.9129,-359.6364"/>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node13" class="node">
<title>proc~pf_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node13"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="395.5,-466.6158 330.5,-466.6158 330.5,-442.6158 395.5,-442.6158 395.5,-466.6158"/>
<text text-anchor="middle" x="363" y="-452.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge11" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M235.8877,-334.9096C246.042,-338.044 256.0557,-342.7031 264,-349.6158 294.6412,-376.2784 270.1103,-406.1134 300,-433.6158 305.9057,-439.0499 313.2577,-443.0814 320.8329,-446.0714"/>
<polygon fill="#000000" stroke="#000000" points="319.861,-449.4375 330.4553,-449.3288 322.1056,-442.8071 319.861,-449.4375"/>
</g>
<!-- proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_node15" class="node">
<title>proc~interpolate_q0</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node15"><a xlink:href=".././proc/interpolate_q0.html" xlink:title="interpolate_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-256.6158 322.5,-256.6158 322.5,-232.6158 403.5,-232.6158 403.5,-256.6158"/>
<text text-anchor="middle" x="363" y="-242.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interpolate_q0</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge12" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M235.6841,-320.0568C245.5188,-317.0567 255.4526,-313.0249 264,-307.6158 284.775,-294.4688 279.5978,-279.3342 300,-265.6158 304.0333,-262.9039 308.4466,-260.5156 313.0054,-258.418"/>
<polygon fill="#000000" stroke="#000000" points="314.5791,-261.5551 322.4922,-254.51 311.9129,-255.0828 314.5791,-261.5551"/>
</g>
<!-- proc~pf_delta_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_node16" class="node">
<title>proc~pf_delta_q0</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node16"><a xlink:href=".././proc/pf_delta_q0.html" xlink:title="pf_delta_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="397.5,-214.6158 328.5,-214.6158 328.5,-190.6158 397.5,-190.6158 397.5,-214.6158"/>
<text text-anchor="middle" x="363" y="-200.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_delta_q0</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~pf_delta_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge13" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~pf_delta_q0</title>
<path fill="none" stroke="#000000" d="M235.8877,-322.3221C246.042,-319.1877 256.0557,-314.5286 264,-307.6158 294.6412,-280.9533 270.1103,-251.1183 300,-223.6158 305.4245,-218.6246 312.0692,-214.8166 318.9863,-211.9121"/>
<polygon fill="#000000" stroke="#000000" points="320.2766,-215.1675 328.4984,-208.4853 317.904,-208.5819 320.2766,-215.1675"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_node17" class="node">
<title>proc~pf_send</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node17"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-298.6158 336,-298.6158 336,-274.6158 390,-274.6158 390,-298.6158"/>
<text text-anchor="middle" x="363" y="-284.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge14" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M235.5587,-317.028C264.1228,-310.2115 299.6773,-301.7269 325.9689,-295.4528"/>
<polygon fill="#000000" stroke="#000000" points="326.9968,-298.8059 335.9113,-293.0802 325.3719,-291.9971 326.9968,-298.8059"/>
</g>
<!-- proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_node18" class="node">
<title>proc~pf_post</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node18"><a xlink:href=".././proc/pf_post.html" xlink:title="pf_post">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-172.6158 336,-172.6158 336,-148.6158 390,-148.6158 390,-172.6158"/>
<text text-anchor="middle" x="363" y="-158.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_post</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_edge15" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~pf_post</title>
<path fill="none" stroke="#000000" d="M235.7603,-323.2937C246.1603,-320.1288 256.3118,-315.212 264,-307.6158 305.4298,-266.6821 259.7218,-223.6833 300,-181.6158 306.9237,-174.3846 316.399,-169.6428 325.8983,-166.5337"/>
<polygon fill="#000000" stroke="#000000" points="326.9802,-169.8663 335.7002,-163.8487 325.1308,-163.115 326.9802,-169.8663"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_node19" class="node">
<title>proc~pf_recv</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node19"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-340.6158 336,-340.6158 336,-316.6158 390,-316.6158 390,-340.6158"/>
<text text-anchor="middle" x="363" y="-326.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_vcycle_pysdc&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge16" class="edge">
<title>proc~pf_vcycle_pysdc&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M235.5587,-328.6158C263.9964,-328.6158 299.3628,-328.6158 325.6193,-328.6158"/>
<polygon fill="#000000" stroke="#000000" points="325.9113,-332.1159 335.9113,-328.6158 325.9112,-325.1159 325.9113,-332.1159"/>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge17" class="edge">
<title>proc~pf_check_convergence_block&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M264.2914,-116.6976C325.1026,-115.393 403.2459,-118.2426 426,-139.6158 508.4631,-217.0745 392.8545,-302.0675 462,-391.6158 464.6218,-395.0112 467.8941,-397.8631 471.5024,-400.2576"/>
<polygon fill="#000000" stroke="#000000" points="469.9215,-403.3816 480.3834,-405.0547 473.2483,-397.2226 469.9215,-403.3816"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_node14" class="node">
<title>proc~pf_send_status</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="405.5,-50.6158 320.5,-50.6158 320.5,-26.6158 405.5,-26.6158 405.5,-50.6158"/>
<text text-anchor="middle" x="363" y="-36.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_edge18" class="edge">
<title>proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M245.2781,-108.6144C251.8304,-106.1441 258.2192,-103.1769 264,-99.6158 284.3638,-87.0713 279.9921,-72.7205 300,-59.6158 303.3756,-57.4049 307.0058,-55.406 310.7578,-53.6025"/>
<polygon fill="#000000" stroke="#000000" points="312.4585,-56.6809 320.2599,-49.5123 309.6908,-50.2513 312.4585,-56.6809"/>
</g>
<!-- proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node20" class="node">
<title>proc~pf_check_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node20"><a xlink:href=".././proc/pf_check_residual.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="412.5,-92.6158 313.5,-92.6158 313.5,-68.6158 412.5,-68.6158 412.5,-92.6158"/>
<text text-anchor="middle" x="363" y="-78.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge19" class="edge">
<title>proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual</title>
<path fill="none" stroke="#000000" d="M239.8058,-108.6145C259.8192,-104.066 282.7403,-98.8567 303.3415,-94.1746"/>
<polygon fill="#000000" stroke="#000000" points="304.2699,-97.5529 313.2455,-91.9237 302.7185,-90.727 304.2699,-97.5529"/>
</g>
<!-- pf_stop -->
<g id="proc~~pf_block_run~~CallsGraph_node10" class="node">
<title>pf_stop</title>
<polygon fill="#777777" stroke="#777777" points="539,-111.6158 485,-111.6158 485,-87.6158 539,-87.6158 539,-111.6158"/>
<text text-anchor="middle" x="512" y="-97.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;pf_stop -->
<g id="proc~~pf_block_run~~CallsGraph_edge20" class="edge">
<title>proc~pf_broadcast&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M224.6429,-9.2796C273.1452,-.3708 359.1663,9.1401 426,-17.6158 456.864,-29.9718 482.9495,-59.2659 498.0422,-79.2766"/>
<polygon fill="#000000" stroke="#000000" points="495.2866,-81.4384 504.0001,-87.4654 500.947,-77.3201 495.2866,-81.4384"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge24" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M195.1648,-382.766C211.6844,-406.1143 251.6449,-456.6178 300,-475.6158 352.1216,-496.0937 372.7749,-493.0253 426,-475.6158 452.304,-467.012 477.2209,-446.9649 493.3966,-431.7782"/>
<polygon fill="#000000" stroke="#000000" points="495.8642,-434.2607 500.6031,-424.7848 490.9892,-429.2373 495.8642,-434.2607"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge21" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M222.1932,-379.0142C245.1426,-384.4908 275.6956,-391.7818 302.4753,-398.1725"/>
<polygon fill="#000000" stroke="#000000" points="301.9912,-401.6551 312.5305,-400.572 303.616,-394.8463 301.9912,-401.6551"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge22" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M222.1932,-370.6158C241.505,-370.6158 266.201,-370.6158 289.5021,-370.6158"/>
<polygon fill="#000000" stroke="#000000" points="289.7329,-374.1159 299.7329,-370.6158 289.7329,-367.1159 289.7329,-374.1159"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge23" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M206.0314,-382.6789C228.0472,-396.2862 265.6767,-418.4862 300,-433.6158 306.4501,-436.459 313.4128,-439.142 320.2753,-441.5791"/>
<polygon fill="#000000" stroke="#000000" points="319.5921,-445.0442 330.1866,-444.9638 321.8543,-438.4198 319.5921,-445.0442"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge25" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M222.1573,-365.6124C235.9645,-362.5136 251.4717,-357.5442 264,-349.6158 284.775,-336.4688 279.5978,-321.3342 300,-307.6158 307.8692,-302.3246 317.1851,-298.2656 326.2058,-295.1933"/>
<polygon fill="#000000" stroke="#000000" points="327.2718,-298.5273 335.7959,-292.2351 325.2085,-291.8383 327.2718,-298.5273"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge26" class="edge">
<title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M222.1932,-362.2175C252.2956,-355.0339 295.4799,-344.7286 326.0716,-337.4283"/>
<polygon fill="#000000" stroke="#000000" points="327.0118,-340.8023 335.9263,-335.0766 325.387,-333.9935 327.0118,-340.8023"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge27" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M216.2131,-288.4958C231.9703,-290.889 250.8292,-296.1552 264,-307.6158 294.6412,-334.2784 270.1103,-364.1134 300,-391.6158 301.3124,-392.8234 302.6962,-393.9617 304.138,-395.0347"/>
<polygon fill="#000000" stroke="#000000" points="302.5938,-398.1955 312.9363,-400.4937 306.2843,-392.2474 302.5938,-398.1955"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge28" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M216.0931,-290.3509C231.2602,-293.2981 249.5983,-298.502 264,-307.6158 284.775,-320.7629 279.5978,-335.8974 300,-349.6158 302.4218,-351.2442 304.9805,-352.7559 307.6256,-354.158"/>
<polygon fill="#000000" stroke="#000000" points="306.3387,-357.4206 316.877,-358.5135 309.3204,-351.0874 306.3387,-357.4206"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge29" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M216.0375,-287.7667C232.1334,-289.9003 251.3834,-295.1503 264,-307.6158 305.4298,-348.5495 259.7218,-391.5484 300,-433.6158 305.6062,-439.4711 312.8854,-443.6942 320.4956,-446.7399"/>
<polygon fill="#000000" stroke="#000000" points="319.6173,-450.137 330.2113,-450.0024 321.8457,-443.5011 319.6173,-450.137"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge30" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M216.0628,-279.6804C242.2285,-273.4363 281.2601,-264.122 312.5199,-256.6622"/>
<polygon fill="#000000" stroke="#000000" points="313.4555,-260.0373 322.3699,-254.3116 311.8306,-253.2285 313.4555,-260.0373"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~pf_delta_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge31" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~pf_delta_q0</title>
<path fill="none" stroke="#000000" d="M206.0314,-274.5527C228.0472,-260.9455 265.6767,-238.7455 300,-223.6158 305.8847,-221.0219 312.1961,-218.5613 318.4688,-216.2991"/>
<polygon fill="#000000" stroke="#000000" points="319.9248,-219.4988 328.2271,-212.9169 317.6323,-212.8848 319.9248,-219.4988"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge32" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M216.0628,-286.6158C246.1049,-286.6158 293.1074,-286.6158 325.8343,-286.6158"/>
<polygon fill="#000000" stroke="#000000" points="325.9188,-290.1159 335.9188,-286.6158 325.9187,-283.1159 325.9188,-290.1159"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_edge33" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~pf_post</title>
<path fill="none" stroke="#000000" d="M196.9326,-274.4521C215.1879,-252.8358 256.2338,-207.5679 300,-181.6158 307.9977,-176.8734 317.2088,-173.0349 326.0751,-170.0014"/>
<polygon fill="#000000" stroke="#000000" points="327.3736,-173.2618 335.8558,-166.9133 325.266,-166.5866 327.3736,-173.2618"/>
</g>
<!-- proc~pf_vcycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge34" class="edge">
<title>proc~pf_vcycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M216.0628,-293.5513C246.1049,-300.7204 293.1074,-311.9369 325.8343,-319.7468"/>
<polygon fill="#000000" stroke="#000000" points="325.3794,-323.2364 335.9188,-322.1533 327.0043,-316.4276 325.3794,-323.2364"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge36" class="edge">
<title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M425.3261,-412.6158C440.4504,-412.6158 456.2627,-412.6158 470.178,-412.6158"/>
<polygon fill="#000000" stroke="#000000" points="470.4067,-416.1159 480.4066,-412.6158 470.4066,-409.1159 470.4067,-416.1159"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_node23" class="node">
<title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node23"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="675,-382.6158 598,-382.6158 598,-358.6158 675,-358.6158 675,-382.6158"/>
<text text-anchor="middle" x="636.5" y="-368.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge35" class="edge">
<title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M395.4442,-424.6648C435.7555,-437.7141 506.0523,-454.1004 562,-433.6158 585.352,-425.0658 606.422,-405.6026 620.1471,-390.5553"/>
<polygon fill="#000000" stroke="#000000" points="623.0296,-392.5764 626.9845,-382.7473 617.7633,-387.9647 623.0296,-392.5764"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge37" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M405.6974,-382.6514C426.0015,-388.3747 450.1855,-395.1916 470.353,-400.8764"/>
<polygon fill="#000000" stroke="#000000" points="469.6183,-404.3056 480.1928,-403.6501 471.5175,-397.5682 469.6183,-404.3056"/>
</g>
<!-- proc~restrict_ts -->
<g id="proc~~pf_block_run~~CallsGraph_node22" class="node">
<title>proc~restrict_ts</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node22"><a xlink:href=".././proc/restrict_ts.html" xlink:title="restrict_ts">
<polygon fill="#d9534f" stroke="#d9534f" points="541.5,-382.6158 482.5,-382.6158 482.5,-358.6158 541.5,-358.6158 541.5,-382.6158"/>
<text text-anchor="middle" x="512" y="-368.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts -->
<g id="proc~~pf_block_run~~CallsGraph_edge38" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts</title>
<path fill="none" stroke="#000000" d="M426.1894,-370.6158C441.7379,-370.6158 457.9593,-370.6158 472.0591,-370.6158"/>
<polygon fill="#000000" stroke="#000000" points="472.3815,-374.1159 482.3815,-370.6158 472.3814,-367.1159 472.3815,-374.1159"/>
</g>
<!-- proc~restrict_ts_integral -->
<g id="proc~~pf_block_run~~CallsGraph_node26" class="node">
<title>proc~restrict_ts_integral</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node26"><a xlink:href=".././proc/restrict_ts_integral.html" xlink:title="restrict_ts_integral">
<polygon fill="#d9534f" stroke="#d9534f" points="562,-340.6158 462,-340.6158 462,-316.6158 562,-316.6158 562,-340.6158"/>
<text text-anchor="middle" x="512" y="-326.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">restrict_ts_integral</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral -->
<g id="proc~~pf_block_run~~CallsGraph_edge39" class="edge">
<title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_ts_integral</title>
<path fill="none" stroke="#000000" d="M405.6974,-358.5803C422.375,-353.8793 441.6702,-348.4403 459.2071,-343.4971"/>
<polygon fill="#000000" stroke="#000000" points="460.621,-346.735 469.2963,-340.6531 458.7218,-339.9975 460.621,-346.735"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~pf_set_resid -->
<g id="proc~~pf_block_run~~CallsGraph_edge40" class="edge">
<title>proc~pf_residual&#45;&gt;proc~pf_set_resid</title>
<path fill="none" stroke="#000000" d="M386.2813,-466.6471C411.2833,-479.5676 451.202,-500.1968 479.3387,-514.7372"/>
<polygon fill="#000000" stroke="#000000" points="477.8998,-517.9333 488.3905,-519.415 481.1135,-511.7146 477.8998,-517.9333"/>
</g>
<!-- proc~pf_send_status&#45;&gt;pf_stop -->
<g id="proc~~pf_block_run~~CallsGraph_edge41" class="edge">
<title>proc~pf_send_status&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M401.5645,-50.6986C409.6965,-53.4613 418.1796,-56.5054 426,-59.6158 443.6126,-66.621 462.7739,-75.4137 478.5303,-82.9701"/>
<polygon fill="#000000" stroke="#000000" points="477.331,-86.2782 487.8565,-87.4883 480.383,-79.9785 477.331,-86.2782"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge42" class="edge">
<title>proc~interpolate_q0&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M403.6518,-251.7755C411.926,-254.865 419.9403,-259.2869 426,-265.6158 466.2782,-307.6833 423.3464,-348.0509 462,-391.6158 464.6996,-394.6585 467.9121,-397.2722 471.3874,-399.5152"/>
<polygon fill="#000000" stroke="#000000" points="469.9581,-402.7202 480.4253,-404.3601 473.2654,-396.5507 469.9581,-402.7202"/>
</g>
<!-- proc~pf_set_delta_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_node24" class="node">
<title>proc~pf_set_delta_q0</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node24"><a xlink:href=".././proc/pf_set_delta_q0.html" xlink:title="pf_set_delta_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="556.5,-214.6158 467.5,-214.6158 467.5,-190.6158 556.5,-190.6158 556.5,-214.6158"/>
<text text-anchor="middle" x="512" y="-200.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_set_delta_q0</text>
</a>
</g>
</g>
<!-- proc~pf_delta_q0&#45;&gt;proc~pf_set_delta_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge43" class="edge">
<title>proc~pf_delta_q0&#45;&gt;proc~pf_set_delta_q0</title>
<path fill="none" stroke="#000000" d="M397.5581,-202.6158C415.2744,-202.6158 437.2692,-202.6158 457.2282,-202.6158"/>
<polygon fill="#000000" stroke="#000000" points="457.4465,-206.1159 467.4465,-202.6158 457.4464,-199.1159 457.4465,-206.1159"/>
</g>
<!-- proc~pf_send&#45;&gt;pf_stop -->
<g id="proc~~pf_block_run~~CallsGraph_edge44" class="edge">
<title>proc~pf_send&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M390.0867,-282.7684C402.3005,-279.8321 416.1585,-274.6714 426,-265.6158 455.8897,-238.1134 443.3798,-217.7138 462,-181.6158 473.0543,-160.1856 487.5754,-136.7995 498.1188,-120.5062"/>
<polygon fill="#000000" stroke="#000000" points="501.2675,-122.0861 503.8106,-111.801 495.4087,-118.2554 501.2675,-122.0861"/>
</g>
<!-- proc~pf_post&#45;&gt;pf_stop -->
<g id="proc~~pf_block_run~~CallsGraph_edge45" class="edge">
<title>proc~pf_post&#45;&gt;pf_stop</title>
<path fill="none" stroke="#000000" d="M390.3289,-149.4275C414.2728,-139.625 449.2601,-125.3013 475.5773,-114.5271"/>
<polygon fill="#000000" stroke="#000000" points="476.916,-117.7611 484.8444,-110.7332 474.2638,-111.283 476.916,-117.7611"/>
</g>
<!-- pf_stop_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node21" class="node">
<title>pf_stop_timer</title>
<polygon fill="#777777" stroke="#777777" points="551,-298.6158 473,-298.6158 473,-274.6158 551,-274.6158 551,-298.6158"/>
<text text-anchor="middle" x="512" y="-284.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_stop_timer</text>
</g>
<!-- proc~pf_recv&#45;&gt;pf_stop_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge47" class="edge">
<title>proc~pf_recv&#45;&gt;pf_stop_timer</title>
<path fill="none" stroke="#000000" d="M390.3289,-320.9124C410.635,-315.1885 438.8836,-307.2258 463.0507,-300.4136"/>
<polygon fill="#000000" stroke="#000000" points="464.1006,-303.7542 472.7759,-297.6723 462.2014,-297.0167 464.1006,-303.7542"/>
</g>
<!-- pf_start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node25" class="node">
<title>pf_start_timer</title>
<polygon fill="#777777" stroke="#777777" points="551.5,-256.6158 472.5,-256.6158 472.5,-232.6158 551.5,-232.6158 551.5,-256.6158"/>
<text text-anchor="middle" x="512" y="-242.2158" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_start_timer</text>
</g>
<!-- proc~pf_recv&#45;&gt;pf_start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge46" class="edge">
<title>proc~pf_recv&#45;&gt;pf_start_timer</title>
<path fill="none" stroke="#000000" d="M390.2041,-322.9966C401.8864,-319.7411 415.2845,-314.8209 426,-307.6158 446.4022,-293.8974 442.1328,-280.0982 462,-265.6158 464.0304,-264.1357 466.1809,-262.736 468.4044,-261.416"/>
<polygon fill="#000000" stroke="#000000" points="470.0549,-264.5024 477.2421,-256.7182 466.7693,-258.3214 470.0549,-264.5024"/>
</g>
<!-- proc~restrict_ts&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge48" class="edge">
<title>proc~restrict_ts&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M541.5048,-370.6158C555.3075,-370.6158 572.1129,-370.6158 587.7295,-370.6158"/>
<polygon fill="#000000" stroke="#000000" points="587.7766,-374.1159 597.7766,-370.6158 587.7765,-367.1159 587.7766,-374.1159"/>
</g>
<!-- proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge49" class="edge">
<title>proc~restrict_ts_integral&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M547.6767,-340.6514C561.2213,-345.2206 576.8321,-350.4869 591.1519,-355.3177"/>
<polygon fill="#000000" stroke="#000000" points="590.2239,-358.6984 600.8181,-358.5786 592.4615,-352.0656 590.2239,-358.6984"/>
</g>
</g>
</svg>
</div><script>var panprocpf_block_runCallsGraph = svgPanZoom('#procpf_block_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~pf_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_block_runCalledByGraph" width="196pt" height="32pt"
 viewBox="0.00 0.00 196.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_block_run~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 192,-28 192,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node1" class="node">
<title>proc~pf_block_run</title>
<polygon fill="none" stroke="#000000" points="188,-24 114,-24 114,0 188,0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pf_block_run</text>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node2" class="node">
<title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,0 78,0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_edge1" class="edge">
<title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.1722,-12C86.424,-12 95.2132,-12 103.7265,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.9195,-15.5001 113.9195,-12 103.9195,-8.5001 103.9195,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest level in V (Lambda)-cycle</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_max_depth</span> <span class="c">!!  Finest level in V-cycle</span>



    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c">! set finest level to visit in the following run</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_BLOCK</span><span class="p">)</span>

       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k</span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  0.  choose time step</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>

       <span class="c">!&gt; Reset some flags</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pfblock</span> <span class="o">=</span> <span class="n">k</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">sweep</span> <span class="o">=</span> <span class="mi">1</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">!&gt;  Start the loops over SDC sweeps</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">pf_set_resid</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">lev</span><span class="p">%</span><span class="nb">index</span><span class="p">,</span><span class="n">lev</span><span class="p">%</span><span class="n">residual</span><span class="p">)</span>

       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>

          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_ITERATION</span><span class="p">)</span>
          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>

          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>

          <span class="c">!  Do a V-cycle</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">use_pySDC_V</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             call </span><span class="n">pf_Vcycle_pySDC</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">level_index_c</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">pf_Vcycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index_c</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>
          <span class="k">end if</span>
          

          <span class="c">!  Check for convergence</span>
          <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_ITERATION</span><span class="p">)</span>
          
          <span class="c">!  If we are converged, exit block (can do one last sweep if desired)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">sweep_at_conv</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39;sweep at convergence&#39;</span>
                <span class="k">call </span><span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">)%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
             <span class="k">end if</span>
<span class="k">             call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
             <span class="k">call </span><span class="n">pf_set_iter</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> 
             <span class="k">exit             </span>
<span class="k">          end if</span>

<span class="k">       end do</span>  <span class="c">!  Loop over the iteration in this bloc</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">debug</span><span class="p">)</span> <span class="k">print</span><span class="o">*</span><span class="p">,</span>  <span class="s1">&#39;DEBUG --&#39;</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39;sweep after iterations on fine&#39;</span>
          <span class="k">call </span><span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">)%</span><span class="n">ulevel</span><span class="p">%</span><span class="n">sweeper</span><span class="p">%</span><span class="n">sweep</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
       <span class="k">end if</span>

<span class="k">       if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_timings</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">pf_stop_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">T_BLOCK</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_BLOCK</span><span class="p">)</span>
       
    <span class="k">end do</span> <span class="c">!  Loop over the blocks</span>

    <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ALL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_block_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tomasso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>