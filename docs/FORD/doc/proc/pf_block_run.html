<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tommaso Buvoli" >
    <link rel="icon" href="../favicon.png">

    <title>pf_block_run &ndash; LibPFASST</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">LibPFASST </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">65 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST controller for block mode
  When starting a new block, broadcast new initial conditions to all procs
  For initial block, this is done when initial conditions are set
 Reset some flags
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the loops over SDC sweeps</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E79"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E4"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E62"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E3"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E133"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_block_runCallsGraph" width="641pt" height="605pt"
 viewBox="0.00 0.00 641.00 605.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CallsGraph" class="graph" transform="scale(0.854667 0.854667) rotate(0) translate(4 704.181)">
<title>proc~~pf_block_run~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-704.181 746,-704.181 746,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CallsGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="74,-334.181 0,-334.181 0,-310.181 74,-310.181 74,-334.181"/>
<text text-anchor="middle" x="37" y="-319.781" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_node2" class="node"><title>proc~pf_check_convergence_block</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_check_convergence_block.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-658.181 110,-658.181 110,-634.181 264,-634.181 264,-658.181"/>
<text text-anchor="middle" x="187" y="-643.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_edge1" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block</title>
<path fill="none" stroke="#000000" d="M39.3667,-334.244C45.2836,-384.483 70.2018,-576.518 110,-620.181 113.096,-623.578 116.654,-626.53 120.504,-629.098"/>
<polygon fill="#000000" stroke="#000000" points="118.91,-632.218 129.332,-634.124 122.374,-626.135 118.91,-632.218"/>
</g>
<!-- proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_node3" class="node"><title>proc~pf_v_cycle</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node3"><a xlink:href=".././proc/pf_v_cycle.html" xlink:title="pf_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="218.5,-334.181 155.5,-334.181 155.5,-310.181 218.5,-310.181 218.5,-334.181"/>
<text text-anchor="middle" x="187" y="-319.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_edge2" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_v_cycle</title>
<path fill="none" stroke="#000000" d="M74.2049,-322.181C95.6291,-322.181 122.831,-322.181 145.038,-322.181"/>
<polygon fill="#000000" stroke="#000000" points="145.17,-325.682 155.17,-322.181 145.17,-318.682 145.17,-325.682"/>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_node4" class="node"><title>proc~pf_predictor</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node4"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="222,-292.181 152,-292.181 152,-268.181 222,-268.181 222,-292.181"/>
<text text-anchor="middle" x="187" y="-277.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_edge3" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M74.23,-311.505C85.6639,-308.165 98.3512,-304.489 110,-301.181 120.378,-298.234 131.569,-295.111 142.09,-292.2"/>
<polygon fill="#000000" stroke="#000000" points="143.213,-295.521 151.922,-289.487 141.351,-288.773 143.213,-295.521"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node5" class="node"><title>proc~end_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node5"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="634,-116.181 573,-116.181 573,-92.1814 634,-92.1814 634,-116.181"/>
<text text-anchor="middle" x="603.5" y="-101.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge4" class="edge"><title>proc~pf_block_run&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M43.6274,-309.973C66.7334,-261.598 159.768,-83.2849 300,-27.1814 394.518,10.6331 435.708,8.56556 529,-32.1814 553.952,-43.0797 575.248,-66.5262 588.396,-83.714"/>
<polygon fill="#000000" stroke="#000000" points="585.764,-86.0437 594.504,-92.032 591.406,-81.9003 585.764,-86.0437"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_node6" class="node"><title>proc~pf_broadcast</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node6"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="400.5,-578.181 325.5,-578.181 325.5,-554.181 400.5,-554.181 400.5,-578.181"/>
<text text-anchor="middle" x="363" y="-563.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_edge5" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M54.0672,-334.281C106.751,-373.957 274.493,-500.281 337.642,-547.838"/>
<polygon fill="#000000" stroke="#000000" points="335.742,-550.788 345.836,-554.008 339.953,-545.197 335.742,-550.788"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_node7" class="node"><title>proc~call_hooks</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node7"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="527,-214.181 464,-214.181 464,-190.181 527,-190.181 527,-214.181"/>
<text text-anchor="middle" x="495.5" y="-199.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge6" class="edge"><title>proc~pf_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M48.397,-309.964C61.3413,-295.567 84.8343,-271.987 110,-259.181 224.22,-201.061 380.574,-197.804 453.69,-199.996"/>
<polygon fill="#000000" stroke="#000000" points="453.743,-203.5 463.859,-200.353 453.988,-196.504 453.743,-203.5"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node8" class="node"><title>proc~start_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node8"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="635.5,-253.181 571.5,-253.181 571.5,-229.181 635.5,-229.181 635.5,-253.181"/>
<text text-anchor="middle" x="603.5" y="-238.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge7" class="edge"><title>proc~pf_block_run&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M42.8936,-334.359C52.8784,-358.167 77.4354,-411.732 110,-448.181 212.223,-562.6 276.202,-620.372 426,-587.181 475.309,-576.256 498.196,-579.204 529,-539.181 584.353,-467.262 540.525,-425.574 565,-338.181 572.429,-311.654 584.324,-282.291 592.722,-262.895"/>
<polygon fill="#000000" stroke="#000000" points="596.041,-264.041 596.865,-253.478 589.634,-261.222 596.041,-264.041"/>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge8" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M198.141,-634.042C216.389,-612.953 256.893,-569.484 300,-545.181 350.952,-516.456 387.228,-550.976 426,-507.181 488.189,-436.935 439.031,-390.145 462,-299.181 468.671,-272.762 479.02,-243.169 486.241,-223.696"/>
<polygon fill="#000000" stroke="#000000" points="489.548,-224.846 489.792,-214.254 482.996,-222.382 489.548,-224.846"/>
</g>
<!-- proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node16" class="node"><title>proc~pf_check_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node16"><a xlink:href=".././proc/pf_check_residual.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="412.5,-700.181 313.5,-700.181 313.5,-676.181 412.5,-676.181 412.5,-700.181"/>
<text text-anchor="middle" x="363" y="-685.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge9" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual</title>
<path fill="none" stroke="#000000" d="M237.861,-658.217C258.321,-663.155 282.154,-668.908 303.436,-674.045"/>
<polygon fill="#000000" stroke="#000000" points="302.79,-677.49 313.332,-676.434 304.433,-670.685 302.79,-677.49"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_node20" class="node"><title>proc~pf_send_status</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node20"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="405.5,-658.181 320.5,-658.181 320.5,-634.181 405.5,-634.181 405.5,-658.181"/>
<text text-anchor="middle" x="363" y="-643.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_edge10" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M264.066,-646.181C279.519,-646.181 295.44,-646.181 309.836,-646.181"/>
<polygon fill="#000000" stroke="#000000" points="310.021,-649.682 320.021,-646.181 310.021,-642.682 310.021,-649.682"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_node9" class="node"><title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node9"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="426,-292.181 300,-292.181 300,-268.181 426,-268.181 426,-292.181"/>
<text text-anchor="middle" x="363" y="-277.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge11" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M218.707,-314.769C241.834,-309.187 274.262,-301.359 302.421,-294.562"/>
<polygon fill="#000000" stroke="#000000" points="303.282,-297.955 312.181,-292.207 301.639,-291.151 303.282,-297.955"/>
</g>
<!-- proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_node10" class="node"><title>proc~pf_post</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node10"><a xlink:href=".././proc/pf_post.html" xlink:title="pf_post">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-498.181 336,-498.181 336,-474.181 390,-474.181 390,-498.181"/>
<text text-anchor="middle" x="363" y="-483.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_post</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_edge12" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_post</title>
<path fill="none" stroke="#000000" d="M194.346,-334.481C209.127,-361.948 248.54,-428.717 300,-465.181 307.831,-470.731 317.243,-474.904 326.34,-478.005"/>
<polygon fill="#000000" stroke="#000000" points="325.412,-481.381 335.998,-480.964 327.462,-474.688 325.412,-481.381"/>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node11" class="node"><title>proc~pf_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="528,-96.1814 463,-96.1814 463,-72.1814 528,-72.1814 528,-96.1814"/>
<text text-anchor="middle" x="495.5" y="-81.7814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge13" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M218.558,-318.003C233.153,-314.98 250.365,-309.842 264,-301.181 284.753,-288 282.826,-276.774 300,-259.181 308.022,-250.965 424.758,-146.512 473.432,-103.005"/>
<polygon fill="#000000" stroke="#000000" points="475.774,-105.606 480.898,-96.3324 471.11,-100.386 475.774,-105.606"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_node13" class="node"><title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node13"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="425,-334.181 301,-334.181 301,-310.181 425,-310.181 425,-334.181"/>
<text text-anchor="middle" x="363" y="-319.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge17" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M218.707,-322.181C238.687,-322.181 265.607,-322.181 290.72,-322.181"/>
<polygon fill="#000000" stroke="#000000" points="290.974,-325.682 300.974,-322.181 290.974,-318.682 290.974,-325.682"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_node14" class="node"><title>proc~pf_send</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-414.181 336,-414.181 336,-390.181 390,-390.181 390,-414.181"/>
<text text-anchor="middle" x="363" y="-399.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge14" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M212.298,-334.349C234.869,-345.544 269.492,-362.441 300,-376.181 308.506,-380.012 317.743,-383.985 326.427,-387.638"/>
<polygon fill="#000000" stroke="#000000" points="325.35,-390.981 335.927,-391.602 328.046,-384.521 325.35,-390.981"/>
</g>
<!-- proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_node15" class="node"><title>proc~interpolate_q0</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node15"><a xlink:href=".././proc/interpolate_q0.html" xlink:title="interpolate_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-136.181 322.5,-136.181 322.5,-112.181 403.5,-112.181 403.5,-136.181"/>
<text text-anchor="middle" x="363" y="-121.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_q0</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge15" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M218.758,-320.877C234.306,-318.618 252.308,-313.297 264,-301.181 311.91,-251.537 255.35,-202.777 300,-150.181 303.683,-145.844 308.211,-142.215 313.129,-139.183"/>
<polygon fill="#000000" stroke="#000000" points="315.092,-142.105 322.306,-134.345 311.827,-135.913 315.092,-142.105"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_node19" class="node"><title>proc~pf_recv</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node19"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-456.181 336,-456.181 336,-432.181 390,-432.181 390,-456.181"/>
<text text-anchor="middle" x="363" y="-441.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge16" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M198.52,-334.505C217.037,-355.487 257.534,-398.289 300,-423.181 308.05,-427.9 317.313,-431.752 326.184,-434.808"/>
<polygon fill="#000000" stroke="#000000" points="325.356,-438.217 335.946,-437.923 327.484,-431.549 325.356,-438.217"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge18" class="edge"><title>proc~pf_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M190.492,-267.988C198.685,-231.331 228.47,-121.678 300,-73.1814 384.531,-15.8708 431.394,-24.1294 529,-54.1814 548.91,-60.3115 568.259,-73.8784 582.102,-85.3351"/>
<polygon fill="#000000" stroke="#000000" points="580.106,-88.2349 589.966,-92.1105 584.675,-82.9317 580.106,-88.2349"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge23" class="edge"><title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M222.267,-271.461C279.12,-256.993 392.701,-228.088 453.636,-212.581"/>
<polygon fill="#000000" stroke="#000000" points="454.833,-215.888 463.661,-210.029 453.107,-209.104 454.833,-215.888"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge25" class="edge"><title>proc~pf_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M222.321,-285.174C236.044,-288.279 251.521,-293.255 264,-301.181 284.753,-314.363 278.231,-331.755 300,-343.181 345.183,-366.898 484.434,-385.037 529,-360.181 566.046,-339.52 586.757,-291.648 596.177,-263.32"/>
<polygon fill="#000000" stroke="#000000" points="599.598,-264.106 599.245,-253.517 592.918,-262.016 599.598,-264.106"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge19" class="edge"><title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M222.377,-280.181C241.616,-280.181 266.354,-280.181 289.65,-280.181"/>
<polygon fill="#000000" stroke="#000000" points="289.875,-283.682 299.875,-280.181 289.875,-276.682 289.875,-283.682"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge20" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M191.543,-268.03C201.911,-234.903 235.596,-142.846 300,-103.181 346.34,-74.6424 410.971,-74.4081 452.777,-78.2126"/>
<polygon fill="#000000" stroke="#000000" points="452.584,-81.711 462.889,-79.2521 453.299,-74.7477 452.584,-81.711"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge26" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M222.377,-288.479C245.123,-293.97 275.555,-301.315 302.202,-307.748"/>
<polygon fill="#000000" stroke="#000000" points="301.664,-311.218 312.206,-310.162 303.306,-304.413 301.664,-311.218"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge21" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M222.307,-283.38C236.507,-286.192 252.344,-291.434 264,-301.181 292.364,-324.9 273.204,-350.704 300,-376.181 307.345,-383.165 316.841,-388.403 326.184,-392.275"/>
<polygon fill="#000000" stroke="#000000" points="325.174,-395.634 335.767,-395.832 327.61,-389.071 325.174,-395.634"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge22" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M195.539,-268.146C211.792,-243.066 252.523,-184.679 300,-150.181 304.9,-146.621 310.361,-143.436 315.954,-140.62"/>
<polygon fill="#000000" stroke="#000000" points="317.818,-143.613 325.416,-136.229 314.871,-137.264 317.818,-143.613"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge24" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M222.322,-282.369C236.867,-284.977 252.968,-290.339 264,-301.181 304.321,-340.808 260.825,-382.422 300,-423.181 306.955,-430.418 316.491,-435.161 325.999,-438.269"/>
<polygon fill="#000000" stroke="#000000" points="325.218,-441.684 335.788,-440.953 327.069,-434.934 325.218,-441.684"/>
</g>
<!-- mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_node17" class="node"><title>mpi_wtime</title>
<polygon fill="#777777" stroke="#777777" points="742,-194.181 678,-194.181 678,-170.181 742,-170.181 742,-194.181"/>
<text text-anchor="middle" x="710" y="-179.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi_wtime</text>
</g>
<!-- proc~end_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_edge27" class="edge"><title>proc~end_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M620.828,-116.369C637.929,-129.134 664.981,-149.325 684.614,-163.98"/>
<polygon fill="#000000" stroke="#000000" points="682.679,-166.903 692.787,-170.08 686.866,-161.293 682.679,-166.903"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node12" class="node"><title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="526,-488.181 465,-488.181 465,-464.181 526,-464.181 526,-488.181"/>
<text text-anchor="middle" x="495.5" y="-473.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge29" class="edge"><title>proc~pf_broadcast&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M400.64,-554.21C409.39,-550.456 418.391,-545.793 426,-540.181 446.06,-525.388 443.323,-513.686 462,-497.181 463.101,-496.208 464.251,-495.248 465.434,-494.306"/>
<polygon fill="#000000" stroke="#000000" points="467.521,-497.116 473.541,-488.398 463.398,-491.459 467.521,-497.116"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node18" class="node"><title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="527.5,-530.181 463.5,-530.181 463.5,-506.181 527.5,-506.181 527.5,-530.181"/>
<text text-anchor="middle" x="495.5" y="-515.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge28" class="edge"><title>proc~pf_broadcast&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M396.931,-554.069C414.212,-547.713 435.539,-539.868 453.842,-533.136"/>
<polygon fill="#000000" stroke="#000000" points="455.2,-536.366 463.377,-529.629 452.783,-529.796 455.2,-536.366"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge31" class="edge"><title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M509.498,-190.165C527.537,-173.487 560.359,-143.142 581.793,-123.325"/>
<polygon fill="#000000" stroke="#000000" points="584.429,-125.655 589.396,-116.296 579.677,-120.515 584.429,-125.655"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge30" class="edge"><title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M527.16,-213.462C537.955,-217.434 550.265,-221.963 561.76,-226.192"/>
<polygon fill="#000000" stroke="#000000" points="560.58,-229.487 571.174,-229.656 562.997,-222.918 560.58,-229.487"/>
</g>
<!-- proc~start_timer&#45;&gt;mpi_wtime -->
<g id="proc~~pf_block_run~~CallsGraph_edge32" class="edge"><title>proc~start_timer&#45;&gt;mpi_wtime</title>
<path fill="none" stroke="#000000" d="M625.899,-229.1C641.115,-220.509 661.768,-208.848 678.678,-199.301"/>
<polygon fill="#000000" stroke="#000000" points="680.642,-202.211 687.629,-194.247 677.201,-196.116 680.642,-202.211"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge36" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M373.917,-268.097C390.622,-248.25 426.079,-208.258 462,-181.181 494.87,-156.405 536.688,-134.543 566.124,-120.505"/>
<polygon fill="#000000" stroke="#000000" points="567.659,-123.651 575.219,-116.229 564.68,-117.317 567.659,-123.651"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge33" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M397.242,-268.05C406.766,-264.096 417.002,-259.372 426,-254.181 435.196,-248.877 455.314,-233.419 471.381,-220.725"/>
<polygon fill="#000000" stroke="#000000" points="473.681,-223.368 479.335,-214.408 469.327,-217.887 473.681,-223.368"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge35" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M426.04,-270.036C468.682,-263.064 524.114,-253.999 561.374,-247.906"/>
<polygon fill="#000000" stroke="#000000" points="562.072,-251.339 571.376,-246.271 560.942,-244.431 562.072,-251.339"/>
</g>
<!-- proc~restrict_sdc -->
<g id="proc~~pf_block_run~~CallsGraph_node21" class="node"><title>proc~restrict_sdc</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node21"><a xlink:href=".././proc/restrict_sdc.html" xlink:title="restrict_sdc">
<polygon fill="#d9534f" stroke="#d9534f" points="529,-332.181 462,-332.181 462,-308.181 529,-308.181 529,-332.181"/>
<text text-anchor="middle" x="495.5" y="-317.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_sdc</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_sdc -->
<g id="proc~~pf_block_run~~CallsGraph_edge34" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_sdc</title>
<path fill="none" stroke="#000000" d="M403.154,-292.183C418.551,-296.902 436.269,-302.333 451.978,-307.148"/>
<polygon fill="#000000" stroke="#000000" points="451.38,-310.625 461.966,-310.209 453.431,-303.932 451.38,-310.625"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge38" class="edge"><title>proc~pf_residual&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M528.017,-90.1279C538.967,-92.1941 551.391,-94.5381 562.909,-96.7115"/>
<polygon fill="#000000" stroke="#000000" points="562.264,-100.151 572.74,-98.5663 563.562,-93.2728 562.264,-100.151"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge37" class="edge"><title>proc~pf_residual&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M504.642,-96.2403C522.633,-122.887 565.955,-187.053 588.435,-220.349"/>
<polygon fill="#000000" stroke="#000000" points="585.688,-222.536 594.184,-228.865 591.49,-218.619 585.688,-222.536"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge42" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M405.797,-310.088C412.707,-307.509 419.674,-304.534 426,-301.181 476.737,-274.29 490.367,-265.665 529,-223.181 556.692,-192.73 579.935,-150.435 592.481,-125.329"/>
<polygon fill="#000000" stroke="#000000" points="595.644,-126.828 596.897,-116.308 589.357,-123.751 595.644,-126.828"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge39" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M412.466,-310.084C417.351,-307.638 421.983,-304.702 426,-301.181 453.206,-277.339 439.335,-256.376 462,-228.181 463.91,-225.806 466.073,-223.507 468.354,-221.324"/>
<polygon fill="#000000" stroke="#000000" points="471.084,-223.591 476.366,-214.407 466.509,-218.292 471.084,-223.591"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge41" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M391.343,-334.209C425.476,-347.301 484.747,-363.576 529,-341.181 561.297,-324.837 582.858,-286.878 593.865,-262.713"/>
<polygon fill="#000000" stroke="#000000" points="597.177,-263.872 597.936,-253.304 590.753,-261.092 597.177,-263.872"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_node22" class="node"><title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node22"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="642,-371.181 565,-371.181 565,-347.181 642,-347.181 642,-371.181"/>
<text text-anchor="middle" x="603.5" y="-356.781" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge40" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M380.655,-334.313C399.364,-347.123 431.161,-366.506 462,-374.181 492.29,-381.72 527.181,-378.059 554.615,-372.469"/>
<polygon fill="#000000" stroke="#000000" points="555.719,-375.81 564.739,-370.251 554.221,-368.972 555.719,-375.81"/>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge44" class="edge"><title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.136,-408.927C401.516,-412.391 414.785,-417.163 426,-423.181 430.924,-425.824 453.232,-443.273 471.072,-457.439"/>
<polygon fill="#000000" stroke="#000000" points="469.371,-460.559 479.374,-464.05 473.732,-455.083 469.371,-460.559"/>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge43" class="edge"><title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.163,-406.257C402.216,-409.249 416.024,-414.391 426,-423.181 453.441,-447.361 437.748,-469.804 462,-497.181 462.735,-498.011 463.51,-498.821 464.318,-499.61"/>
<polygon fill="#000000" stroke="#000000" points="462.284,-502.47 472.225,-506.134 466.738,-497.07 462.284,-502.47"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge47" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M377.712,-112.107C395.629,-97.2168 428.664,-72.7088 462,-63.1814 490.631,-54.9985 500.181,-55.687 529,-63.1814 546.632,-67.7667 564.525,-77.6117 578.241,-86.5051"/>
<polygon fill="#000000" stroke="#000000" points="576.359,-89.4575 586.607,-92.147 580.273,-83.6539 576.359,-89.4575"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge45" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M384.105,-136.198C405.882,-149.214 440.819,-170.096 465.551,-184.878"/>
<polygon fill="#000000" stroke="#000000" points="463.778,-187.896 474.158,-190.023 467.37,-181.888 463.778,-187.896"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge46" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M403.648,-133.653C438.14,-142.86 488.765,-158.748 529,-181.181 548.964,-192.313 568.881,-209.006 582.936,-221.96"/>
<polygon fill="#000000" stroke="#000000" points="580.814,-224.77 590.49,-229.086 585.617,-219.678 580.814,-224.77"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge49" class="edge"><title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.095,-450.58C408.632,-455.126 433.86,-461.312 454.873,-466.464"/>
<polygon fill="#000000" stroke="#000000" points="454.256,-469.917 464.802,-468.899 455.923,-463.118 454.256,-469.917"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge48" class="edge"><title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.032,-450.477C401.517,-453.879 414.898,-458.727 426,-465.181 444.507,-475.941 444.96,-484.223 462,-497.181 463.36,-498.216 464.771,-499.252 466.209,-500.279"/>
<polygon fill="#000000" stroke="#000000" points="464.345,-503.245 474.577,-505.994 468.292,-497.464 464.345,-503.245"/>
</g>
<!-- proc~restrict_sdc&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge50" class="edge"><title>proc~restrict_sdc&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M529.168,-332.201C538.941,-335.797 549.801,-339.792 560.104,-343.583"/>
<polygon fill="#000000" stroke="#000000" points="559.163,-346.966 569.757,-347.134 561.581,-340.397 559.163,-346.966"/>
</g>
</g>
</svg>
</div><script>var panprocpf_block_runCallsGraph = svgPanZoom('#procpf_block_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_block_runCalledByGraph" width="196pt" height="32pt"
 viewBox="0.00 0.00 196.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_block_run~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 192,-28 192,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="188,-24 114,-24 114,-0 188,-0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node2" class="node"><title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,-0 78,-0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_edge1" class="edge"><title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.164,-12C86.3694,-12 95.1281,-12 103.607,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.755,-15.5001 113.754,-12 103.754,-8.5001 103.755,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>

    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev_p</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest level in V (Lambda)-cycle</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_max_depth</span> <span class="c">!!  Finest level in V-cycle</span>


    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c">! set finest level to visit in the following run</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k</span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>

       <span class="c">!&gt; Reset some flags</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pfblock</span> <span class="o">=</span> <span class="n">k</span>
<span class="c">!       pf%state%finest_level = 3</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">!&gt;  Start the loops over SDC sweeps</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

       <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>

          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>

          <span class="c">!  Do a v_cycle</span>
          <span class="k">call </span><span class="n">pf_v_cycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">level_index_c</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">)</span>

          <span class="c">!  Check for convergence</span>
          <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">finest_level</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>

<span class="c">!          print *,pf%rank, &#39; post res&#39;</span>
          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

          <span class="c">!  If we are converged, exit block</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">exit</span>
<span class="k">       end do</span>  <span class="c">!  Loop over the iteration in this bloc</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
       <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_STEP</span><span class="p">)</span>
    <span class="k">end do</span> <span class="c">!  Loop over the blocks</span>

    <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_block_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> LibPFASST was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon, Tommaso Buvoli</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>